{"version":3,"sources":["guillo-gmi/lib/rest.js","guillo-gmi/lib/helpers.js","guillo-gmi/lib/client.js","guillo-gmi/contexts/index.js","guillo-gmi/components/input/button.js","guillo-gmi/components/modal.js","guillo-gmi/hooks/useConfig.js","guillo-gmi/actions/remove_items.js","guillo-gmi/components/input/checkbox.js","guillo-gmi/components/error_zone.js","guillo-gmi/hooks/useInput.js","guillo-gmi/lib/validators.js","guillo-gmi/components/input/input.js","guillo-gmi/components/ui/icon.js","guillo-gmi/components/input/form.js","guillo-gmi/components/input/form_builder.js","guillo-gmi/components/input/password.js","guillo-gmi/components/input/email.js","guillo-gmi/components/input/select.js","guillo-gmi/components/input/upload.js","guillo-gmi/components/input/textarea.js","guillo-gmi/hooks/useCrudContext.js","guillo-gmi/components/ui/loading.js","guillo-gmi/components/ui/tag.js","guillo-gmi/components/ui/delete.js","guillo-gmi/components/ui/table.js","guillo-gmi/components/ui/notification.js","guillo-gmi/components/fields/editableField.js","guillo-gmi/components/fields/renderField.js","guillo-gmi/components/behaviors/idublincore.js","guillo-gmi/components/panel/addons.js","guillo-gmi/components/panel/behaviors.js","guillo-gmi/lib/utils.js","guillo-gmi/models/sharing.js","guillo-gmi/models/index.js","guillo-gmi/components/input/dropdown.js","guillo-gmi/components/selected_items_actions.js","guillo-gmi/components/item.js","guillo-gmi/components/pagination.js","guillo-gmi/hooks/useLocation.js","guillo-gmi/components/searchLabels.js","guillo-gmi/lib/search.js","guillo-gmi/components/panel/items.js","guillo-gmi/components/behavior_view.js","guillo-gmi/components/properties_view.js","guillo-gmi/components/panel/properties.js","guillo-gmi/components/panel/permissions_roleperm.js","guillo-gmi/components/panel/permissions_prinperm.js","guillo-gmi/components/panel/permissions_prinrole.js","guillo-gmi/components/panel/permissions.js","guillo-gmi/components/panel/requester.js","guillo-gmi/components/widgets/tags.js","guillo-gmi/components/context_toolbar.js","guillo-gmi/components/flash.js","guillo-gmi/components/path.js","guillo-gmi/components/notallowed.js","guillo-gmi/components/notfound.js","guillo-gmi/components/tabs.js","guillo-gmi/views/folder.js","guillo-gmi/views/item.js","guillo-gmi/views/application.js","guillo-gmi/views/container.js","guillo-gmi/views/base.js","guillo-gmi/forms/users.js","guillo-gmi/hooks/useRemoteField.js","guillo-gmi/views/users.js","guillo-gmi/actions/copy_items.js","guillo-gmi/actions/move_items.js","guillo-gmi/forms/base.js","guillo-gmi/views/groups.js","guillo-gmi/hooks/useRegistry.js","guillo-gmi/actions/add_item.js","guillo-gmi/components/behaviors/iattachment.js","guillo-gmi/components/behaviors/imultiattachment.js","guillo-gmi/reducers/guillotina.js","guillo-gmi/components/error_boundary.js","guillo-gmi/components/guillotina.js","guillo-gmi/components/layout.js","guillo-gmi/components/login.js","guillo-gmi/lib/auth.js","App.js","index.js"],"names":["RestClient","url","auth","this","path","data","headers","getHeaders","fetch","authToken","getToken","request","method","body","JSON","stringify","filename","undefined","classnames","classNames","filter","Boolean","join","trim","noop","current","generateUID","prefix","toQueryString","params","Object","keys","map","key","encodeURIComponent","sleep","ms","Promise","resolve","reject","setTimeout","cacheTypes","cacheSchemas","GuillotinaClient","rest","isContainer","get","startsWith","substring","slice","start","pageSize","result","json","applyCompat","member","items","items_count","items_total","container","prepare","getContainerFromPath","query","res","permissions","Array","isArray","post","replace","delete","cleanPath","create","patch","file","upload","name","id","endpoint","groups","getGroups","users","getUsers","all","gr","usr","endsWith","req","resp","from","Set","extractPermissions","types","status","parts","split","lightFileReader","a","async","reader","FileReader","readAsArrayBuffer","onloadend","e","fileData","target","type","permission","concat","item","TraversalContext","createContext","Traversal","props","assign","setRouterParam","dispatch","payload","message","flash","action","state","tabs","tabsPermissions","forEach","perm","hasPerm","context","TraversalProvider","children","Provider","value","Button","className","onClick","loading","disabled","css","Modal","isActive","setActive","Portal","usePortal","aria-label","Confirm","onCancel","onConfirm","p","Fragment","style","marginTop","PathTree","title","onSubmit","preventDefault","placeholder","margin","Config","DisabledTypes","PageSize","DelayActions","calculated","addConfig","additional","original","useConfig","cfg","ref","React","useRef","console","log","getId","Checkbox","indeterminate","color","backgroundColor","borderColor","onChange","inputRef","useState","setState","useEffect","htmlFor","checked","ev","ErrorZone","useInput","validator","hasError","onFocus","onBlur","validators","validation","func","applyValidators","REGEX_EMAIL","isEmail","test","notEmpty","length","Input","forwardRef","icon","iconPosition","error","errorZoneClassName","autoComplete","widget","onPressEnter","isSubmitted","required","autofocus","errorMessage","push","handlers","uid","mounted","setMounted","focus","theError","statusClasses","aria-invalid","aria-describedby","Icon","align","addClass","Form","onReset","event","formComponents","string","password","boolean","email","FormBuilder","schema","formData","actionName","exclude","remotes","submitButton","properties","values","initialState","fields","x","includes","element","onUpdate","field","GetTag","Tag","label","displayName","children_","Children","child","cloneElement","i","Select","options","size","classWrap","multiple","resetOnChange","appendDefault","text","cssWrap","index","toString","FileUpload","files","Textarea","rows","initial","isError","response","processResponse","ready_body","Ctx","newState","client","del","useCrudContext","useContext","useSetState","Loading","onRemove","Delete","Table","idx","Notification","isColor","EditableField","Type","ns","isEdit","setEdit","val","setValue","saveField","refresh","plain","RenderField","Widget","FieldValue","Schema","editable","widgets","description","prepareData","addons","arrayToObject","available","installed","array","reduce","obj","PanelBehaviors","ops","enableBehavior","behavior","disableBehavior","colSpan","static","dynamic","formatDate","str","d","Date","minutes","getMinutes","getDate","getMonth","getFullYear","getHours","base","local","roleperm","prinperm","prinrole","inherit","Sharing","role","principal","ItemModel","_path","splice","icons","_url","type_name","creation_date","modification_date","Permissions","Dropdown","isRight","optionDisabledWhen","setIsActive","position","useClickAway","aria-haspopup","aria-controls","option","cursor","opacity","ItemsActionsCtx","actions","DELETE","perms","MOVE","COPY","ItemsActionsProvider","traversal","selected","setSelected","onAction","actionKey","doAction","onSelectAllItems","onSelectOneItem","AllItemsCheckbox","marginLeft","ItemCheckbox","ItemsActionsDropdown","every","v","o","some","Item","setPath","link","width","smallcss","mediumcss","RItem","search","model","created","updated","ItemTitle","Pagination","total","doPaginate","pager","maxPages","Math","ceil","setURLParams","window","history","pathname","clean","to","URLSearchParams","_key","set","useLocation","currentSearchParams","update","prevPath","patchHistoryEvents","checkForUpdates","events","addEventListener","removeEventListener","navigate","useCallback","remove","param","patched","apply","arguments","Event","dispatchEvent","location","SearchLabels","SEP","DEFAULT_FIELD","CLEANER","page","PanelItems","setLocation","parseInt","searchParsed","qs","defaultField","lastKey","part","parser","getItems","BehaviorsView","getBehavior","registry","behaviors","__behaviors__","b","Cls","BehaviorNotImplemented","GetBehavior","PropertiesButtonView","Props","getProperties","Buttons","PropertiesView","Panels","_showProperties","_editable","PanelProperties","modifyContent","showProperties","properties_default","properties_editable","prop","PermissionRoleperm","setter","roles","operations","setting","selectedOptions","random","PermissionPrinperm","PermissionPrinrole","PanelPermissions","reset","setReset","getRole","row","principals","getPrincipals","getPrinroles","AddPermission","currentObj","defaultOptions","getAllPermissions","group","getRoles","methods","PanelRequester","doRequest","ace","parse","mode","tabSize","fontFamily","editorProps","$blockScrolling","Infinity","enableBasicAutocompletion","enableLiveAutocompletion","enableSnippets","showLineNumbers","prepareAvailable","already","def","TagsWidget","noData","setResult","addItem","marginBottom","CreateButton","getTypes","ContextToolbar","AddButton","ctx","searchText","q","tab","Flash","clearFlash","Path","segments","links","buildPaths","indx","results","NotAllowed","fontSize","NotFound","TabsPanel","currentTab","rightToolbar","setTab","CurrentComp","changeTab","Items","Properties","Behaviors","Requester","FolderCtx","filterTabs","ItemCtx","CreateContainer","ModalAddContainer","isLoading","setLoading","idField","setId","setError","createObject","Addons","setAction","useAsync","getAddons","pathPrefix","addon","installAddon","removeAddon","Registry","UserForm","attr","useRemoteField","setRemote","Users","UsersToolbar","withError","BaseForm","setName","toLowerCase","l","RegExp","charAt","stringToSlug","Groups","GroupToolbar","paths","views","Application","databases","db","Database","containers","Container","UserManager","User","gorups","user_groups","user_roles","updateRemote","username","updateObject","Group","setRoles","setUsers","req2","user","urole","r","removeUser","GroupManager","Folder","getForm","cancelAction","oldData","form","onError","err","copyItems","destination","new_id","responses","moveItems","removeItems","last","itemsNames","errors","ok","errorstr","forms","content_type","canModify","download","blob","Blob","URL","createObjectURL","document","createElement","href","setAttribute","appendChild","click","parentNode","removeChild","fileKey","setFileKey","setFile","downloadFile","fileName","schemas","fallback","getComponent","defaultComponent","getAction","is_folderish","errorStatus","guillotinaReducer","paddingBottom","ErrorBoundary","errorInfo","errorMsg","errorStack","componentStack","Component","Guillotina","config","useRegistry","searchPath","useReducer","getClient","getContext","canido","pr","contextData","Main","Action","Layout","onLogout","src","process","alt","height","aria-expanded","data-target","aria-hidden","isLogged","logout","ERRORS","Login","createRef","doLogin","setAccount","login","onLogin","linkState","s","Auth","maxRetry","retryRefresh","base_url","account","getUrl","credentials","storeAuth","localStorage","removeItem","setItem","token","exp","cleanAuth","expiration","now","getTime","getItem","_getToken","expires","willExpire","refreshToken","isExpired","jwt_decode","App","setLogged","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.a760a003.chunk.js","sourcesContent":["\n\nexport class RestClient {\n\n  constructor(url, auth) {\n    this.auth = auth\n    this.url = url\n  }\n\n  async request(path, data, headers) {\n    data = data || {}\n    data.headers = headers || this.getHeaders()\n    return await fetch(`${this.url}${path}`, data)\n  }\n\n  getHeaders() {\n    const authToken  = this.auth.getToken()\n    if (!authToken) return false;\n    return {\n      'Accept': 'application/json',\n      'Content-Type': 'application/json',\n      'Authorization': 'Bearer ' + authToken\n    }\n  }\n\n  async post(path, data) {\n    return await this.request(path, {\n      method: 'post',\n      body: JSON.stringify(data)\n    })\n  }\n\n  async get(path) {\n    return await this.request(path, {})\n  }\n\n  async put(path, data) {\n    return await this.request(path, {\n      method: 'put',\n      body: JSON.stringify(data)\n    })\n  }\n\n  async patch(path, data) {\n    return await this.request(path, {\n      method: 'PATCH',\n      body: JSON.stringify(data)\n    })\n  }\n\n  async upload(path, data) {\n\n    const headers = this.getHeaders()\n    delete headers[\"Content-Type\"]\n    headers[\"Content-Type\"] = data[\"content-type\"]\n    headers[\"X-UPLOAD-FILENAME\"] = data.filename\n    headers[\"Content-Encoding\"]= \"base64\"\n    return await this.request(path, {\n      method: 'PATCH',\n      body: data.data\n    }, headers)\n  }\n\n  async delete(path, data=undefined) {\n    return await this.request(path, {\n      method: 'delete',\n      body: JSON.stringify(data)\n    })\n  }\n}\n","export const classnames = classNames => {\n  return classNames\n    .filter(Boolean)\n    .join(\" \")\n    .trim();\n};\n\nexport const noop = () => {};\n\nlet current = 0;\n\nexport const generateUID = prefix => `${prefix || \"id\"}-${current++}`;\n\nexport const toQueryString = params => {\n  return Object.keys(params)\n    .map(key => {\n      return encodeURIComponent(key) + \"=\" + encodeURIComponent(params[key]);\n    })\n    .join(\"&\");\n};\n\nexport function base64ToArrayBuffer(base64) {\n  const binaryString = window.atob(base64);\n  const binaryLen = binaryString.length;\n  const bytes = new Uint8Array(binaryLen);\n  for (var i = 0; i < binaryLen; i++) {\n    var ascii = binaryString.charCodeAt(i);\n    bytes[i] = ascii;\n  }\n  return bytes;\n}\n\n\nexport function stringToSlug (str) {\n  str = str.replace(/^\\s+|\\s+$/g, ''); // trim\n  str = str.toLowerCase();\n\n  // remove accents, swap  for n, etc\n  var from = \"/_,:;\";\n  var to   = \"aaaaeeeeiiiioooouuuunc------\";\n  for (var i=0, l=from.length ; i<l ; i++) {\n      str = str.replace(new RegExp(from.charAt(i), 'g'), to.charAt(i));\n  }\n\n  str = str.replace(/[^a-z0-9 -]/g, '') // remove invalid chars\n      .replace(/\\s+/g, '-') // collapse whitespace and replace by -\n      .replace(/-+/g, '-'); // collapse dashes\n\n  return str;\n}\n\n\nexport function sleep(ms) {\n  return new Promise((resolve, reject) => {\n    setTimeout(function() {\n      resolve()\n    }, ms)\n  })\n}\n","import { RestClient } from \"./rest\";\nimport { toQueryString } from \"./helpers\";\n\nlet cacheTypes = {};\nlet cacheSchemas = {};\n\n\nexport class GuillotinaClient {\n  constructor(rest, isContainer) {\n    this.rest = rest;\n    this.isContainer = isContainer;\n  }\n\n  async getContext(path) {\n    switch (path) {\n      case \"/\":\n        return await this.rest.get(\"\");\n      default:\n        if (path.startsWith(\"/\")) {\n          path = path.substring(1);\n        }\n        return await this.rest.get(path);\n    }\n  }\n\n  async get(path) {\n    if (path.startsWith(\"/\")) {\n      path = path.slice(1);\n    }\n    return await this.rest.get(path);\n  }\n\n  async getItems(path, start = 0, pageSize=10) {\n    if (path.startsWith(\"/\")) {\n      path = path.slice(1);\n    }\n    const result = await this.rest.get(\n      `${path}@search?depth=1&b_start=${start}&b_size=${pageSize}`\n    );\n    let data = await result.json();\n    return this.applyCompat(data)\n  }\n\n  // BBB API changes. Compat G5 and G6\n  applyCompat(data) {\n    data.member = data.items\n    data.items_count = data.items_total\n    return data\n  }\n\n  async search(path, params, container = false, prepare = true, start = 0, pageSize=10) {\n    if (path.startsWith(\"/\")) {\n      path = path.slice(1);\n    }\n    if (container) {\n      path = getContainerFromPath(path);\n    }\n    let query = prepare ? toQueryString(params) : params;\n    const url = `${path}@search?${query}&b_start=${start}&b_size=${pageSize}`;\n    let res = await this.rest.get(url)\n    let data = await res.json()\n    return this.applyCompat(data)\n  }\n\n  async canido(path, permissions) {\n    if (path.startsWith(\"/\")) {\n      path = path.slice(1);\n    }\n    if (Array.isArray(permissions)) {\n      permissions.join(\",\");\n    }\n    const url = `${path}@canido?permissions=${permissions}`;\n    return await this.rest.get(url);\n  }\n\n  async createObject(path, data) {\n    return await this.rest.post(path, data);\n  }\n\n  cleanPath(path) {\n    return path.replace(this.rest.url, \"\");\n  }\n\n  async delete(path, data) {\n    return await this.rest.delete(this.cleanPath(path), data);\n  }\n\n  async create(path, data) {\n    if (path.startsWith(\"/\")) {\n      path = path.substring(1);\n    }\n    return await this.rest.post(path, data);\n  }\n\n  async post(path, data) {\n    return await this.create(path, data);\n  }\n\n  async patch(path, data) {\n    if (path.startsWith(\"/\")) {\n      path = path.substring(1);\n    }\n    return await this.rest.patch(path, data);\n  }\n\n  async upload(path, file) {\n    if (path.startsWith(\"/\")) {\n      path = path.substring(1);\n    }\n    return await this.rest.upload(path, file);\n  }\n\n  async download(path) {\n    if (path.startsWith(\"/\")) {\n      path = path.substring(1);\n    }\n    return await this.rest.get(path);\n  }\n\n  async getTypeSchema(path, name) {\n    if (!cacheSchemas[name]) {\n      let url = getContainerFromPath(path);\n      // todo: handle db case (only addable containers)\n      const res = await this.rest.get(`${url}@types/${name}`);\n      cacheSchemas[name] = await res.json();\n    }\n    return cacheSchemas[name];\n  }\n\n  async getAddons(path) {\n    return await this.rest.get(`${path}@addons`);\n  }\n\n  async installAddon(path, key) {\n    return await this.rest.post(`${path}@addons`, { id: key });\n  }\n\n  async removeAddon(path, key) {\n    return await this.rest.delete(`${path}@addons`, { id: key });\n  }\n\n  async getGroups(path) {\n    const endpoint = `${getContainerFromPath(path)}@groups`;\n    return await this.rest.get(endpoint);\n  }\n\n  async getUsers(path) {\n    const endpoint = `${getContainerFromPath(path)}@users`;\n    return await this.rest.get(endpoint);\n  }\n\n  async getPrincipals(path) {\n    const groups = this.getGroups(path)\n    const users = this.getUsers(path)\n    const [gr, usr] = await Promise.all(groups, users)\n    return {\n      groups: await gr.json(),\n      users: await usr.json()\n    }\n  }\n\n  async getRoles(path) {\n    const endpoint = `${getContainerFromPath(path)}@available-roles`;\n    return await this.rest.get(endpoint);\n  }\n\n  async getAllPermissions(path) {\n    if (!path.endsWith(\"/\")) {\n      path = `${path}/`;\n    }\n    const req = await this.rest.get(path + \"@all_permissions\");\n    const resp = await req.json();\n    const permissions = Array.from(new Set(extractPermissions(resp)));\n    return permissions;\n  }\n\n  async getTypes(path) {\n    if (path.startsWith(\"/\")) {\n      path = path.slice(1);\n    }\n    if (!cacheTypes[path]) {\n      const types = await this.rest.get(path + \"@addable-types\");\n      if (types.status === 401 || types.status === 404) {\n        cacheTypes[path] = [];\n      } else {\n        const res = await types.json();\n        cacheTypes[path] = res;\n      }\n    }\n    return cacheTypes[path];\n  }\n}\n\nexport function getClient(url, auth, isContainer = false) {\n  return new GuillotinaClient(new RestClient(url, auth), isContainer);\n}\n\nexport const getContainerFromPath = path => {\n  if (path.startsWith(\"/\")) {\n    path = path.substring(1);\n  }\n  let parts = path.split(\"/\");\n  return `${parts[0]}/${parts[1]}/`;\n};\n\nexport const lightFileReader = async (file) => {\n  return new Promise((resolve) => {\n    const reader = new FileReader();\n    reader.readAsArrayBuffer(file);\n    reader.onloadend = e => {\n      const fileData = e.target.result;\n      resolve({\n        filename: file.name,\n        data: fileData,\n        \"content-type\": file.type\n      });\n    };\n  });\n};\n\nconst extractPermissions = data => {\n  let result = [];\n  if (typeof data !== \"object\") {\n  } else if (!Array.isArray(data) && data.permission) {\n    result = result.concat([data.permission]);\n  } else if (!Array.isArray(data)) {\n    Object.keys(data).map(\n      key => (result = result.concat(extractPermissions(data[key])))\n    );\n  } else if (Array.isArray(data)) {\n    data.map(item => (result = result.concat(extractPermissions(item))));\n  }\n  return result;\n};\n","import React from \"react\";\nimport { createContext } from \"react\";\nimport { getContainerFromPath } from \"../lib/client\";\n\nexport const AuthContext = createContext({});\n\nexport const TraversalContext = createContext({});\n\nclass Traversal {\n  constructor(props) {\n    Object.assign(this, props);\n  }\n\n  setPath(path) {\n    // This is like black magic, document it\n    // router interactions are hard\n    this.setRouterParam({ path: path }, true);\n  }\n\n  refresh() {\n    this.dispatch({ type: \"REFRESH\" });\n  }\n\n  get path() {\n    return this.state.path;\n  }\n\n  get pathPrefix() {\n    return this.state.path.slice(1);\n  }\n\n  get context() {\n    return this.state.context;\n  }\n\n  get containerPath() {\n    return getContainerFromPath(this.path);\n  }\n\n  apply(data) {\n    // apply a optimistic update to context\n    this.dispatch({type: \"APPLY\", payload:data})\n  }\n\n  flash(message, type) {\n    this.dispatch({ type: \"SET_FLASH\", payload: { flash: { message, type } } });\n  }\n\n  clearFlash() {\n    this.dispatch({ type: \"CLEAR_FLASH\" });\n  }\n\n  doAction(action, params) {\n    this.dispatch({ type: \"SET_ACTION\", payload: { action, params } });\n  }\n\n  cancelAction() {\n    this.dispatch({ type: \"CLEAR_ACTION\" });\n  }\n\n  hasPerm(permission) {\n    return this.state.permissions[permission] === true;\n  }\n\n  filterTabs(tabs, tabsPermissions) {\n    const result = {};\n    Object.keys(tabs).forEach(item => {\n      const perm = tabsPermissions[item];\n      if (perm && this.hasPerm(perm)) {\n        result[item] = tabs[item];\n      } else if (!perm) {\n        result[item] = tabs[item];\n      }\n    });\n    return result;\n  }\n}\n\nexport function TraversalProvider({ children, ...props }) {\n  return (\n    <TraversalContext.Provider value={new Traversal(props)}>\n      {children}\n    </TraversalContext.Provider>\n  );\n}\n","import React from 'react'\nimport {classnames} from '../../lib/helpers'\n\nconst noop = () => {}\n\nexport const Button = ({\n  children,\n  className = 'is-primary',\n  onClick,\n  type = 'submit',\n  loading = false,\n  disabled = false,\n  ...rest\n}) => {\n\n  let css = [].concat(\n      'button', ...className.split(\" \"),\n  )\n  if (loading) css = css.concat('is-loading')\n  if (disabled) onClick = noop\n\n  return (\n    <p className=\"control\">\n      <button\n        type={type}\n        className={classnames(css)}\n        onClick={onClick}\n        disabled={disabled}\n        {...rest}\n        >\n        {children}\n      </button>\n    </p>\n  )\n}\n","import React from \"react\";\nimport usePortal from \"react-useportal\";\nimport {Button} from './input/button'\n\nexport function Modal(props) {\n  const { isActive, setActive, children } = props;\n  const { Portal } = usePortal();\n\n  const css = \"modal \" + (isActive ? \"is-active \" : \"\") + props.className;\n  return (\n    <Portal>\n      <div className={css}>\n        <div className=\"modal-background\" onClick={() => setActive(false)} />\n        <div className=\"modal-content\">\n          <div className=\"box\">{children}</div>\n        </div>\n        <button\n          className=\"modal-close is-large\"\n          aria-label=\"close\"\n          onClick={() => setActive(false)}\n        />\n      </div>\n    </Portal>\n  );\n}\n\nexport function Confirm({ message, onCancel, onConfirm, loading }) {\n  const setActive = p => onCancel();\n  return (\n    <Modal isActive setActive={setActive} className=\"confirm\">\n      <React.Fragment>\n        <h1 className=\"title is-size-5\">{message || \"Are you Sure?\"}</h1>\n        <div className=\"level\" style={{ marginTop: 50 }}>\n          <div className=\"level-left\"></div>\n          <div className=\"level-right\">\n            <button className=\"button is-danger\" onClick={() => onCancel()}>\n              Cancel\n            </button>\n            &nbsp;&nbsp;\n            <Button\n              loading={loading}\n              className=\"is-success\"\n              onClick={() => onConfirm()}\n              >Confirm</Button>\n          </div>\n        </div>\n      </React.Fragment>\n    </Modal>\n  );\n}\n\n// @todo Improve it... Replacing the inputText to a tree\nexport function PathTree({ title, onConfirm, onCancel }){\n  return (\n    <Modal isActive setActive={onCancel}>\n      <h1>{title}</h1>\n      <form onSubmit={e => {\n          e.preventDefault()\n          onConfirm(e.target[0].value)\n      }}>\n        <input\n          className=\"input\"\n          placeholder=\"/folder (without /db/container on front)\"\n          style={{ margin: '20px 0'}}\n          type=\"text\"\n        />\n        <div className=\"level-right\">\n          <button type=\"button\" className=\"button is-danger\" onClick={onCancel}>\n            Cancel\n          </button>\n          &nbsp;&nbsp;\n          <button type=\"submit\" className=\"button is-success\">\n            Confirm\n          </button>\n        </div>\n      </form>\n    </Modal>\n  )\n}\n","import React from \"react\";\n\nexport const Config = {\n  DisabledTypes: [\"UserManager\", \"GroupManager\"],\n  PageSize: 10,\n  DelayActions: 200,\n}\n\n\n\nlet calculated = Object.assign({}, Config);\n\nconst addConfig = (additional, original) => {\n  const rest = Object.assign({}, original);\n  Object.keys(additional).forEach(item => {\n    if (typeof Config[item] === \"object\" && Array.isArray(Config[item])) {\n      rest[item] = [].concat(Config[item], additional[item]);\n    } else if (typeof Config[item] === \"object\") {\n      rest[item] = Object.assign({}, Config[item], additional[item]);\n    } else {\n      rest[item] = additional[item];\n    }\n  });\n  return rest;\n};\n\nexport function useConfig(cfg) {\n  const ref = React.useRef();\n  if (cfg && !ref.current) {\n    console.log(\"cfg\", cfg)\n    calculated = addConfig(cfg, calculated);\n    ref.current = calculated\n  }\n\n  // if (cfg && !ref.current) {\n  //   ref.current = addConfig(cfg, ref.current);\n  //   calculated = ref.current\n  //   console.log(\"Current config\", cfg)\n  // }\n  return calculated\n}\n","import React from 'react'\nimport {Confirm} from '../components/modal'\nimport {useContext} from 'react'\nimport {TraversalContext} from '../contexts'\nimport {sleep} from '../lib/helpers'\nimport {useConfig} from '../hooks/useConfig'\n\n// BBB guillotina 5\nconst getId = (item) => {\n  if (item[\"@id\"]) {\n    return item[\"@id\"]\n  }\n  return item[\"@absolute_url\"]\n}\n\nexport function RemoveItems(props) {\n  const Ctx = useContext(TraversalContext)\n  const cfg = useConfig()\n  const [loading, setLoading] = React.useState(false)\n  const { items = [] } = props\n  const last = items[items.length - 1]['@name']\n  const itemsNames = items\n    .map(item => item['@name'])\n    .join(', ')\n    .replace(`, ${last}`, ` and ${last}`)\n\n  async function removeItems() {\n    let errors = []\n    setLoading(true)\n\n    const actions = items.map(async item => {\n      const res = await Ctx.client.delete(getId(item))\n      if (!res.ok) {\n        const err = await res.json()\n        errors.push(err)\n      }\n    })\n    // this sleep is here, to let elasticsearch, wait for\n    // index our operations... (will work 99% of use cases)\n    actions.push(sleep(cfg.DelayActions))\n\n    await Promise.all(actions)\n\n    if (errors.length === 0) {\n      Ctx.flash(`Items removed!`, 'success')\n      Ctx.refresh()\n    } else {\n      const errorstr = errors.map(err => JSON.stringify(err)).join(\"\\n\")\n      Ctx.flash(`Something went wrong!! ${errorstr}`, 'danger')\n    }\n    setLoading(false)\n    Ctx.cancelAction()\n  }\n\n  return (\n    <Confirm\n      loading={loading}\n      onCancel={() => Ctx.cancelAction()}\n      onConfirm={removeItems}\n      message={`Are you sure to remove: ${itemsNames}?`}\n    />\n  )\n}\n","import React, { useEffect, useRef } from \"react\";\nimport { classnames } from \"../../lib/helpers\";\n\nexport const Checkbox = ({\n  id,\n  className,\n  loading,\n  disabled,\n  indeterminate = false,\n  value = false,\n  color,\n  backgroundColor,\n  borderColor,\n  children,\n  placeholder,\n  onChange,\n  ...rest\n}) => {\n  const inputRef = useRef(null);\n  const [state, setState] = React.useState(value)\n\n  useEffect(() => {\n    if (inputRef.current) {\n      inputRef.current.indeterminate = indeterminate;\n    }\n  }, [indeterminate]);\n\n  const updateState = (ev) => {\n    setState(ev.target.checked)\n    onChange(ev.target.checked)\n  }\n\n  return (\n    <div className=\"field\">\n      <label htmlFor={id}\n        className={classnames([\"checkbox\", className])}\n        >\n        <input\n          ref={inputRef}\n          disabled={disabled || loading}\n          id={id}\n          type=\"checkbox\"\n          className=\"checkbox\"\n          checked={state}\n          onChange={updateState}\n          {...rest}\n        />\n        {children || placeholder}\n      </label>\n    </div>\n  );\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { classnames } from '../lib/helpers';\n\nconst ErrorZone = ({ children, id, className }) => {\n    return (\n        <p className={classnames(['help is-danger', className])} id={id}>\n            {children}\n        </p>\n    );\n};\n\nErrorZone.propTypes = {\n    children: PropTypes.node,\n    id: PropTypes.string,\n    className: PropTypes.string\n};\n\nexport default ErrorZone;\n","import React from \"react\";\n\nconst applyValidators = (value, validators) => {\n  let validation = Array.isArray(validators) ? validators : [validators];\n  let result = true;\n  validation.forEach(func => {\n    if (func(value) === false) {\n      result = false;\n    }\n  });\n  return result;\n};\n\nconst useInput = (onChange, value, validator) => {\n  let [state, setState] = React.useState({ hasError: false, value: value });\n\n  const onUpdate = ev => {\n    const value = (ev && ev.target) ? ev.target.value : (ev) ? ev : '';\n    setState({ value, hasError: false });\n    if (onChange)\n      onChange(value);\n  };\n\n  const onBlur = ev => {\n    const hasError = applyValidators(state.value, validator) === false;\n    if (hasError) setState({ value: state.value, hasError });\n  };\n\n  const onFocus = ev => {\n    if (state.hasError) {\n      setState({ value: state.value, hasError: false });\n    }\n  };\n\n  React.useEffect(() => {\n      setState({ value, hasError: false })\n   }, [value])\n\n  return {\n    onChange: onUpdate,\n    onFocus,\n    onBlur,\n    state\n  };\n};\n\nexport default useInput;\n","// From github.com/protonmail/proton-shared\n\n/* eslint-disable no-useless-escape */\nexport const REGEX_EMAIL = /(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))/i;\nexport const REGEX_URL = /((([A-Za-z]{3,9}:(?:\\/\\/)?)(?:[\\-;:&=\\+\\$,\\w]+@)?[A-Za-z0-9\\.\\-]+|(?:www\\.|[\\-;:&=\\+\\$,\\w]+@)[A-Za-z0-9\\.\\-]+)((?:\\/[\\+~%\\/\\.\\w\\-_]*)?\\??(?:[\\-\\+=&;%@\\.\\w_]*)#?(?:[\\.\\!\\/\\\\\\w]*))?)/;\nexport const REGEX_HEX_COLOR = /^#([a-f0-9]{3,4}|[a-f0-9]{4}(?:[a-f0-9]{2}){1,2})\\b$/i;\nexport const REGEX_NUMBER = /^\\d+$/;\n\nexport const isEmpty = (value = '') => !value.length;\nexport const maxLength = (value = '', limit = 0) => value.length <= limit;\nexport const minLength = (value = '', limit = 0) => value.length >= limit;\nexport const isEmail = (value = '') => REGEX_EMAIL.test(value);\nexport const isURL = (value = '') => REGEX_URL.test(value);\nexport const isHexColor = (value = '') => REGEX_HEX_COLOR.test(value);\nexport const isNumber = (value = '') => REGEX_NUMBER.test(value);\nexport const notEmpty = (value) => !!value.length\n\n","import React, { useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { classnames, generateUID } from \"../../lib/helpers\";\nimport ErrorZone from \"../error_zone\";\nimport useInput from \"../../hooks/useInput\";\nimport { notEmpty } from \"../../lib/validators\";\nimport { useEffect } from \"react\";\n\nconst noop = () => true;\n\n/** @type any */\nexport const Input = React.forwardRef(\n  (\n    {\n      icon,\n      iconPosition = \"has-icons-right\",\n      error,\n      errorZoneClassName,\n      autoComplete = \"off\",\n      className = \"\",\n      widget = \"input\",\n      type = \"text\",\n      onPressEnter,\n      isSubmitted,\n      loading = false,\n      required = false,\n      id,\n      placeholder,\n      value,\n      autofocus = false,\n      onChange,\n      validator = noop,\n      errorMessage,\n      ...rest\n    },\n    ref\n  ) => {\n    if (required) {\n      validator = Array.isArray(validator)\n        ? validator.push(notEmpty)\n        : [validator, notEmpty];\n    }\n\n    const { state, ...handlers } = useInput(onChange, value, validator);\n    const [uid] = useState(generateUID(\"input\"));\n    const [mounted, setMounted] = useState(false);\n    ref = ref || React.useRef();\n\n    useEffect(() => {\n      setMounted(true);\n    }, []);\n\n    useEffect(() => {\n      if (autofocus && !error) {\n        ref.current.focus();\n      }\n    }, [mounted, autofocus, ref, error]);\n\n    const theError = state.hasError ? errorMessage || \"invalid field\" : \"\";\n    const statusClasses = state.hasError ? \"is-danger\" : \"\";\n\n    const cssControl = () => (icon ? [\"control\", iconPosition] : [\"control\"]);\n\n    return (\n      <div className=\"field\">\n        {id && placeholder ? (\n          <label className=\"label\" htmlFor={id}>\n            {placeholder}\n          </label>\n        ) : null}\n        <div className={classnames(cssControl())}>\n          <input\n            className={classnames([widget, className, statusClasses])}\n            aria-invalid={theError}\n            aria-describedby={uid}\n            id={id}\n            ref={ref}\n            type={type}\n            value={state.value}\n            placeholder={placeholder}\n            autoComplete={autoComplete}\n            disabled={loading || rest.disabled}\n            required={required}\n            {...handlers}\n            {...rest}\n          />\n          {icon && icon}\n        </div>\n        <ErrorZone className={errorZoneClassName} id={uid}>\n          {state.hasError ? theError : \"\"}\n        </ErrorZone>\n      </div>\n    );\n  }\n);\n\nInput.propTypes = {\n  icon: PropTypes.node,\n  iconPosition: PropTypes.arrayOf(\n    PropTypes.oneOf([\"has-icons-left\", \"has-icons-right\", \"\"])\n  ),\n  error: PropTypes.string,\n  errorZoneClassName: PropTypes.string,\n  autoComplete: PropTypes.string,\n  autoFocus: PropTypes.bool,\n  className: PropTypes.string,\n  disabled: PropTypes.bool,\n  loading: PropTypes.bool,\n  isSubmitted: PropTypes.bool,\n  id: PropTypes.string,\n  name: PropTypes.string,\n  onChange: PropTypes.func,\n  onKeyDown: PropTypes.func,\n  onKeyUp: PropTypes.func,\n  onPressEnter: PropTypes.func,\n  placeholder: PropTypes.string,\n  readOnly: PropTypes.bool,\n  required: PropTypes.bool,\n  type: PropTypes.string,\n  value: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.number,\n    PropTypes.bool\n  ])\n};\n","import React from \"react\";\nimport { classnames } from \"../../lib/helpers\";\n\nexport const Icon = ({ icon, className, align }) => {\n  const addClass = className ? className.split(\" \") : [className];\n\n  align = align || \"is-right\";\n\n  return (\n    <span className={classnames([\"icon\", align, ...addClass])}>\n      <i className={icon}></i>\n    </span>\n  );\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { noop } from '../../lib/helpers';\nimport { classnames } from '../../lib/helpers';\n\n\nexport const Form = ({\n  children,\n  className = '',\n  onSubmit = noop,\n  onReset = noop,\n  autoComplete = 'off',\n  title,\n  error,\n  ...rest }\n) => {\n    const handleSubmit = (event) => {\n        event.preventDefault();\n        onSubmit(event);\n    };\n    return (\n      <React.Fragment>\n        {title && <div className=\"level\">\n            <h1 className=\"title is-size-4\">{title}</h1>\n        </div>}\n        {error && <div className=\"notification is-danger\">\n          {error}\n        </div>}\n        <form\n              onSubmit={handleSubmit}\n              onReset={onReset}\n              autoComplete={autoComplete}\n              className={classnames(['form', className])}\n              {...rest}\n          >\n              {children}\n          </form>\n        </React.Fragment>\n    );\n};\n\nForm.propTypes = {\n    children: PropTypes.node.isRequired,\n    className: PropTypes.string,\n    onSubmit: PropTypes.func,\n    onReset: PropTypes.func,\n    autoComplete: PropTypes.string\n};\n\n","import React from \"react\";\nimport { Form } from \"./form\";\nimport { Input } from \"./input\";\nimport { EmailInput } from \"./email\";\nimport { PasswordInput } from \"./password\";\nimport { Button } from \"./button\";\nimport { Checkbox } from \"./checkbox\";\nimport { generateUID } from \"../../lib/helpers\";\n\nconst formComponents = {\n  string: Input,\n  password: PasswordInput,\n  boolean: Checkbox,\n  email: EmailInput\n};\n\nexport function FormBuilder({\n  schema,\n  formData,\n  title,\n  onSubmit,\n  actionName,\n  children,\n  exclude = [],\n  remotes = [],\n  submitButton = true,\n  ...rest\n}) {\n  const ref = React.useRef();\n  const { properties, required } = schema;\n  const values = Object.assign({}, formData || {});\n\n  // build initial state\n  let initialState = {};\n  const fields = Object.keys(properties).filter(x => !exclude.includes(x));\n\n  fields.forEach(element => {\n    initialState[element] = values[element] || undefined;\n  });\n\n  // Register remotes\n  if (!ref.current) {\n    ref.current = {};\n    Object.keys(remotes).forEach(item => (ref.current[item] = remotes[item]));\n  } else {\n    // apply remote changes\n    Object.keys(remotes).forEach(key => {\n      if (JSON.stringify(ref.current[key]) !== JSON.stringify(remotes[key])) {\n        ref.current[key] = remotes[key];\n      }\n    });\n  }\n\n  ref.current = ref.current || {};\n  const onUpdate = field => ev => {\n    ref.current[field] = ev.target ? ev.target.value : ev.value || ev;\n  };\n\n  const GetTag = ({ field }) => {\n    const Tag =\n      formComponents[properties[field].widget || properties[field].type];\n\n    const props = {\n      label: properties[field].title,\n      value: initialState[field],\n      onChange: onUpdate(field),\n      placeholder: properties[field].title || \"\",\n      id: generateUID()\n    };\n\n    if (required.includes(field)) {\n      props.required = true;\n      props.placeholder += \" *\";\n    }\n    Tag.displayName = `${field}Field`;\n    return <Tag {...props} />;\n  };\n\n  const children_ = React.Children.map(children, child =>\n    React.cloneElement(child, { onChange: onUpdate })\n  );\n\n  const changes = () => {\n    onSubmit(ref.current, values);\n  };\n\n  return (\n    <Form onSubmit={changes} {...rest}>\n      {fields.map((field, i) => (\n        <GetTag field={field} key={field} />\n      ))}\n      {children_}\n      {submitButton && <Button>{actionName}</Button>}\n    </Form>\n  );\n}\n","import React from 'react'\nimport {Input} from './input';\n\n\nexport const PasswordInput = ({ value = '', ...rest }) => {\n    return <Input\n      value={value}\n      type=\"password\"\n      {...rest}\n    />;\n}\n","import React from 'react'\nimport {Input} from './input';\nimport {isEmail} from '../../lib/validators';\nimport {Icon} from '../ui/icon'\n\n\nexport const EmailInput = ({ value = '', ...rest }) => {\n    return <Input type=\"email\"\n      validator={isEmail}\n      errorMessage='Email address invalid'\n      value={value}\n      icon={<Icon icon='fas fa-envelope' />}\n      {...rest}\n    />;\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport { classnames } from '../../lib/helpers';\n\n// @ TODO implement hasErrors\n\n/** @type any */\nexport const Select = ({\n    options,\n    error,\n    size = 1,\n    className = '',\n    classWrap = '',\n    multiple = false,\n    loading = false,\n    isSubmitted,\n    onChange,\n    resetOnChange,\n    appendDefault = false,\n    style={},\n    ...rest\n}) => {\n\n    const ref = React.useRef()\n\n    const onUpdate = (ev) => {\n      if (ev.target.value === \"\") {\n        onChange({target:{value:undefined}})\n      } else {\n        onChange(ev)\n      }\n      if (resetOnChange) {\n        ref.current.value = ''\n      }\n    }\n\n    if (appendDefault) {\n      options = [{ text: \"Choose..\", value: \"\" }].concat(options)\n    }\n\n    const cssWrap = ['select', (multiple ? 'is-multiple' :''), classWrap]\n\n    return (\n        <div className={classnames(cssWrap)}>\n          <select\n              className={classnames(['', className])}\n              size={size}\n              multiple={multiple}\n              disabled={loading || rest.disabled}\n              onChange={onUpdate}\n              {...rest}\n              ref={ref}\n              style={style}\n          >\n              {options.map(({ text, ...rest }, index) => (\n                <option\n                  key={index.toString()} {...rest}>\n                  {text}\n                </option>\n              ))}\n          </select>\n        </div>\n    );\n};\n\nSelect.propTypes = {\n    error: PropTypes.string,\n    disabled: PropTypes.bool,\n    loading: PropTypes.bool,\n    isSubmitted: PropTypes.bool,\n    size: PropTypes.number,\n    onChange: PropTypes.func,\n    options: PropTypes.arrayOf(PropTypes.object),\n    multiple: PropTypes.bool,\n    className: PropTypes.string\n};\n\n","import React from \"react\";\nimport {lightFileReader} from '../../lib/client'\n\n\nexport function FileUpload({label, onChange, ...props}) {\n\n  const changed = async (event) => {\n    const file = await lightFileReader(event.target.files[0])\n    onChange(file)\n  }\n\n  return (\n    <div className=\"file\">\n      <label className=\"file-label\">\n        <input className=\"file-input\"\n          {...props}\n          type=\"file\"\n          name=\"file\"\n          onChange={changed}\n          />\n        <span className=\"file-cta\">\n          <span className=\"file-icon\">\n            <i className=\"fas fa-upload\"></i>\n          </span>\n          <span className=\"file-label\">{label || 'Choose a file'}</span>\n        </span>\n      </label>\n    </div>\n  );\n}\n","import React from \"react\";\n\nexport const Textarea = React.forwardRef(({\n  value = \"\",\n  rows = 5,\n  className,\n  onChange,\n  ...rest\n}, ref) => {\n  const css = \"textarea \" + className;\n\n  const onUpdate = ev => {\n    if (onChange) {\n      onChange(ev.target.value);\n    }\n  };\n\n  return (\n    <div className=\"field\">\n      <textarea\n        className={css}\n        rows={rows}\n        onChange={onUpdate}\n        value={value}\n        {...rest}\n        ref={ref}\n      />\n    </div>\n  );\n});\n","import React from \"react\";\nimport { useSetState } from \"react-use\";\nimport { TraversalContext } from \"../contexts\";\n\nconst initial = {\n  loading: undefined,\n  isError: false,\n  errorMessage: undefined,\n  result: undefined,\n  response: undefined\n};\n\nconst processResponse = async (res, ready_body=true) => {\n  if (res.status < 400)\n    return {\n      isError: false,\n      loading: false,\n      result: ready_body ? await res.json() : res.status,\n      response: res };\n  else\n    return {\n      isError: true,\n      loading: false,\n      errorMessage: res.status,\n      response: res };\n};\n\nconst patch = (state, setState, Ctx) => async (data, endpoint, body=false) => {\n  setState({ loading: true });\n  let newState = {};\n  try {\n    const path = endpoint ? `${Ctx.path}${endpoint}` : Ctx.path;\n    const res = await Ctx.client.patch(path, data);\n    newState = await processResponse(res, body)\n  } catch (e) {\n    console.error(\"Error\", e);\n    newState = { isError: true, errorMessage: \"unhandled exception\" };\n  }\n  setState(newState);\n  return newState;\n};\n\nconst del = (state, setState, Ctx) => async (data, endpoint, body=false) => {\n  setState({ loading: true });\n  let newState = {};\n  try {\n    const path = endpoint ? `${Ctx.path}${endpoint}` : Ctx.path;\n    const res = await Ctx.client.delete(path, data);\n    newState = await processResponse(res, body);\n  } catch (e) {\n    console.error(\"Error\", e);\n    newState = { isError: true, errorMessage: \"unhandled exception\" };\n  }\n  setState(newState);\n  return newState;\n};\n\nconst post = (state, setState, Ctx) => async (data, endpoint, body=true) => {\n  setState({ loading: true });\n  let newState = {};\n  try {\n    const path = endpoint ? `${Ctx.path}${endpoint}` : Ctx.path;\n    const res = await Ctx.client.post(path, data);\n    newState = await processResponse(res, body);\n  } catch (e) {\n    console.error(\"Error\", e);\n    newState = { isError: true, errorMessage: \"unhandled exception\" };\n  }\n  setState(newState);\n  return newState;\n};\n\nconst get = (state, setState, Ctx) => async (endpoint) => {\n  setState({loading:true})\n  const path = endpoint ? `${Ctx.path}${endpoint}` : Ctx.path;\n  const req = await Ctx.client.get(path)\n  const data = await req.json()\n  setState({loading: false, result:data, response:req})\n  return data\n};\n\nexport function useCrudContext() {\n  const Ctx = React.useContext(TraversalContext);\n  const [state, setState] = useSetState(initial);\n\n  return {\n    ...state,\n    Ctx,\n    patch: patch(state, setState, Ctx),\n    del: del(state, setState, Ctx),\n    post: post(state, setState, Ctx),\n    get: get(state, setState, Ctx),\n  };\n}\n","import React from 'react'\n\n\nexport const Loading = ({...rest}) => (\n  <div className=\"progress-line\" {...rest}></div>\n)\n","\nimport React from 'react'\nimport {classnames} from '../../lib/helpers'\n\nexport const Tag = ({name, onRemove, size='is-medium', color='is-warning'}) => (\n  <span className={classnames([\"tag\", color,  size])}>\n    {name}\n    {onRemove!==undefined &&\n      <button className=\"delete is-small\"\n        onClick={() => onRemove()}></button>}\n  </span>\n)\n","import React from 'react'\n\nexport function Delete({ onClick, children }) {\n  return (<button type=\"button\"\n    onClick={onClick} className=\"delete\">\n      {children}</button>\n  );\n}\n","import React from \"react\";\nimport { classnames } from \"../../lib/helpers\";\n\nexport function Table({ headers, children, className }) {\n  className = className\n    ? className.split(\" \")\n    : \" is-full is-fullwidth is-narrow\".split(\" \");\n  return (\n    <table className={classnames([\"table\", ...className])}>\n      <thead>\n        <tr>{headers && headers.map((item, idx) => <th key={item + idx}>{item}</th>)}</tr>\n      </thead>\n      <tbody>{children}</tbody>\n    </table>\n  );\n}\n","import React from \"react\";\n\n\nexport function Notification({isColor='', children}) {\n  return (\n    <div className={\"notification is-\" + isColor}>\n      {children}\n    </div>\n  );\n}\n","import React from \"react\";\nimport { Input } from \"../input/input\";\nimport { Button } from \"../input/button\";\nimport { useCrudContext } from \"../../hooks/useCrudContext\";\nimport { useState } from \"react\";\nimport { useRef } from \"react\";\nimport { useEffect } from \"react\";\nimport { Icon } from \"../ui\";\n\nexport function EditableField({ field, value, Type=Input, ns }) {\n  const ref = useRef();\n  const [isEdit, setEdit] = useState(false);\n  const {patch, loading, Ctx} = useCrudContext();\n  const [val, setValue] = useState(value);\n\n  const saveField = async ev => {\n    if (ev) ev.preventDefault();\n    const data = (ns) ? {[ns]: {[field]: val}} : { [field]: val }\n    await patch(data);\n    Ctx.flash(`Field ${field}, updated!`, \"success\");\n    Ctx.refresh();\n    setEdit(false);\n  };\n\n  useEffect(() => {\n    if (isEdit && ref.current) {\n      ref.current.focus();\n    }\n  });\n\n  return (\n    <React.Fragment>\n      {!isEdit && (\n        <div className=\"editable\" onClick={() => setEdit(true)}>\n          {value || 'Click to edit'}\n          <Icon icon=\"fas fa-edit\" />\n        </div>\n      )}\n\n      {isEdit && (\n        <div className=\"field\">\n          <form onSubmit={saveField}>\n            <div className=\"control\">\n              <Type\n                value={val || ''}\n                className=\"is-small\"\n                onChange={ev => setValue(ev)}\n                ref={ref}\n              />\n            </div>\n            <div className=\"field is-grouped\">\n              <div className=\"control\">\n                <Button\n                  className=\"is-small is-primary\"\n                  loading={loading}\n                  onClick={saveField}\n                >\n                  Save\n                </Button>\n              </div>\n              <div className=\"control\">\n                <Button className=\"is-small\" onClick={() => setEdit(false)}>\n                  Cancel\n                </Button>\n              </div>\n            </div>\n          </form>\n        </div>\n      )}\n    </React.Fragment>\n  );\n}\n","import React from 'react'\n\nconst plain = [\n  \"string\", \"number\", \"boolean\"\n]\n\n\nexport function RenderField({value, Widget}) {\n\n  if (!value) return ''\n\n  if (Widget) {\n    return <Widget value={value} />\n  }\n\n  const type = typeof value\n  if (plain.includes(type)) {\n    return value\n  }\n  if (type === \"object\") {\n     if (Array.isArray(value)) {\n       return value.map(item => <div key={item}><RenderField value={item} /></div>)\n     }\n     return Object.keys(value).map(key =>\n      <FieldValue field={key} value={value[key]} key={key} />\n    )\n  }\n  return <p>No render for {JSON.stringify(value)}</p>\n}\n\n\nconst FieldValue = ({field, value}) => (\n  <div className=\"field\">\n    <div className=\"label\">{field}</div>\n    <div className=\"value\">\n      <RenderField value={value} />\n    </div>\n  </div>\n)\n","import React from \"react\";\n\nimport { Icon } from \"../ui/icon\";\nimport { RenderField } from \"../fields/renderField\";\nimport { TraversalContext } from \"../../contexts\";\nimport { EditableField } from \"../fields/editableField\";\nimport { Textarea } from \"../input/textarea\";\nimport { Input } from \"../input/input\";\n\nconst Schema = {\n  editable: [\"title\", \"description\", \"effective_date\", \"expiration_date\"],\n  widgets: {\n    description: Textarea\n  }\n};\n\nexport function IDublinCore(props) {\n  const Ctx = React.useContext(TraversalContext);\n  const modifyContent = Ctx.hasPerm(\"guillotina.ModifyContent\");\n\n  return (\n    <React.Fragment>\n      {Object.keys(props).map(key => (\n        <tr key={'dublin_' + key}>\n          <td key={1}>{key}</td>\n          <td key={2}>\n            {Schema.editable.includes(key) && modifyContent && (\n              <EditableField\n                field={key}\n                value={props[key]}\n                Type={Schema.widgets[key] || Input}\n                ns=\"guillotina.behaviors.dublincore.IDublinCore\"\n              />\n            )}\n            {!Schema.editable.includes(key) && (\n              <RenderField value={props[key]} />\n            )}\n          </td>\n        </tr>\n      ))}\n    </React.Fragment>\n  );\n}\n\nexport function Author({ name }) {\n  return (\n    <div className=\"container\">\n      <Icon icon=\"fas fa-user\" />\n      <span>{name}</span>\n    </div>\n  );\n}\n","\nimport React from 'react'\nimport { TraversalContext } from '../../contexts'\nimport { useAsync } from 'react-use'\n\n\n// TODO: Refactor without useAsync... just crudContext\nexport function PanelAddons(props) {\n  const Ctx = React.useContext(TraversalContext)\n  let [action, setAction] = React.useState(false)\n\n  const installAddon = async (Ctx, key) => {\n    await Ctx.client.installAddon(Ctx.pathPrefix, key)\n    Ctx.flash(`Addon ${key} installed`, 'success')\n    setAction(!action)\n  }\n\n  const removeAddon = async (Ctx, key) => {\n    await Ctx.client.removeAddon(Ctx.pathPrefix, key)\n    Ctx.flash(`Addon ${key} removed`, 'success')\n    setAction(!action)\n  }\n\n  const state = useAsync(async () => {\n    const response = await Ctx.client.getAddons(Ctx.pathPrefix)\n    const data = await response.json()\n    return prepareData(data)\n  }, [action])\n\n  return (\n    <React.Fragment>\n      {state.loading\n        ? <div>loading</div>\n          : state.error\n            ? <p>Error: {state.error.message}</p>\n          : (\n          <div className=\"columns\">\n            <div className=\"column\">\n              <h2 className=\"title is-size-4 has-text-grey-dark\">Available Addons</h2>\n              <hr />\n              {state.value.available.length === 0 &&\n                <p>No Addon available in this container</p>}\n              <table className=\"table is-12\">\n                <tbody>\n                {state.value.available.map(addon =>\n                  <tr>\n                    <td>{addon.title}</td>\n                    <td>\n                      <button className=\"button is-primary is-small\"\n                        onClick={() => installAddon(Ctx, addon.id)}>\n                        Install\n                      </button>\n                    </td>\n                  </tr>\n                  )}\n                </tbody>\n              </table>\n          </div>\n          <div className=\"column\">\n            <h2 className=\"title is-size-4 has-text-grey-dark\">Installed Addons</h2>\n            <hr />\n            {state.value.installed.length === 0 &&\n              <p>No Addon installed in this container</p>}\n              <table className=\"table is-12\">\n              <tbody>\n              {state.value.installed.map(addon =>\n                <tr>\n                  <td>{addon.title}</td>\n                  <td>\n                    <button className=\"button is-danger is-small\"\n                      onClick={() => removeAddon(Ctx, addon.id)}>\n                      Remove\n                    </button>\n                  </td>\n                </tr>\n              )}\n              </tbody>\n            </table>\n          </div>\n        </div>\n          )\n        }\n    </React.Fragment>\n  )\n\n}\n\nconst prepareData = (result) => {\n  const addons = arrayToObject(result.available)\n  return {\n    available: result.available.filter(\n      item => !result.installed.includes(item.id)),\n    installed: result.installed.map(id => addons[id])\n  }\n}\n\nconst arrayToObject = (array) =>\n   array.reduce((obj, item) => {\n     obj[item.id] = item\n     return obj\n   }, {})\n","import React from \"react\";\nimport { useCrudContext } from \"../../hooks/useCrudContext\";\nimport { Table } from \"../ui/table\";\nimport { Button } from \"../input/button\";\n\nexport function PanelBehaviors() {\n  const { Ctx, get, result, loading, isError } = useCrudContext();\n  const ops = useCrudContext();\n\n  const [state, setState] = React.useState(false);\n\n  const enableBehavior = behavior => async () => {\n    await ops.patch({ behavior }, \"@behaviors\");\n    setState(!state);\n    Ctx.refresh()\n  };\n\n  const disableBehavior = behavior => async () => {\n    await ops.del({ behavior }, \"@behaviors\");\n    setState(!state);\n    Ctx.refresh()\n  };\n\n  React.useEffect(() => {\n    (async () => {\n      await get(\"@behaviors\");\n    })();\n  }, [state]);\n\n  return (\n    <div className=\"columns behaviors\">\n      <div className=\"column is-8 is-size-7\">\n        <h2 className=\"title is-size-5 has-text-grey-dark\">Behaviors</h2>\n        {!loading && !isError && result && (\n          <React.Fragment>\n            <Table>\n              <tr>\n                <td colSpan=\"3\">\n                  <h3 className=\"title is-size-6\">Static</h3>\n                </td>\n              </tr>\n              {result.static.map(behavior => (\n                <tr key={behavior}>\n                  <td>Static</td>\n                  <td>{behavior}</td>\n                  <td className=\"\">\n                    <Button className=\"is-small is-pulled-right\" disabled>\n                      Disable\n                    </Button>\n                  </td>\n                </tr>\n              ))}\n            </Table>\n            <Table>\n              <tr>\n                <td colSpan=\"3\">\n                  <h3 className=\"title is-size-6\">Enabled</h3>\n                </td>\n              </tr>\n              {result.dynamic.map(behavior => (\n                <tr key={behavior}>\n                  <td>Enabled</td>\n                  <td>{behavior}</td>\n                  <td>\n                    <Button\n                      className=\"is-small is-danger is-pulled-right\"\n                      onClick={disableBehavior(behavior)}\n                    >\n                      Disable\n                    </Button>\n                  </td>\n                </tr>\n              ))}\n            </Table>\n            <Table>\n              <tr>\n                <td colSpan=\"3\">\n                  <h3 className=\"title is-size-6\">Available</h3>\n                </td>\n              </tr>\n              {result.available.map(behavior => (\n                <tr key={behavior}>\n                  <td>Available</td>\n                  <td>{behavior}</td>\n                  <td>\n                    <Button\n                      className=\"is-small is-primary is-pulled-right\"\n                      onClick={enableBehavior(behavior)}\n                    >\n                      Enable\n                    </Button>\n                  </td>\n                </tr>\n              ))}\n            </Table>\n          </React.Fragment>\n        )}\n      </div>\n      <div className=\"column is-4\"></div>\n    </div>\n  );\n}\n","\n\nexport const formatDate = (str) => {\n  const d = new Date(str)\n  const minutes = (d.getMinutes() < 10) ? `0${d.getMinutes()}` : d.getMinutes()\n  return `${d.getDate()}/${d.getMonth() +1}/${d.getFullYear()} ${d.getHours()}:${minutes}`\n}\n","\n\nconst base = {\n  local: {\n    roleperm: {},\n    prinperm: {},\n    prinrole: {}\n  },\n  inherit: {}\n}\n\nexport class Sharing {\n  constructor(element) {\n    Object.assign(this, element || base)\n  }\n\n  get roles() {\n    return Object.keys(this.local.roleperm)\n  }\n\n  getRole(role) {\n    return this.local.roleperm[role]\n  }\n\n  get principals() {\n    return Object.keys(this.local.prinperm)\n  }\n\n  getPrincipals(principal) {\n    return this.local.prinperm[principal]\n  }\n\n  get prinrole() {\n    return Object.keys(this.local.prinrole)\n  }\n\n  getPrinroles(role) {\n    return this.local.prinrole[role]\n  }\n\n}\n\n","import { formatDate } from \"../lib/utils\";\nimport {useConfig} from '../hooks/useConfig';\n\nexport * from './sharing'\n\nexport class ItemModel {\n  constructor(item, url, path) {\n    this.item = item;\n    this.url = url;\n    this._path = path;\n  }\n\n  get path() {\n    // Compat\n    let item = (this.item[\"@id\"]) ? this.item[\"@id\"] : this.item[\"@absolute_url\"]\n    let path = item.split(\"//\")[1].split(\"/\").splice(1).join(\"/\")\n    path = `/${path}/`\n    if (this.url.length > 0) {\n      if (this.url.startsWith(\"/\")) {\n        path = path.replace(this.url.substring(1), \"\")\n      } else {\n        path = path.replace(this.url, \"\")\n      }\n    }\n\n    return path\n  }\n\n  get name() {\n    return this.item.title || this.item[\"@name\"];\n  }\n\n  get icon() {\n\n    const cfg = useConfig()\n    if (cfg.icons && cfg.icons[this.type]) {\n      return cfg.icons[this.type]\n    }\n\n    switch (this.type) {\n      case \"GroupManager\":\n        return \"fas fa-users-cog\";\n      case \"UserManager\":\n        return \"fas fa-user-cog\";\n      case \"User\":\n        return \"fas fa-user\";\n      case \"Group\":\n        return \"fas fa-users\";\n      case \"Folder\":\n        return \"fas fa-folder\";\n      default:\n        return \"fas fa-file\";\n    }\n  }\n\n  get fullPath() {\n    return this._url + this.item.id;\n  }\n\n  get id() {\n    if (this.item.id) {\n      return this.item.id;\n    }\n    let id = this.item[\"@id\"].split(\"&\")[0].split(\"/\");\n    return id[id.length - 1];\n  }\n\n  get uid() {\n    return this.item[\"@uid\"];\n  }\n\n  get type() {\n    return this.item[\"@type\"] || this.item.type_name;\n  }\n\n  get title() {\n    return this.item.title;\n  }\n\n  get created() {\n    return this.item.creation_date ? formatDate(this.item.creation_date) : \"\";\n  }\n\n  get updated() {\n    return this.item.modification_date\n      ? formatDate(this.item.modification_date)\n      : \"\";\n  }\n}\n\nexport const Permissions = [\n  \"guillotina.AddContent\",\n  \"guillotina.ModifyContent\",\n  \"guillotina.ViewContent\",\n  \"guillotina.DeleteContent\",\n  \"guillotina.AccessContent\",\n  \"guillotina.SeePermissions\",\n  \"guillotina.ChangePermissions\",\n  \"guillotina.MoveContent\",\n  \"guillotina.DuplicateContent\",\n  \"guillotina.ReadConfiguration\",\n  \"guillotina.RegisterConfigurations\",\n  \"guillotina.WriteConfiguration\",\n  \"guillotina.ManageAddons\",\n  \"guillotina.swagger.View\",\n];\n","import React, { useState, useRef } from 'react'\nimport { useClickAway } from 'react-use';\n\nexport default function Dropdown({ \n  children, \n  disabled,\n  id, \n  isRight,\n  onChange,\n  optionDisabledWhen,\n  options,\n  ...props \n}) {\n  const ref = useRef(null);\n  const [isActive, setIsActive] = useState(false)\n  const position = isRight ? 'is-right' : ''\n  const status = isActive\n    ? `dropdown ${position} is-active`\n    : `dropdown ${position}`\n\n  useClickAway(ref, () => { setIsActive(false) })\n\n  return (\n    <div ref={ref} className={status} {...props}>\n      <div className=\"dropdown-trigger\">\n        <button\n          className=\"button is-size-7\"\n          onClick={() => setIsActive(!isActive)}\n          aria-haspopup=\"true\"\n          disabled={disabled}\n          aria-controls={id}\n        >\n          {children}\n        </button>\n      </div>\n      <div className=\"dropdown-menu\" id={id} role=\"menu\">\n        <div className=\"dropdown-content\">\n          {\n            options.map(option => {\n              const disabled = typeof optionDisabledWhen === 'function' \n              ? optionDisabledWhen(option)\n              : false\n              \n              return (\n                // eslint-disable-next-line jsx-a11y/anchor-is-valid\n                <a \n                  className={\n                    disabled ? 'dropdown-item is-active' : 'dropdown-item'\n                  }\n                  key={option.text}\n                  onClick={disabled ? undefined : () => onChange(option.value)}\n                  style={disabled ? {\n                    cursor: 'not-allowed',\n                    color: 'black',\n                    opacity: 0.5,\n                    backgroundColor: '#eeeeee'\n                  } : {}}\n                >\n                  {option.text}\n                </a>\n              )}\n            )}\n        </div>\n      </div>\n    </div>\n  )\n}\n","import React, { createContext, useState, useContext } from 'react'\nimport Dropdown from './input/dropdown'\nimport { Checkbox } from './input/checkbox'\nimport { TraversalContext } from '../contexts'\n\nconst ItemsActionsCtx = createContext({})\nconst actions = {\n  DELETE: {\n    text: 'Delete',\n    perms: ['guillotina.DeleteContent'],\n    action: 'removeItems'\n  },\n  MOVE: {\n     text: 'Move to...',\n     perms: ['guillotina.MoveContent'],\n     action: 'moveItems'\n  },\n  COPY: {\n    text: 'Copy to...',\n    perms: ['guillotina.DuplicateContent'],\n    action: 'copyItems'\n  },\n}\n\n/**\n * Actions to apply after select some items\n * Ex: Delete, Move, Copy...\n */\nexport function ItemsActionsProvider({ items, children }) {\n  const traversal = useContext(TraversalContext);\n  const [selected, setSelected] = useState({})\n\n  function onSelectAllItems(checked){\n    setSelected(items.reduce((obj, item) => {\n      obj[`${item.path}/${item.id}`] = checked\n      return obj\n    } , { all: checked }))\n  }\n\n  function onSelectOneItem(item) {\n    setSelected(state => ({\n      ...state,\n      all: false,\n      [`${item.path}/${item.id}`]: !state[`${item.path}/${item.id}`]\n    }))\n  }\n\n  function onAction(actionKey) {\n    traversal.doAction(actions[actionKey].action, {\n      items: items.filter(item => selected[`${item.path}/${item.id}`])\n    })\n  }\n\n  return (\n    <ItemsActionsCtx.Provider value={{\n      onAction,\n      onSelectAllItems,\n      onSelectOneItem,\n      selected,\n    }}>\n      {children}\n    </ItemsActionsCtx.Provider>\n  )\n}\n\n/**\n * Checkbox component without props that consume the ItemsActionsContext\n * and it select/unselect all items of the page.\n */\nexport function AllItemsCheckbox() {\n  const {onSelectAllItems, selected } = useContext(ItemsActionsCtx)\n\n  return (\n     <Checkbox\n      key={selected.all}\n      onChange={onSelectAllItems}\n      style={{ marginLeft: 2 }}\n      value={selected.all}\n     />\n  )\n}\n\n/**\n * Checkbox component to select ONE item.\n */\nexport function ItemCheckbox({ item }) {\n  const { selected, onSelectOneItem } = useContext(ItemsActionsCtx)\n  const absId = `${item.path}/${item.id}`\n  const value = selected[absId]\n\n  return (\n    <Checkbox\n      key={value}\n      onChange={() => onSelectOneItem(item)}\n      value={value}\n     />\n  )\n}\n\n/**\n * Dropdown to choose some action to apply to the selected items.\n */\nexport function ItemsActionsDropdown() {\n  const traversal = useContext(TraversalContext);\n  const { selected, onAction } = useContext(ItemsActionsCtx)\n  const disabled = Object.values(selected).every(v => !v)\n  const options = Object.keys(actions)\n    .map(action => ({ text: actions[action].text, value: action }))\n\n  return (\n    <Dropdown\n      disabled={disabled}\n      id=\"items-actions\"\n      onChange={onAction}\n      optionDisabledWhen={\n        o => actions[o.value].perms.some(perm => !traversal.hasPerm(perm))\n      }\n      options={options}\n    >\n      Choose action...\n    </Dropdown>\n  )\n}\n","import React from \"react\";\n\nimport { ItemModel } from \"../models\";\nimport { TraversalContext } from \"../contexts\";\nimport { useContext } from \"react\";\nimport { Icon } from \"./ui/icon\";\nimport { ItemCheckbox } from \"./selected_items_actions\";\nimport { Delete } from \"./ui\";\n\nexport function Item({ item, setPath, icon }) {\n  const Ctx = useContext(TraversalContext);\n  const link = () => Ctx.setPath(item.path);\n  return (\n    <tr>\n      <td onClick={link} style={{ width: \"25px\" }}>\n        {icon && <Icon icon={icon} />}\n      </td>\n      <td onClick={link}>{item.id}</td>\n    </tr>\n  );\n}\n\nconst smallcss = {\n  width: \"25px\"\n};\n\nconst mediumcss = {\n  width: \"120px\"\n};\n\nexport function RItem({ item, search }) {\n  const traversal = useContext(TraversalContext);\n  const model = new ItemModel(item, traversal.url, traversal.path);\n  const link = () => traversal.setPath(model.path);\n\n  return (\n    <tr key={item}>\n      <td style={smallcss}>\n        <ItemCheckbox item={item} />\n      </td>\n      <td style={smallcss}>{<Icon icon={model.icon} />}</td>\n      <td style={smallcss} onClick={link}>\n        <span className=\"tag\">{model.type}</span>\n      </td>\n      <td onClick={link}>\n        {model.name}\n        {search && (\n          <React.Fragment>\n            <br />\n            <span className=\"is-size-7 tag is-light\">{model.path}</span>\n          </React.Fragment>\n        )}\n      </td>\n      <td style={mediumcss} className=\"is-size-7 is-vcentered\">\n        {model.created}\n      </td>\n      <td style={mediumcss} className=\"is-size-7 is-vcentered\">\n        {model.updated}\n      </td>\n      <td style={smallcss}>\n        {traversal.hasPerm(\"guillotina.DeleteContent\") && (\n          <Delete onClick={() => traversal.doAction(\"removeItems\", {items:[model.item]})} />\n        )}\n      </td>\n    </tr>\n  );\n}\n\nexport function ItemTitle({ title, actions }) {\n  return (\n    <nav className=\"level\">\n      <div className=\"level-left\">\n        <div className=\"level-item\">\n          <h4 className=\"title has-text-primary is-size-5\">{title}</h4>\n        </div>\n      </div>\n      <div className=\"level-right\">\n        <div className=\"level-item\">{actions && actions}</div>\n      </div>\n    </nav>\n  );\n}\n","import React from 'react'\n\n/* eslint jsx-a11y/anchor-is-valid: \"off\" */\nexport function Pagination({current, total, doPaginate, pager}) {\n\n  const maxPages = Math.ceil(total/pager)\n  if (maxPages <= 1) {\n    return null\n  }\n\n  return (\n    <div>\n    <p className=\"level-right has-text-grey is-size-7\">\n        <span className=\"has-text-black\">{current+1}</span>/\n        <span className=\"has-text-black\">{maxPages}</span>&nbsp;of {total} items</p>\n    <nav className=\"pagination is-size-7\" role=\"navigation\" aria-label=\"pagination\">\n\n      <a className=\"pagination-previous is-small\"\n        disabled={current===0}\n        onClick={() => (current>0) ? doPaginate(current-1) : null}>\n          <span className=\"icon\">\n            <i className=\"fas fa-arrow-left\"></i>\n          </span>\n        </a>\n      <a className=\"pagination-next is-small\"\n        disabled={current >= maxPages}\n        onClick={() => doPaginate(current+1)}>\n          <span className=\"icon\">\n            <i className=\"fas fa-arrow-right\"></i>\n          </span>\n        </a>\n\n    </nav>\n    </div>\n  )\n}\n\n","import React from \"react\";\nimport { useEffect, useRef, useState, useCallback } from \"react\";\n\n// Mostly inspired from\n// https://github.com/molefrog/wouter\n\n\nconst setURLParams = p =>\n    window.history[\"pushState\"](\n      0,\n      0,\n      (window.history.pathname || '' ) + \"?\" + p.toString().replace(/%2F/g, \"/\")\n    );\n\n  const clean = to => {\n    const current = new URLSearchParams();\n    Object.keys(to).forEach(_key => current.set(_key, to[_key]));\n    setURLParams(current);\n  };\n\n\nexport const useLocation = ({ base = \"\" } = {}) => {\n  const [path, update] = useState(currentSearchParams());\n  const prevPath = useRef(path);\n\n  useEffect(() => {\n    patchHistoryEvents();\n\n    // this function checks if the location has been changed since the\n    // last render and updates the state only when needed.\n    // unfortunately, we can't rely on `path` value here, since it can be stale,\n    // that's why we store the last pathname in a ref.\n    const checkForUpdates = () => {\n      const pathname = currentSearchParams();\n      prevPath.current !== pathname && update((prevPath.current = pathname));\n    };\n\n    const events = [\"popstate\", \"pushState\", \"replaceState\"];\n    events.map(e => window.addEventListener(e, checkForUpdates));\n\n    // it's possible that an update has occurred between render and the effect handler,\n    // so we run additional check on mount to catch these updates. Based on:\n    // https://gist.github.com/bvaughn/e25397f70e8c65b0ae0d7c90b731b189\n    checkForUpdates();\n\n    return () =>\n      events.map(e => window.removeEventListener(e, checkForUpdates));\n  }, []);\n\n\n\n  // the 2nd argument of the `useLocation` return value is a function\n  // that allows to perform a navigation.\n  //\n  // the function reference should stay the same between re-renders, so that\n  // it can be passed down as an element prop without any performance concerns.\n  const navigate = useCallback(\n    (to, replace) => {\n      if (replace) {\n        clean(to);\n        return;\n      }\n      let current = new URLSearchParams(path.toString());\n      Object.keys(to).forEach(_key => current.set(_key, to[_key]));\n      setURLParams(current);\n    },\n    [path]\n  );\n\n  const remove = useCallback(\n    param => {\n      let current = new URLSearchParams(path.toString());\n      current.delete(param);\n      setURLParams(current);\n    },\n    [path]\n  );\n\n  return [path, navigate, remove];\n};\n\n// While History API does have `popstate` event, the only\n// proper way to listen to changes via `push/replaceState`\n// is to monkey-patch these methods.\n//\n// See https://stackoverflow.com/a/4585031\n\nlet patched = 0;\n\nconst patchHistoryEvents = () => {\n  if (patched) return;\n\n  [\"pushState\", \"replaceState\"].map(type => {\n    const original = window.history[type];\n\n    window.history[type] = function() {\n      const result = original.apply(this, arguments);\n      const event = new Event(type);\n      event.arguments = arguments;\n\n      dispatchEvent(event);\n      return result;\n    };\n  });\n\n  return (patched = 1);\n};\n\nconst currentSearchParams = (path = window.location.search) =>\n  new URLSearchParams(path);\n","import React from \"react\";\nimport { Tag } from \"./ui/tag\";\nimport {useLocation} from '../hooks/useLocation'\n\nexport function SearchLabels(props) {\n\n  const [location, , del] = useLocation()\n  const search = location.get(\"q\")\n\n  const clearSearch = () => {\n    del(\"q\")\n  };\n\n  return (\n    <div className=\"tags\">\n      {search && <Tag name=\"Search:\" color=\"is-light\" size=\"is-size-7\" />}\n      {search && (\n        <Tag name={search} color=\"is-info\" size=\"is-size-7\" onRemove={() => clearSearch()} />\n      )}\n    </div>\n  );\n}\n","const SEP = \"=\";\nconst DEFAULT_FIELD = \"title__in\";\nconst CLEANER = \"||\";\n\nexport function parser(qs, defaultField = DEFAULT_FIELD) {\n  let lastKey = undefined;\n  qs.trim();\n\n  if (qs.includes('\"')) {\n    qs = qs.replace(/\"(\\w+) (\\w+)\"/, `$1${CLEANER}$2`);\n  }\n\n  qs = qs.split(\" \");\n  return qs.map(part => {\n    if (part.includes(CLEANER)) {\n      part = part.replace(\"||\", \" \");\n    }\n    if (!part.includes(SEP)) {\n      return !lastKey ? [defaultField, part] : [lastKey, part];\n    }\n    const [key, val] = part.split(SEP);\n    lastKey = key;\n    return [key, val];\n  });\n}\n\nexport function buildQs(parsedQuery) {\n  return parsedQuery\n    .map(\n      ([key, val]) => `${encodeURIComponent(key)}=${encodeURIComponent(val)}`\n    )\n    .join(\"&\");\n}\n","import React from \"react\";\nimport { useContext } from \"react\";\nimport { useSetState } from \"react-use\";\nimport { useEffect } from \"react\";\nimport { TraversalContext } from \"../../contexts\";\nimport { RItem } from \"../item\";\nimport { Pagination } from \"../pagination\";\nimport { SearchLabels } from \"../../components/searchLabels\";\nimport { buildQs } from \"../../lib/search\";\nimport { useLocation } from \"../../hooks/useLocation\";\nimport { parser } from \"../../lib/search\";\nimport { useConfig } from \"../../hooks/useConfig\"\nimport { ItemsActionsProvider, AllItemsCheckbox, ItemsActionsDropdown } from \"../selected_items_actions\"\n\nconst initialState = {\n  page: 0,\n  items: [],\n  loading: true,\n  total: 0\n};\n\nexport function PanelItems(props) {\n  const [location, setLocation] = useLocation();\n  const {PageSize} = useConfig()\n\n  const Ctx = useContext(TraversalContext);\n  const [state, setState] = useSetState(initialState);\n  const { items, loading, total } = state;\n\n  let search = location.get(\"q\");\n  let page;\n\n  try {\n    page = parseInt(location.get(\"page\")) || 0;\n  } catch {\n    page = 0;\n  }\n\n  let searchParsed = undefined\n  if (search && search !== \"\") {\n    searchParsed = parser(search);\n  }\n\n  useEffect(() => {\n    if(Ctx.state.loading) return\n    (async () => {\n      let data;\n      setState({ loading: true, total: Ctx.context.length });\n      if (search) {\n        let qs = buildQs(searchParsed);\n        data = await Ctx.client.search(\n          Ctx.path,\n          qs,\n          false,\n          false,\n          page * PageSize,\n          PageSize\n        );\n\n      } else {\n        data = await Ctx.client.getItems(Ctx.path, page * PageSize, PageSize);\n      }\n      setState({\n        items: data.member,\n        loading: false,\n        total: data.items_count\n      });\n    })();\n  }, [search, Ctx.state.refresh, page]);\n\n\n  const doPaginate = page => {\n    setLocation({ page: page });\n  };\n\n  return (\n    <ItemsActionsProvider items={items}>\n      <div className=\"columns\">\n        <div className=\"column is-2 is-size-7\">\n          <ItemsActionsDropdown />\n        </div>\n        <div className=\"column\">\n          <SearchLabels />\n        </div>\n        <div className=\"column\">\n          <Pagination\n            current={page}\n            total={total}\n            doPaginate={doPaginate}\n            pager={PageSize}\n          />\n        </div>\n      </div>\n      {loading && <div className=\"progress-line\"></div>}\n      {!loading && (\n        <table className=\"table is-fullwidth is-hoverable\">\n          <thead className=\"is-size-7\">\n            <tr>\n              <th><AllItemsCheckbox /></th>\n              <th></th>\n              <th className=\"has-text-info\">type</th>\n              <th className=\"has-text-info\">id/name</th>\n              <th className=\"has-text-info\">created</th>\n              <th className=\"has-text-info\">modified</th>\n              <th>&nbsp;</th>\n            </tr>\n          </thead>\n          <tbody>\n            {items &&\n              items.map(item => (\n                <RItem item={item}\n                  setPath={Ctx.setPath}\n                  key={item[\"@uid\"]}\n                  search={search}\n                  />\n              ))}\n            {items && items.length === 0 && (\n              <tr>\n                <td colSpan=\"6\" className=\"has-text-centered\">\n                  Anything here!\n                </td>\n              </tr>\n            )}\n          </tbody>\n        </table>\n      )}\n    </ItemsActionsProvider>\n  );\n}\n","import React from \"react\";\nimport { Table } from \"./ui/table\";\nimport { TraversalContext } from \"../contexts\";\n\n\nexport function BehaviorsView({ context}) {\n\n  const Ctx = React.useContext(TraversalContext)\n  const {getBehavior} = Ctx.registry\n\n  const behaviors = [].concat(\n    context.__behaviors__,\n    context[\"@static_behaviors\"]\n  );\n  const GetBehavior = b => {\n    const Cls = getBehavior(b, BehaviorNotImplemented);\n    return <Cls {...context[b]} />;\n  };\n\n  return (\n    <React.Fragment>\n      {behaviors.map(behavior => (\n        <div className=\"container\" key={behavior}>\n          <h3 className=\"title is-size-6 has-text-grey\">{behavior}</h3>\n          <Table\n            headers={[\"Field\", \"Value\"]}\n            className=\"is-striped is-fullwidth is-size-7\"\n          >\n            {GetBehavior(behavior)}\n          </Table>\n          <hr />\n        </div>\n      ))}\n    </React.Fragment>\n  );\n}\n\nexport function BehaviorNotImplemented() {\n  return (\n    <tr>\n      <td colSpan=\"3\">Not Implemented</td>\n    </tr>\n  );\n}\n\n\n\n\n/*\n<tr>\n  <td>Creators</td>\n  <td>{Ctx.context.creators.map(item =>\n    <Author name={item}  key={'a' + item} />\n    )}</td>\n</tr> */\n\n\n","\nimport React from \"react\"\nimport { TraversalContext } from \"../contexts\";\n\n\nexport function PropertiesButtonView(properties) {\n  const Ctx = React.useContext(TraversalContext)\n  const {getProperties} = Ctx.registry\n\n  const Props = getProperties(Ctx.context[\"@type\"])\n\n  if (Props.Buttons) {\n    const Element = React.cloneElement(Props.Buttons, {Ctx: Ctx})\n    return Element\n  }\n  return null\n}\n\n\nexport function PropertiesView(props) {\n  const Ctx = React.useContext(TraversalContext)\n  const {getProperties} = Ctx.registry\n  const Props = getProperties(Ctx.context[\"@type\"])\n\n\n  if (Props.Panels) {\n    const Element = React.cloneElement(Props.Panels, {Ctx: Ctx})\n    return Element\n  }\n  return null\n}\n","import React from \"react\";\nimport { TraversalContext } from \"../../contexts\";\nimport { ItemModel } from \"../../models\";\nimport { BehaviorsView } from \"../behavior_view\";\nimport { Icon } from \"../ui/icon\";\nimport { EditableField } from \"../fields/editableField\";\nimport { RenderField } from \"../fields/renderField\";\nimport { PropertiesButtonView } from '../properties_view';\nimport { PropertiesView} from '../properties_view';\nimport {useConfig} from '../../hooks/useConfig'\n\n\nconst _showProperties = [\"@id\", \"@name\", \"@uid\", \"title\"];\nconst _editable = [\"title\"];\n\nexport function PanelProperties(props) {\n  const Ctx = React.useContext(TraversalContext);\n  const modifyContent = Ctx.hasPerm(\"guillotina.ModifyContent\");\n  const cfg = useConfig()\n\n  const model = new ItemModel(Ctx.context);\n\n  const showProperties = cfg.properties_default || _showProperties\n  const editable = cfg.properties_editable || _editable\n\n  return (\n    <div className=\"container\">\n      <div className=\"level\">\n        <div className=\"level-left\">\n          <h2 className=\"title is-size-4 is-primary\">\n            <Icon icon={model.icon} align=\"is-left\" className=\"has-text-grey\" />{\" \"}\n            &nbsp;\n            <span>{Ctx.context.title || Ctx.context[\"@name\"]}</span>\n          </h2>\n        </div>\n        <div className=\"level-right\">\n          <PropertiesButtonView />\n        </div>\n      </div>\n\n      <hr />\n      <div className=\"columns\">\n        <div className=\"column\">\n          <table className=\"table is-striped is-fullwidth is-size-7\">\n            <thead>\n              <tr>\n                <th className=\"is-2\">Prop</th>\n                <th className=\"is-8\">Value</th>\n              </tr>\n            </thead>\n            <tbody>\n              {showProperties.map(prop => (\n                <tr key={\"prop\" + prop}>\n                  <td>{prop}</td>\n                  <td>\n                    {editable.includes(prop) && modifyContent ? (\n                      <EditableField field={prop} value={Ctx.context[prop]} />\n                    ) : (\n                      <RenderField value={Ctx.context[prop]} />\n                    )}\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n          <PropertiesView />\n          <BehaviorsView context={Ctx.context} />\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { Select } from \"../input/select\";\nimport { Button } from \"../input/button\";\nimport { useCrudContext } from \"../../hooks/useCrudContext\";\nimport { useSetState } from \"react-use\";\nimport ErrorZone from \"../error_zone\";\n\nexport function PermissionRoleperm({\n  roles,\n  permissions,\n  operations,\n  refresh\n}) {\n  const { post, loading } = useCrudContext();\n  const [state, setState] = useSetState({\n    role: undefined,\n    permission: [],\n    setting: undefined,\n    error: undefined\n  });\n\n  const getMultiples = (field, setter) => ev => {\n    let values = [];\n    for (let i = 0; i < ev.target.selectedOptions.length; i++) {\n      values = values.concat([ev.target.selectedOptions[i].value]);\n    }\n    setter({ [field]: values });\n  };\n\n  const savePermission = async ev => {\n    if (!state.role || !state.setting || state.permission.length === 0) {\n      console.log(state);\n      setState({ error: \"Invalid form\" });\n      return\n    }\n    const data = {\n      roleperm: state.permission.map(perm => ({\n        role: state.role,\n        permission: perm,\n        setting: state.setting\n      }))\n    };\n    await post(data, \"@sharing\", false);\n    refresh(Math.random());\n  };\n\n  return (\n    <div className=\"container\">\n      {loading}\n      {state.error && <ErrorZone>Invalid form data</ErrorZone>}\n      <div className=\"field\">\n        <label className=\"label\">Select a Role</label>\n        <Select\n          appendDefault\n          options={roles}\n          onChange={ev => setState({ role: ev.target.value })}\n        />\n      </div>\n      <div className=\"field\">\n        <label className=\"label\">Select permissions</label>\n        <Select\n          options={permissions}\n          onChange={getMultiples(\"permission\", setState)}\n          size={5}\n          multiple\n        />\n      </div>\n      <div className=\"field\">\n        <label className=\"label\">Operation</label>\n        <Select\n          appendDefault\n          options={operations}\n          onChange={ev => setState({ setting: ev.target.value })}\n        />\n      </div>\n      <Button\n        className=\"is-primary is-small\"\n        loading={loading}\n        onClick={savePermission}\n      >\n        Save\n      </Button>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { Select } from \"../input/select\";\nimport { Button } from \"../input/button\";\nimport { useCrudContext } from \"../../hooks/useCrudContext\";\nimport { useSetState } from \"react-use\";\nimport ErrorZone from \"../error_zone\";\n\nexport function PermissionPrinperm({\n  groups,\n  permissions,\n  operations,\n  refresh\n}) {\n  const { post, loading } = useCrudContext();\n  const [state, setState] = useSetState({\n    principal: undefined,\n    permission: [],\n    setting: undefined,\n    error: undefined\n  });\n\n  const getMultiples = (field, setter) => ev => {\n    let values = [];\n    for (let i = 0; i < ev.target.selectedOptions.length; i++) {\n      values = values.concat([ev.target.selectedOptions[i].value]);\n    }\n    setter({ [field]: values });\n  };\n\n  const savePermission = async ev => {\n    if (!state.principal || !state.setting || state.permission.length === 0) {\n      setState({ error: \"Invalid form\" });\n      return\n    }\n    const data = {\n      prinperm: state.permission.map(perm => ({\n        principal: state.principal,\n        permission: perm,\n        setting: state.setting\n      }))\n    };\n    await post(data, \"@sharing\", false);\n    refresh(Math.random());\n  };\n\n  return (\n    <div className=\"container\">\n      {loading}\n      {state.error && <ErrorZone>Invalid form data</ErrorZone>}\n      <div className=\"field\">\n        <label className=\"label\">Select a Principal</label>\n        <Select\n          appendDefault\n          options={groups}\n          onChange={ev => setState({ principal: ev.target.value })}\n        />\n      </div>\n      <div className=\"field\">\n        <label className=\"label\">Select permissions</label>\n        <Select\n          options={permissions}\n          onChange={getMultiples(\"permission\", setState)}\n          size={5}\n          multiple\n        />\n      </div>\n      <div className=\"field\">\n        <label className=\"label\">Operation</label>\n        <Select\n          appendDefault\n          options={operations}\n          onChange={ev => setState({ setting: ev.target.value })}\n        />\n      </div>\n      <Button\n        className=\"is-primary is-small\"\n        loading={loading}\n        onClick={savePermission}\n      >\n        Save\n      </Button>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { Select } from \"../input/select\";\nimport { Button } from \"../input/button\";\nimport { useCrudContext } from \"../../hooks/useCrudContext\";\nimport { useSetState } from \"react-use\";\nimport ErrorZone from \"../error_zone\";\n\nexport function PermissionPrinrole({\n  groups,\n  roles,\n  operations,\n  refresh\n}) {\n  const { post, loading } = useCrudContext();\n  const [state, setState] = useSetState({\n    principal: undefined,\n    roles: [],\n    setting: undefined,\n    error: undefined\n  });\n\n  const getMultiples = (field, setter) => ev => {\n    let values = [];\n    for (let i = 0; i < ev.target.selectedOptions.length; i++) {\n      values = values.concat([ev.target.selectedOptions[i].value]);\n    }\n    setter({ [field]: values });\n  };\n\n  const savePermission = async ev => {\n    if (!state.principal || !state.setting || state.roles.length === 0) {\n      setState({ error: \"Invalid form\" });\n      return\n    }\n    const data = {\n      prinrole: state.roles.map(perm => ({\n        principal: state.principal,\n        role: perm,\n        setting: state.setting\n      }))\n    };\n    await post(data, \"@sharing\", false);\n    refresh(Math.random());\n  };\n\n  return (\n    <div className=\"container\">\n      {loading}\n      {state.error && <ErrorZone>Invalid form data</ErrorZone>}\n      <div className=\"field\">\n        <label className=\"label\">Select a Principal</label>\n        <Select\n          appendDefault\n          options={groups}\n          onChange={ev => setState({ principal: ev.target.value })}\n        />\n      </div>\n      <div className=\"field\">\n        <label className=\"label\">Select a Role</label>\n        <Select\n          options={roles}\n          onChange={getMultiples(\"roles\", setState)}\n          size={5}\n          multiple\n        />\n      </div>\n      <div className=\"field\">\n        <label className=\"label\">Operation</label>\n        <Select\n          appendDefault\n          options={operations}\n          onChange={ev => setState({ setting: ev.target.value })}\n        />\n      </div>\n      <Button\n        className=\"is-primary is-small\"\n        loading={loading}\n        onClick={savePermission}\n      >\n        Save\n      </Button>\n    </div>\n  );\n}\n","import React from \"react\";\n\nimport { Table } from \"../ui/table\";\nimport { useCrudContext } from \"../../hooks/useCrudContext\";\nimport { Sharing } from \"../../models\";\nimport { TraversalContext } from \"../../contexts\";\nimport { useSetState } from \"react-use\";\nimport { Select } from \"../input/select\";\nimport { PermissionRoleperm } from \"./permissions_roleperm\";\nimport { PermissionPrinperm } from \"./permissions_prinperm\";\nimport { PermissionPrinrole } from \"./permissions_prinrole\";\n\nexport function PanelPermissions(props) {\n  const { get, result, loading } = useCrudContext();\n\n  const [reset, setReset] = React.useState(1);\n\n  React.useEffect(() => {\n    (async () => {\n      await get(\"@sharing\");\n    })();\n  }, [reset]);\n\n  const perms = new Sharing(result);\n\n  return (\n    <div className=\"columns\">\n      {!loading && (\n        <div className=\"column is-8 is-size-7 permissions\">\n          <h2 className=\"title is-size-5 has-text-grey-dark\">\n            Role Permissions\n          </h2>\n          <Table headers={[\"Role\", \"Premission\", \"Setting\"]}>\n            {perms.roles.map((role, idx) => (\n              <React.Fragment key={'ff' + idx}>\n                <tr>\n                  <td colSpan=\"3\" className=\"has-text-link\">\n                    {role}\n                  </td>\n                  {/* <td>\n                    <Icon icon=\"fas fa-ban\" />\n                    <span>Remove</span>\n                  </td> */}\n                </tr>\n                {Object.keys(perms.getRole(role)).map((row, idx) => (\n                  <tr key={'k' + idx}>\n                    <td></td>\n                    <td>{row}</td>\n                    <td>{perms.getRole(role)[row]}</td>\n                  </tr>\n                ))}\n              </React.Fragment>\n            ))}\n            {perms.roles.length === 0 && (\n              <tr>\n                <td colSpan=\"3\">No roles permissions defined</td>\n              </tr>\n            )}\n          </Table>\n          <h2 className=\"title is-size-5 has-text-grey-dark\">\n            Principal Permissions\n          </h2>\n          <Table headers={[\"Principal\", \"Premission\", \"Setting\"]}>\n            {perms.principals.map((role, idx) => (\n              <React.Fragment key={'f2' + idx}>\n                <tr>\n                  <td colSpan=\"3\" className=\"has-text-link\">\n                    {role}\n                  </td>\n                </tr>\n                {Object.keys(perms.getPrincipals(role)).map((row, idx) => (\n                  <tr key={\"x\" + idx}>\n                    <td></td>\n                    <td>{row}</td>\n                    <td>{perms.getPrincipals(role)[row]}</td>\n                  </tr>\n                ))}\n              </React.Fragment>\n            ))}\n            {perms.principals.length === 0 && (\n              <tr>\n                <td colSpan=\"3\">No principals permissions defined</td>\n              </tr>\n            )}\n          </Table>\n          <h2 className=\"title is-size-5 has-text-grey-dark\">\n            Principal Roles\n          </h2>\n          <Table headers={[\"Principal\", \"Role\", \"Setting\"]}>\n            {perms.prinrole.map((role, idx) => (\n              <React.Fragment key={role + idx}>\n                <tr>\n                  <td colSpan=\"3\" className=\"has-text-link\">\n                    {role}\n                  </td>\n                </tr>\n                {Object.keys(perms.getPrinroles(role)).map((row, idx) => (\n                  <tr key={\"xx\" + idx}>\n                    <td></td>\n                    <td>{row}</td>\n                    <td>{perms.getPrinroles(role)[row]}</td>\n                  </tr>\n                ))}\n              </React.Fragment>\n            ))}\n            {perms.prinrole.length === 0 && (\n              <tr>\n                <td colSpan=\"3\">No principals roles defined</td>\n              </tr>\n            )}\n          </Table>\n        </div>\n      )}\n      <AddPermission refresh={setReset} reset={reset} />\n    </div>\n  );\n}\n\nconst initial = {\n  permissions: undefined,\n  groups: undefined,\n  roles: [],\n  current: \"\",\n  currentObj: undefined\n};\n\nconst operations = [\n  { text: \"Allow\", value: \"Allow\" },\n  { text: \"Deny\", value: \"Deny\" },\n  { text: \"AllowSingle\", value: \"AllowSingle\" },\n  { text: \"Unset\", value: \"Unset\" }\n];\n\nconst defaultOptions = [\n  { text: \"Choose..\", value: \"\" },\n  { text: \"Role Permissions\", value: \"roleperm\" },\n  { text: \"Principal Permissions\", value: \"prinperm\" },\n  { text: \"Principal Roles\", value: \"prinrole\" }\n];\n\nexport function AddPermission({ refresh, reset }) {\n  const Ctx = React.useContext(TraversalContext);\n  const [state, setState] = useSetState(initial);\n\n  React.useEffect(() => {\n    (async () => {\n      const permissions = (await Ctx.client.getAllPermissions(Ctx.path)).map(\n        perm => ({\n          text: perm,\n          value: perm\n        })\n      );\n      let req = await Ctx.client.getGroups(Ctx.path);\n      const groups = (await req.json()).map(group => ({\n        text: group.id,\n        value: group.id\n      }));\n      req = await Ctx.client.getRoles(Ctx.path);\n      const roles = (await req.json()).map(role => ({\n        text: role,\n        value: role\n      }));\n      setState({ permissions, groups, roles });\n    })();\n  }, [reset]);\n\n  return (\n    <div className=\"column is-4 is-size-7\">\n      <h1 className=\"title is-size-5\">Add Permissions</h1>\n      <p>Select a type:</p>\n      <Select\n        options={defaultOptions}\n        onChange={v => setState({ current: v.target.value })}\n      />\n      <hr />\n      {state.current && state.current === \"roleperm\" && (\n        <PermissionRoleperm\n          {...state}\n          operations={operations}\n          refresh={refresh}\n        />\n      )}\n      {state.current && state.current === \"prinperm\" && (\n        <PermissionPrinperm\n          {...state}\n          operations={operations}\n          refresh={refresh}\n        />\n      )}\n      {state.current && state.current === \"prinrole\" && (\n        <PermissionPrinrole\n          {...state}\n          operations={operations}\n          refresh={refresh}\n        />\n      )}\n    </div>\n  );\n}\n","import React from \"react\";\nimport { useSetState } from \"react-use\";\nimport { Select } from \"../input/select\";\nimport { Button } from \"../input/button\";\nimport { Input } from \"../input/input\";\nimport { useCrudContext } from \"../../hooks/useCrudContext\";\n\nimport AceEditor from \"react-ace\";\nimport brace from \"brace\";\nimport \"brace/mode/json\";\n\nconst initial = {\n  method: \"get\",\n  endpoint: \"\"\n};\n\nconst methods = [\n  { text: \"GET\", value: \"get\" },\n  { text: \"POST\", value: \"post\" },\n  { text: \"DELETE\", value: \"delete\" },\n  { text: \"PATCH\", value: \"patch\" }\n  // { text: \"PUT\", value: \"put\" }\n];\n\nexport function PanelRequester() {\n  const [state, setState] = useSetState(initial);\n  const { get, post, del, patch, loading, isError, result } = useCrudContext();\n  const ref = React.useRef();\n\n  React.useEffect(() => {\n    if (ref.current) {\n      ref.current = \"\";\n    }\n  }, []);\n\n  const doRequest = async (ev) => {\n\n    if (ev) {\n      ev.preventDefault()\n    }\n\n    const ace =\n      ref.current && ref.current !== \"\" ? JSON.parse(ref.current) : undefined;\n    const { method, endpoint } = state;\n    if (method === \"get\") {\n      await get(endpoint);\n    }\n    if (method === \"post\") {\n      await post(ace, endpoint);\n    }\n    if (method === \"del\") {\n      await del(endpoint, ace);\n    }\n    if (method === \"patch\") {\n      await patch(ace, endpoint);\n    }\n  };\n\n  const onUpdate = value => (ref.current = value);\n\n  return (\n    <div className=\"container\">\n      <h2 className=\"title is-size-5\">JSON Context Requester</h2>\n      <hr />\n      <form onSubmit={doRequest} className=\"form\">\n      <div className=\"columns is-size-7\">\n        <div className=\"column\">\n          <div className=\"field\">\n            <label className=\"label\">Method</label>\n            <Select\n              options={methods}\n              onChange={ev => setState({ method: ev.target.value })}\n              style={{ width: \"100%\" }}\n              classWrap=\"is-block\"\n            />\n          </div>\n        </div>\n        <div className=\"column is-4\">\n          <div className=\"field\">\n            <label className=\"label\">Endpoint</label>\n            <Input\n              placeholder=\"Default for context\"\n              type=\"text\"\n              onChange={value => setState({ endpoint: value })}\n              className=\"is-small\"\n            />\n\n          </div>\n        </div>\n        <div className=\"column\">\n          <div className=\"field\">\n            <label className=\"label\">&nbsp;</label>\n            <Button\n              className=\"is-primary is-small\"\n              loading={loading}\n              onClick={doRequest}\n            >\n              Send\n            </Button>\n          </div>\n        </div>\n        <div className=\"column is-6\"></div>\n      </div>\n      </form>\n      <div className=\"columns\">\n        <div className=\"column\">\n          <h2 className=\"title is-size-6\">Body</h2>\n          <AceEditor\n            mode=\"json\"\n            onChange={onUpdate}\n            value={ref.current}\n            name=\"EDITOR\"\n            width=\"100%\"\n            tabSize={2}\n            fontFamily=\"Menlo, Monaco\"\n            editorProps={{\n              $blockScrolling: Infinity,\n              enableBasicAutocompletion: false,\n              enableLiveAutocompletion: false,\n              enableSnippets: false,\n              showLineNumbers: true\n            }}\n          />\n        </div>\n        <div className=\"column\">\n          <h2 className=\"title is-size-6\">Response</h2>\n          {result && (\n            <AceEditor\n              mode=\"json\"\n              width=\"100%\"\n              name=\"VIEWER\"\n              tabSize={2}\n              fontFamily=\"Menlo, Consolas, Ubuntu Mono\"\n              value={JSON.stringify(result, null, 2)}\n              editorProps={{\n                $blockScrolling: Infinity,\n                enableBasicAutocompletion: false,\n                enableLiveAutocompletion: false,\n                enableSnippets: false,\n                showLineNumbers: true,\n                tabSize: 2\n              }}\n            />\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { Select } from \"../input/select\";\nimport { Tag } from \"../ui/tag\";\nimport { Loading } from \"../ui/loading\";\n\nconst prepareAvailable = (items, already, title) => {\n  const def = { value: \"\", text: `Add ${title}` };\n  if (items.length === 0) return [];\n  if (items[0] && typeof items[0] === \"string\") {\n    return [def]\n      .concat(items.map(x => ({ value: x, text: x })))\n      .filter(item => !already.includes(item.value));\n  }\n  return [def].concat(items).filter(item => !already.includes(item.value));\n};\n\nexport function TagsWidget({\n  items,\n  available,\n  title,\n  noData,\n  onChange,\n  loading\n}) {\n  const [result, setResult] = React.useState(items);\n  available = prepareAvailable(available || [], result, title);\n\n  const remove = value => {\n    const items = result.filter(item => item !== value);\n    setResult(items);\n    onChange(items);\n  };\n\n  const addItem = value => {\n    if (value === \"\") return;\n    const items = result.concat([value]);\n    setResult(items);\n    onChange(items);\n  };\n\n  return (\n    <React.Fragment>\n      <h3 className=\"title is-size-6\">{title}</h3>\n      {loading ? <Loading style={{ marginBottom: \"1.5rem\" }} /> : <hr />}\n      <ul>\n        <div className=\"tags\">\n          {result.map(item => (\n            <Tag name={item} onRemove={() => remove(item)} key={item} />\n          ))}\n        </div>\n        {result.length === 0 && (\n          <li style={{ marginBottom: \"20px\" }}>{noData}</li>\n        )}\n        {available.length > 1 && (\n          <li className=\"widget-list-add select is-small\">\n            <Select\n              options={available}\n              resetOnChange\n              onChange={ev => addItem(ev.target.value)}\n            />\n          </li>\n        )}\n      </ul>\n    </React.Fragment>\n  );\n}\n","import React from \"react\";\nimport { useEffect } from \"react\";\nimport { useSetState } from \"react-use\";\nimport { useContext } from \"react\";\nimport { TraversalContext } from \"../contexts\";\nimport { useConfig } from \"../hooks/useConfig\";\nimport { Icon } from \"./ui/icon\";\nimport { useLocation } from \"../hooks/useLocation\";\nimport Dropdown from \"./input/dropdown\";\nimport { Button } from \"./input/button\";\n\n/* eslint jsx-a11y/anchor-is-valid: \"off\" */\nconst initialState = { types: undefined };\n\nexport function CreateButton(props) {\n  const [state, setState] = useSetState(initialState);\n  const Ctx = useContext(TraversalContext);\n  const Config = useConfig();\n  useEffect(() => {\n    (async function anyNameFunction() {\n      const types = await Ctx.client.getTypes(Ctx.path);\n      setState({\n        types: types.filter(item => !Config.DisabledTypes.includes(item))\n      });\n    })();\n  }, [Ctx.path]);\n\n  const doAction = item => {\n    Ctx.doAction(\"addItem\", { type: item });\n    setState({ isActive: false });\n  };\n\n  if (state.types && state.types.length === 1) {\n    return (\n      <Button\n        className={'is-small is-success'}\n        onClick={ev => doAction(state.types[0]) }\n        >Add {state.types[0]}</Button>\n    )\n  }\n\n  if (state.types && state.types.length === 0) {\n    return null\n  }\n\n  // Implement some kind of filtering\n  return (\n    <Dropdown\n      id=\"dropdown-menu\"\n      isRight\n      onChange={doAction}\n      options={(state.types ||[]).map(item => ({ text: item, value: item }))}\n     >\n      <span className=\"icon\">\n        <i className=\"fas fa-plus\"></i>\n      </span>\n    </Dropdown>\n  )\n}\n\nexport function ContextToolbar({AddButton, ...props}) {\n  const [location, setLocation] = useLocation();\n  const ctx = React.useContext(TraversalContext);\n  const ref = React.useRef(null);\n\n  const searchText = location.get(\"q\");\n\n  const onSearch = ev => {\n    const search = ev.target[0].value;\n    setLocation({ q: search, tab: \"Items\", page:0 });\n    // let searchParsed = parser(search);\n    // ctx.setState({ search, searchParsed });\n    ev.preventDefault();\n  };\n\n  const setFocus = ev => {\n    ref.current.focus();\n    ev.preventDefault();\n  };\n\n  // useKey(\"/\", setFocus)\n\n  // cleanup form on state.search change\n  React.useEffect(() => {\n    if (!searchText || searchText === \"\") {\n      ref.current.value = \"\";\n    }\n  }, [searchText]);\n\n  return (\n    <React.Fragment>\n      <div className=\"level-item\">\n        <form action=\"\" className=\"form\" onSubmit={onSearch}>\n          <div className=\"field has-addons\">\n            <div className=\"control\">\n              <input\n                ref={ref}\n                type=\"text\"\n                className=\"input is-size-7\"\n                placeholder=\"Search...\"\n              />\n            </div>\n            <div className=\"control\">\n              <button\n                className=\"button has-background-grey-lighter is-size-7\"\n                type=\"submit\"\n              >\n                <Icon icon=\"fas fa-search\" />\n              </button>\n            </div>\n          </div>\n        </form>\n      </div>\n      {ctx.hasPerm(\"guillotina.AddContent\") && (\n        <div className=\"level-item\">\n          {AddButton!==undefined ? <AddButton /> : <CreateButton {...props} />}\n        </div>\n      )}\n    </React.Fragment>\n  );\n}\n","import React from 'react'\nimport {TraversalContext} from '../contexts'\nimport {Notification} from './ui/notification'\nimport {Delete} from './ui/delete'\n\n\nexport function Flash() {\n  const Ctx = React.useContext(TraversalContext)\n  const {flash} = Ctx.state\n\n  if (!flash.message) return null\n\n  return (\n    <Notification isColor={flash.type}>\n        {flash.message}\n        <Delete onClick={() => Ctx.clearFlash()} />\n    </Notification>\n  )\n\n}\n","import React from 'react';\nimport {TraversalContext} from '../contexts'\nimport {useContext} from 'react'\nimport {useLocation} from '../hooks/useLocation'\n\n/* eslint jsx-a11y/anchor-is-valid: \"off\" */\n\nexport function Path(props) {\n\n  const ctx = useContext(TraversalContext)\n  const [, navigate] = useLocation()\n\n  let segments = ctx.path.replace(/\\/$/, \"\").split(\"/\")\n  let links = buildPaths(segments)\n\n  if (segments.length === 1) {\n    return false\n  }\n  //ctx.setPath(links[indx])\n  return (\n    <nav className=\"breadcrumb\" aria-label=\"breadcrumbs\">\n      <ul>\n      {segments.map((item, indx) =>\n        ((indx === 0) ?\n          <li key={indx}>\n            <a onClick={() => navigate({path:links[indx]}, true)}>\n              <span className=\"icon\">\n                <i className=\"fas fa-home\"></i>\n              </span>\n            </a>\n          </li>\n          :\n          <li key={indx}><a onClick={() => navigate({path:links[indx]}, true)}>\n          {item}</a></li>\n      ))}\n      </ul>\n    </nav>\n  )\n\n}\n\nconst buildPaths = (segments) => {\n  let current = \"\"\n  let results = []\n  segments.map((item, indx) => {\n    if (indx === 0) {\n      current += \"/\"\n    } else {\n      current += item + \"/\"\n    }\n    results.push(current)\n    return item\n  })\n  return results\n}\n","import React from 'react'\nimport {Icon} from './ui/icon'\n\n\nexport function NotAllowed() {\n  return (\n    <div className=\"box not-allowed\">\n      <h1 className=\"title has-text-danger\"\n        style={{fontSize: '4rem'}}><Icon icon=\"fas fa-ban\"/></h1>\n      <h1 className=\"title has-text-grey-darker\">Not Allowed</h1>\n\n    </div>\n  )\n}\n","import React from 'react'\nimport {Icon} from './ui/icon'\n\n\nexport function NotFound() {\n  return (\n    <div className=\"box not-allowed\">\n      <h1 className=\"title has-text-grey\"\n        style={{fontSize: '4rem'}}><Icon icon=\"fas fa-dizzy\"/></h1>\n      <h1 className=\"title has-text-grey-darker\">404. Not Found</h1>\n\n    </div>\n  )\n}\n","import React from \"react\";\nimport { useState } from \"react\";\nimport { TraversalContext } from \"../contexts\";\nimport { useLocation } from \"../hooks/useLocation\";\n\nexport function TabsPanel({ tabs, currentTab, rightToolbar, ...props }) {\n\n  const [location, setLocation] = useLocation();\n\n  const defaultTab = currentTab\n\n  if (location.get(\"tab\")) {\n    currentTab = location.get(\"tab\");\n  } else {\n    currentTab = currentTab || Object.keys(tabs)[0];\n  }\n\n  /*if (!Object.keys(tabs).includes(currentTab)) {\n    setLocation(defaultTab)\n    currentTab = defaultTab\n  }*/\n\n  const [current, setTab] = useState(currentTab);\n  const CurrentComp = tabs[current];\n\n  React.useEffect(() => {\n    if (Object.keys(tabs).includes(currentTab)) {\n      setTab(currentTab);\n      // setLocation({tab: currentTab})\n    }\n  }, [currentTab, tabs]);\n\n  const changeTab = tab => {\n    setLocation({ tab: tab });\n  };\n\n  return (\n    <div className=\"container\">\n      <div className=\"level\">\n        <div className=\"level-left\">\n          <div className=\"tabs\">\n            <ul>\n              {Object.keys(tabs).map(tab => (\n                <li\n                  className={\n                    \"is-size-7 \" + (tab === current ? \"is-active\" : \"\")\n                  }\n                  key={tab}\n                >\n                  <a onClick={() => changeTab(tab)}>{tab}</a>\n                </li>\n              ))}\n            </ul>\n          </div>\n        </div>\n        {rightToolbar && <div className=\"level-right\">{rightToolbar}</div>}\n      </div>\n      <div className=\"container\">\n        <CurrentComp title={current} {...props} />\n      </div>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { TabsPanel } from \"../components/tabs\";\nimport { ContextToolbar } from \"../components/context_toolbar\";\nimport { PanelItems } from \"../components/panel/items\";\nimport { TraversalContext } from \"../contexts\";\nimport { PanelProperties } from \"../components/panel/properties\";\nimport { PanelPermissions} from \"../components/panel/permissions\"\nimport { PanelBehaviors } from \"../components/panel/behaviors\";\nimport { PanelRequester } from \"../components/panel/requester\";\n\n\nconst tabs = {\n  Items: PanelItems,\n  Properties: PanelProperties,\n  Behaviors: PanelBehaviors,\n  Permissions: PanelPermissions,\n  Requester: PanelRequester,\n};\n\nconst tabsPermissions = {\n  Items: \"guillotina.ViewContent\",\n  Properties: \"guillotina.ViewContent\",\n  Behaviors: \"guillotina.ModifyContent\",\n  Permissions: \"guillotina.SeePermissions\",\n  Requester: \"guillotina.swagger.View\"\n};\n\nexport function FolderCtx(props) {\n  const ctx = React.useContext(TraversalContext);\n  const calculated = ctx.filterTabs(tabs, tabsPermissions);\n\n  return (\n    <TabsPanel\n      tabs={calculated}\n      currentTab=\"Items\"\n      rightToolbar={<ContextToolbar {...props} />}\n      {...props}\n    />\n  );\n}\n","import React from \"react\";\nimport { TabsPanel } from \"../components/tabs\";\nimport { TraversalContext } from \"../contexts\";\nimport { PanelPermissions} from \"../components/panel/permissions\"\nimport { PanelBehaviors } from \"../components/panel/behaviors\";\nimport { PanelProperties } from \"../components/panel/properties\";\n\n\nconst tabs = {\n  Properties: PanelProperties,\n  Behaviors: PanelBehaviors,\n  Permissions: PanelPermissions\n};\n\nconst tabsPermissions = {\n  Properties: \"guillotina.ViewContent\",\n  Behaviors: \"guillotina.ModifyContent\",\n  Permissions: \"guillotina.SeePermissions\"\n};\n\n\n\nexport function ItemCtx(props) {\n  const ctx = React.useContext(TraversalContext);\n  const calculated = ctx.filterTabs(tabs, tabsPermissions);\n\n  return <TabsPanel tabs={calculated} currentTab=\"Properties\" {...props} />;\n}\n","import React from \"react\";\n\nimport { Item } from \"../components/item\";\nimport { ItemTitle } from \"../components/item\";\nimport { Button } from \"../components/input/button\";\nimport { useState } from \"react\";\nimport { useContext } from \"react\";\nimport { useRef } from 'react'\nimport { TraversalContext } from \"../contexts\";\nimport { Modal } from \"../components/modal\";\nimport { Form } from \"../components/input/form\";\nimport { Input } from \"../components/input/input\";\n\nexport function ApplicationCtx(props) {\n  const { databases } = props.state.context;\n  return (\n    <React.Fragment>\n      <h3>Databases</h3>\n      <div className=\"container\">\n        <ItemTitle title=\"Objects\" />\n        {databases.map(db => (\n          <Item\n            item={{ id: db, path: `/${db}/` }}\n            key={db}\n            icon={\"fas fa-database\"}\n          />\n        ))}\n      </div>\n    </React.Fragment>\n  );\n}\n\nexport function DatabaseCtx({ state, client, ...props }) {\n  const Ctx = useContext(TraversalContext);\n  const { containers } = state.context;\n  const { path } = state;\n  return (\n    <React.Fragment>\n      <div className=\"container\">\n        <ItemTitle title=\"Containers\" actions={<CreateContainer />} />\n        <table className=\"table is-fullwidth is-hoverable\">\n          <tbody>\n            {containers.map(db => (\n              <Item\n                item={{ id: db, path: `${path}${db}/` }}\n                key={db}\n                icon={\"fas fa-archive\"}\n                setPath={Ctx.setPath}\n              />\n            ))}\n          </tbody>\n        </table>\n      </div>\n    </React.Fragment>\n  );\n}\n\nexport function CreateContainer(props) {\n  const [isActive, setActive] = useState(false);\n\n  return (\n    <React.Fragment>\n      <ModalAddContainer isActive={isActive} setActive={setActive} {...props} />\n      <button\n        className=\"button is-warning is-pulled-right\"\n        onClick={() => setActive(true)}\n      >\n        <span className=\"icon is-small\">\n          <i className=\"fas fa-plus\"></i>\n        </span>\n        <span>Create</span>\n      </button>\n    </React.Fragment>\n  );\n}\n\nfunction ModalAddContainer({ isActive, setActive }) {\n  const Ctx = useContext(TraversalContext);\n  const [isLoading, setLoading] = useState(false);\n  const [idField, setId] = useState(\"\");\n  const [error, setError] = useState(undefined);\n  const traversal = useContext(TraversalContext);\n\n  async function createContainer(ev) {\n    setLoading(true);\n    const data = {\n      \"@type\": \"Container\",\n      id: idField\n    };\n    try {\n      const res = await Ctx.client.createObject(Ctx.path, data);\n      const result = await res.json();\n      if (res.status === 200) {\n        Ctx.refresh();\n        setId(\"\");\n        setLoading(false);\n        setActive(false);\n        traversal.flash(\"Container created\", \"primary\");\n      } else {\n        setId(\"\");\n        setLoading(false);\n        setError(result.message);\n      }\n    } catch {\n      setError(\"Error-submitting-form\");\n      setLoading(false);\n    }\n  }\n\n  return (\n    <Modal isActive={isActive} setActive={setActive}>\n      <Form onSubmit={createContainer} title=\"Add Container\" error={error}>\n        <Input\n          required\n          placeholder=\"Container Name\"\n          onChange={v => {\n            setId(v)\n          }}\n          value={idField}\n          loading={isLoading}\n        />\n        <Button loading={isLoading}>Add Container</Button>\n      </Form>\n    </Modal>\n  );\n}\n","import React from \"react\";\nimport { TabsPanel } from \"../components/tabs\";\nimport { ContextToolbar } from \"../components/context_toolbar\";\nimport { PanelItems } from \"../components/panel/items\";\nimport { PanelAddons } from \"../components/panel/addons\";\nimport { TraversalContext } from \"../contexts\";\nimport { PanelNotImplemented } from \"./base\";\nimport { PanelPermissions } from \"../components/panel/permissions\";\nimport { PanelBehaviors } from \"../components/panel/behaviors\";\nimport { PanelRequester } from \"../components/panel/requester\";\n\nconst tabs = {\n  Items: PanelItems,\n  Addons: PanelAddons,\n  Registry: PanelNotImplemented,\n  Behaviors: PanelBehaviors,\n  Permissions: PanelPermissions,\n  Requester: PanelRequester\n};\n\nconst tabsPermissions = {\n  Items: \"guillotina.ViewContent\",\n  Addons: \"guillotina.ManageAddons\",\n  Registry: \"guillotina.ReadConfiguration\",\n  Behaviors: \"guillotina.ModifyContent\",\n  Permissions: \"guillotina.SeePermissions\",\n  Requester: \"guillotina.swagger.View\"\n};\n\nexport function ContainerCtx(props) {\n  const ctx = React.useContext(TraversalContext);\n  const calculated = ctx.filterTabs(tabs, tabsPermissions);\n  return (\n    <TabsPanel\n      tabs={calculated}\n      currentTab=\"Items\"\n      rightToolbar={<ContextToolbar {...props} />}\n      {...props}\n    />\n  );\n}\n","import React from \"react\";\n\nexport function PanelNotImplemented(props) {\n  return (\n    <div className=\"container\">\n      <h2 className=\"title\">{props.title}</h2>\n      <p>Not implemented</p>\n    </div>\n  );\n}\n","import React from 'react'\nimport {FormBuilder} from '../components/input/form_builder'\n\nconst schema = {\n  \"type\": \"object\",\n  \"required\": [\n    \"username\",\n    \"password\",\n  ],\n  \"properties\": {\n    \"username\": {\n      \"type\": \"string\",\n      \"title\": \"Username\"\n    },\n    \"email\": {\n      \"type\": \"string\",\n      \"title\": \"Email\",\n      \"widget\": \"email\"\n    },\n    \"name\": {\n      \"type\": \"string\",\n      \"title\": \"Name\"\n    },\n    \"password\": {\n      \"type\": \"string\",\n      \"title\": \"Password\",\n      \"widget\": \"password\"\n    },\n    \"disabled\": {\n      \"type\": \"boolean\",\n      \"title\": \"Disabled\"\n    }\n  }\n}\n\nexport const UserForm = ({isEdit=false, children, ...props}) => {\n\n  const attr = (isEdit) ? {} : {\"title\": \"Add User\"}\n\n  return (\n      <FormBuilder\n          schema={schema}\n          {...props}\n          {...attr}\n          >\n        {children}\n      </FormBuilder>\n  )\n}\n\n","import React from \"react\";\n\n/*\n  This hook allows to bind (remote) fields on the DOM\n  to a form generated with Formbuilder.\n  You can link whatever field you want...\n\n  const [remoteFields, updateRemoteField] = useRemoteField({widget_1: ['a', 'b']})\n\n  <Form remotes={remoteFields} onSubmit={ev => console.log(ev)}>\n    <Input />\n  </Form>\n\n  <Widget onChange={updateRemoteField('widgte_1')}>\n\n  This will add the values from a remote field into the desired widget\n\n*/\n\nexport const useRemoteField = initial => {\n  const [remotes, setRemote] = React.useState(initial);\n\n  const updateRemote = name => value => {\n    setRemote({\n      ...remotes,\n      [name]: value\n    });\n  };\n\n  return [remotes, updateRemote];\n};\n","import React from \"react\";\nimport { TabsPanel } from \"../components/tabs\";\nimport { PanelItems } from \"../components/panel/items\";\nimport { TraversalContext } from \"../contexts\";\nimport { UserForm } from \"../forms/users\";\nimport { formatDate } from \"../lib/utils\";\nimport { useCrudContext } from \"../hooks/useCrudContext\";\nimport { TagsWidget } from \"../components/widgets/tags\";\nimport { Icon } from \"../components/ui/icon\";\nimport { Button } from \"../components/input/button\";\nimport { useRemoteField } from \"../hooks/useRemoteField\";\n\nconst tabs = {\n  Users: PanelItems\n};\n\nexport function UsersToolbar(props) {\n  const Ctx = React.useContext(TraversalContext);\n\n  return (\n    <button\n      className=\"button is-primary\"\n      onClick={() => Ctx.doAction(\"addItem\", { type: \"User\" })}\n      aria-haspopup=\"true\"\n      aria-controls=\"dropdown-menu\"\n    >\n      <Icon icon=\"fas fa-user\" />\n      <span>Add a User</span>\n    </button>\n  );\n}\n\nexport function UsersCtx(props) {\n  return (\n    <TabsPanel\n      tabs={tabs}\n      currentTab=\"Users\"\n      rightToolbar={<UsersToolbar />}\n      {...props}\n    />\n  );\n}\n\nexport function UserCtx(props) {\n  const { Ctx, patch, loading, isError, errorMessage } = useCrudContext();\n\n  const [state, setState] = React.useState({ roles: [], gorups: [] });\n\n  const fields = {\n    user_groups: [],\n    user_roles: Ctx.context.user_roles\n  };\n\n  const [remotes, updateRemote] = useRemoteField(fields);\n\n  React.useEffect(() => {\n    (async () => {\n      const res = await Promise.all([\n        Ctx.client.search(Ctx.path, { type_name: \"Group\" }, true),\n        Ctx.client.getRoles(Ctx.path)\n      ]);\n      const groups = await res[0];\n      const roles = await res[1].json();\n      setState({\n        roles: roles,\n        groups: groups.member.map(item => ({\n          value: item.id,\n          text: item[\"@name\"]\n        }))\n      });\n    })();\n  }, []);\n\n  const updateObject = async data => {\n    Ctx.apply(data);\n    const {isError, errorMessage} = await patch(data);\n    if (isError) {\n      Ctx.flash(`Update failed ${errorMessage}`, \"danger\");\n    } else {\n      Ctx.flash(\"Data updated\", \"primary\");\n    }\n    Ctx.refresh();\n  };\n\n  return (\n    <div className=\"container\">\n      <h2 className=\"title is-size-4\">\n        <Icon icon=\"fas fa-user\"></Icon>\n        &nbsp;User\n      </h2>\n\n      <hr />\n      <div className=\"columns\">\n        <div className=\"column\">\n          <div className=\"container user-props\">\n            <p>\n              <label>Username: </label> {Ctx.context.username} (\n              {Ctx.context.email})\n            </p>\n            <p>\n              <label> Created: </label> {formatDate(Ctx.context.creation_date)}\n            </p>\n            <p>\n              <label> Updated: </label>{\" \"}\n              {formatDate(Ctx.context.modification_date)}\n            </p>\n          </div>\n          <hr />\n          <UserForm\n            actionName=\"Save\"\n            onSubmit={ev => updateObject(ev)}\n            isEdit={true}\n            formData={Ctx.context}\n            exclude={[\"password\"]}\n            remotes={remotes}\n            submitButton={false}\n          >\n            <Button loading={loading}>Update</Button>\n          </UserForm>\n        </div>\n        <div className=\"column\">\n          <TagsWidget\n            onChange={updateRemote(\"user_groups\")}\n            items={Ctx.context.user_groups}\n            title=\"Groups\"\n            noData=\"There is no groups for this user\"\n            available={state.groups}\n          />\n          <hr />\n          <TagsWidget\n            onChange={updateRemote(\"user_roles\")}\n            items={remotes.user_roles}\n            title=\"Roles\"\n            noData=\"The user doesn't have any role\"\n            available={state.roles}\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React from 'react'\nimport {PathTree} from '../components/modal'\nimport {useContext} from 'react'\nimport {TraversalContext} from '../contexts'\n\nconst withError = res => res.status >= 300\n\nexport function CopyItems(props) {\n  const Ctx = useContext(TraversalContext)\n  const { items = [] } = props\n\n  async function copyItems(path) {   \n    const responses = await Promise.all(items.map(item => {\n      return Ctx.client.post(`${Ctx.path}${item['@name']}/@duplicate`, {\n        destination: path,\n        new_id: item['@name']\n      });\n    }))\n\n    Ctx.refresh()\n    Ctx.cancelAction()\n\n    if(responses.every(withError)) {\n      Ctx.flash(`Oops! Items can't be copied to ${path}`, 'danger')\n      return\n    }\n\n    if(responses.some(withError)) {\n      Ctx.flash(`Some items are not copied correctly!`, 'warning')\n      return\n    }\n\n    Ctx.flash(`Items copied!`, 'success')\n  }\n\n  return (\n    <PathTree\n      title=\"Copy to...\"\n      onConfirm={copyItems}\n      onCancel={() => Ctx.cancelAction()}\n    />\n  )\n}\n","import React from 'react'\nimport {PathTree} from '../components/modal'\nimport {useContext} from 'react'\nimport {TraversalContext} from '../contexts'\n\nconst withError = res => res.status >= 300\n\nexport function MoveItems(props) {\n  const Ctx = useContext(TraversalContext)\n  const { items = [] } = props\n\n  async function moveItems(path) {  \n    const responses = await Promise.all(items.map(item => {\n      return Ctx.client.post(`${Ctx.path}${item['@name']}/@move`, {\n        destination: path,\n        new_id: item['@name']\n      });\n    }))\n\n    Ctx.refresh()\n    Ctx.cancelAction()\n\n    if(responses.every(withError)) {\n      Ctx.flash(`Oops! Items can't be moved to ${path}`, 'danger')\n      return\n    }\n\n    if(responses.some(withError)) {\n      Ctx.flash(`Some items are not moved correctly!`, 'warning')\n      return\n    }\n\n    Ctx.flash(`Items moved!`, 'success')\n  }\n\n  return (\n    <PathTree\n      title=\"Move to...\"\n      onConfirm={moveItems}\n      onCancel={() => Ctx.cancelAction()}\n    />\n  )\n}\n","import React from \"react\";\nimport { useState } from \"react\";\nimport { Input } from \"../components/input/input\";\nimport { Form } from \"../components/input/form\";\nimport { stringToSlug } from \"../lib/helpers\";\n\nexport function BaseForm({ onSubmit, actionName, title }) {\n  const [name, setName] = useState(\"\");\n  const [id, setId] = useState(\"\");\n  const [error, setError] = useState(undefined);\n\n  const submit = values => {\n    if (name === \"\") {\n      setError(\"This field is required\");\n      return;\n    }\n    onSubmit({ title: name, id });\n  };\n\n  const setTitle = value => {\n    setId(stringToSlug(value));\n    setName(value);\n  };\n\n  return (\n    <Form title={title} onSubmit={submit}>\n      <Input\n        id=\"title\"\n        placeholder=\"Title\"\n        required\n        value={name}\n        onChange={setTitle}\n        autofocus\n        error={error}\n      />\n\n      <Input id=\"id\" placeholder=\"Id\" value={id} onChange={setId} />\n\n      <div className=\"level level-right\">\n        <button type=\"submit\" className=\"button is-success\">\n          {actionName || \"Add\"}\n        </button>\n      </div>\n    </Form>\n  );\n}\n","import React from \"react\";\nimport { TabsPanel } from \"../components/tabs\";\nimport { PanelItems } from \"../components/panel/items\";\nimport { TraversalContext } from \"../contexts\";\nimport { useCrudContext } from \"../hooks/useCrudContext\";\nimport { Icon } from \"../components/ui/icon\";\nimport { useEffect } from \"react\";\nimport { useState } from \"react\";\nimport { Select } from \"../components/input/select\";\nimport { Tag } from \"../components/ui/tag\";\nimport { EditableField } from \"../components/fields/editableField\";\n\nconst tabs = {\n  Groups: PanelItems\n};\n\nexport function GroupToolbar(props) {\n  const Ctx = React.useContext(TraversalContext);\n\n  return (\n    <button\n      className=\"button is-primary\"\n      onClick={() => Ctx.doAction(\"addItem\", { type: \"Group\" })}\n      aria-haspopup=\"true\"\n      aria-controls=\"dropdown-menu\"\n    >\n      <Icon icon=\"fas fa-users\" />\n      <span>Add a Group</span>\n    </button>\n  );\n}\n\nexport function GroupsCtx(props) {\n  return (\n    <TabsPanel\n      tabs={tabs}\n      currentTab=\"Groups\"\n      rightToolbar={<GroupToolbar />}\n      {...props}\n    />\n  );\n}\n\nexport function GroupCtx(props) {\n  const { Ctx, patch } = useCrudContext();\n  const [roles, setRoles] = useState([]);\n  const [users, setUsers] = useState([]);\n\n  useEffect(() => {\n    (async () => {\n      const getUsers = Ctx.client.getUsers(Ctx.path);\n      const getRoles = Ctx.client.getRoles(Ctx.path);\n      const [req, req2] = await Promise.all([getUsers, getRoles]);\n      setRoles(\n        (await req2.json()).map(role => ({\n          text: role,\n          value: role\n        }))\n      );\n      setUsers(\n        (await req.json()).map(user => ({\n          text: user[\"@name\"],\n          value: user.id\n        }))\n      );\n    })();\n  }, []);\n\n  const addRole = async ev => {\n    const role = ev.target.value;\n    await patch({ user_roles: Ctx.context.user_roles.concat(role) });\n    Ctx.flash(`Role ${role} added to group`, \"success\");\n    Ctx.refresh();\n  };\n\n  const removeRole = async role => {\n    await patch({ user_roles: Ctx.context.user_roles.filter(r => r !== role) });\n    Ctx.flash(`Role ${role} removed from group`, \"success\");\n    Ctx.refresh();\n  };\n\n  const addUser = async ev => {\n    const user = ev.target.value;\n    await patch({ users: Ctx.context.users.concat(user) });\n    Ctx.flash(`User ${user} added to group!`, \"success\");\n    Ctx.refresh();\n  };\n\n  const removeUser = async user => {\n    await patch({ users: Ctx.context.users.filter(r => r !== user) });\n    Ctx.flash(`User ${user} removed from group`, \"success\");\n    Ctx.refresh();\n  };\n\n  return (\n    <div className=\"container group-view\">\n      <h2 className=\"title is-size-4\">\n        <Icon icon=\"fas fa-users\"></Icon>\n        <span>&nbsp;Group</span>\n      </h2>\n      <hr />\n      <div className=\"columns\">\n        <div className=\"column is-4\">\n          <label className=\"label\">Title: </label>\n          <EditableField field=\"title\" value={Ctx.context.title} />\n        </div>\n        <div className=\"column is-4 is-size-7\">\n          <h3 className=\"title is-size-6\">Roles</h3>\n          <p>Add a Role</p>\n          <Select\n            options={roles.filter(\n              role => !Ctx.context.user_roles.includes(role.value)\n            )}\n            appendDefault\n            resetOnChange\n            onChange={addRole}\n          />\n          <hr />\n          {Ctx.context.user_roles.map(urole => (\n            <p className=\"control\">\n              <Tag\n                name={urole}\n                onRemove={ev => removeRole(urole)}\n                size=\"is-small\"\n              />\n            </p>\n          ))}\n        </div>\n        <div className=\"column is-4 is-size-7\">\n          <h3 className=\"title is-size-6\">Users</h3>\n          <p>Add a User</p>\n          <Select\n            options={users.filter(\n              user => !Ctx.context.users.includes(user.value)\n            )}\n            appendDefault\n            onChange={addUser}\n          />\n          <hr />\n          {Ctx.context.users.map(user => (\n            <p className=\"control\">\n              <Tag\n                name={user}\n                onRemove={ev => removeUser(user)}\n                size=\"is-small\"\n              />\n            </p>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { FolderCtx } from \"../views/folder\";\nimport { ItemCtx } from \"../views/item\";\nimport { ApplicationCtx } from \"../views/application\";\nimport { DatabaseCtx } from \"../views/application\";\nimport { ContainerCtx } from \"../views/container\";\nimport { UsersCtx } from \"../views/users\";\nimport { UserCtx } from \"../views/users\";\nimport { CopyItems } from \"../actions/copy_items\";\nimport { MoveItems } from \"../actions/move_items\";\nimport { RemoveItems } from \"../actions/remove_items\";\nimport { AddItem } from \"../actions/add_item\";\nimport { BaseForm } from \"../forms/base\";\nimport { UserForm } from \"../forms/users\";\nimport { IAttachment } from \"../components/behaviors/iattachment\";\nimport { IDublinCore } from \"../components/behaviors/idublincore\";\nimport { IMultiAttachment } from \"../components/behaviors/imultiattachment\";\nimport { GroupsCtx } from \"../views/groups\";\nimport { GroupCtx } from \"../views/groups\"\nimport React from 'react'\n\nlet registry = {\n  paths: {},\n  views: {\n    Application: ApplicationCtx,\n    Database: DatabaseCtx,\n    Container: ContainerCtx,\n    UserManager: UsersCtx,\n    User: UserCtx,\n    Group: GroupCtx,\n    GroupManager: GroupsCtx,\n    Folder: FolderCtx,\n    Item: ItemCtx\n  },\n  actions: {\n    addItem: AddItem,\n    copyItems: CopyItems,\n    moveItems: MoveItems,\n    removeItems: RemoveItems,\n  },\n  forms: {\n    UserManager: BaseForm,\n    GroupManager: BaseForm,\n    Folder: BaseForm,\n    Item: BaseForm,\n    User: UserForm,\n    Group: BaseForm,\n  },\n  behaviors: {\n    \"guillotina.behaviors.dublincore.IDublinCore\": IDublinCore,\n    \"guillotina.behaviors.attachment.IAttachment\": IAttachment,\n    \"guillotina.behaviors.attachment.IMultiAttachment\": IMultiAttachment,\n  },\n  schemas: {},\n  properties: {}\n};\n\nconst get = (key, param, fallback) => {\n  if (registry[key]) return registry[key][param] || fallback;\n  return fallback;\n};\n\nconst getComponent = (context, path, fallback) => {\n  if (!context) return;\n  // console.log(\"Component for path\", path)\n  // lookup by path\n  if (registry.paths[path]) {\n    return registry.paths[path];\n  }\n  // by type\n  if (registry.views[context[\"@type\"]]) {\n    return registry.views[context[\"@type\"]];\n  }\n  if (fallback) {\n    return fallback;\n  }\n  return defaultComponent(context);\n};\n\nconst getForm = (type, fallback=BaseForm) => {\n  return registry.forms[type] || fallback;\n};\n\nconst getAction = (type, fallback) => {\n  return registry.actions[type] || fallback;\n};\n\nconst getBehavior = (type, fallback) => {\n  return registry.behaviors[type] || fallback;\n};\n\nconst getProperties = (type) => {\n  return registry.properties[type] || {}\n}\n\nexport const defaultComponent = context => {\n  return context.is_folderish ? FolderCtx : ItemCtx;\n};\n\nexport function useRegistry(data) {\n  // if data is provided we need to merge it into actual registry\n  const ref = React.useRef()\n  if (data && !ref.current) {\n    console.log(\"registry initialized\")\n    ref.current = true\n    Object.keys(data).map(\n      key => (registry[key] = { ...registry[key], ...data[key] })\n    );\n  }\n\n  return {\n    registry,\n    get,\n    getForm,\n    getComponent,\n    getAction,\n    getBehavior,\n    getProperties\n  };\n}\n\n/*\n\nconst registry = {\n  paths: {\n    \"/db/guillotina/tags/\": TagsContext\n  },\n  forms: {\n    Tag: AddTagForm\n  }\n}\n\n\n<guillotina registry={registry} />\n\n\n*/\n","import React from \"react\";\nimport { useContext } from \"react\";\nimport { TraversalContext } from \"../contexts\";\nimport { Modal } from \"../components/modal\";\n\nexport function AddItem(props) {\n\n  const Ctx = useContext(TraversalContext);\n  const { type } = props;\n  const { getForm } = Ctx.registry;\n\n  const Form = getForm(type);\n\n  const setActive = () => {\n    Ctx.cancelAction();\n  };\n\n  async function doSubmit(data, oldData) {\n    const form = Object.assign(\n      {},\n      { \"@type\": type },\n      data.formData ? data.formData : data\n    );\n    const client = Ctx.client;\n    const res = await client.create(Ctx.path, form);\n    Ctx.flash(\"Content created!\", \"success\");\n    Ctx.cancelAction();\n    Ctx.refresh();\n  }\n\n  return (\n    <Modal isActive={true} setActive={setActive}>\n      <Form\n        onSubmit={doSubmit}\n        onError={err => console.log(err)}\n        actionName={\"Add \" + type}\n        title={\"Add \" + type}\n        type={type}\n      />\n    </Modal>\n  );\n}\n","import React from \"react\";\nimport { TraversalContext } from \"../../contexts\";\nimport { FileUpload } from \"../input/upload\";\nimport { Button } from \"../input/button\";\n\n\nexport function IAttachment(props) {\n  const ctx = React.useContext(TraversalContext);\n  const canModify = ctx.hasPerm(\"guillotina.ModifyContent\");\n\n\n  const uploadFile = async file => {\n    const endpoint = `${ctx.path}@upload/file`;\n    const req = await ctx.client.upload(endpoint, file);\n    if (req.status !== 200) {\n      ctx.flash(\"Failed to upload file\", \"error\")\n      return\n    }\n    ctx.flash(\"file uploaded\", \"success\")\n    ctx.refresh();\n  };\n\n  const downloadFile = (file, content_type) => async event => {\n    const endpoint = `${ctx.path}@download/file`;\n    const res = await ctx.client.download(endpoint);\n    const text = await res.blob();\n    const blob = new Blob([text], {\n      type: content_type\n    });\n    const url = window.URL.createObjectURL(blob);\n\n    // Create blob link to download\n    const link = document.createElement(\"a\");\n    link.href = url;\n    link.setAttribute(\"download\", `${file.filename}`);\n    document.body.appendChild(link);\n    link.click();\n    link.parentNode.removeChild(link);\n  };\n\n  return (\n    <tr>\n      <td>\n        {!props.file && \"undefined\"}\n        {props.file && (\n          <React.Fragment>\n            {props.file.filename} / {props.file.content_type} ({props.file.size}\n            )<br />\n            <Button\n              onClick={downloadFile(props.file, props.file.content_type)}\n              className=\"is-small\"\n            >\n              Download\n            </Button>\n          </React.Fragment>\n        )}\n      </td>\n      <td>{canModify && <FileUpload onChange={uploadFile} />}</td>\n    </tr>\n  );\n}\n\n\n","import React from \"react\";\nimport { Input } from \"../input/input\";\nimport { FileUpload } from \"../input/upload\";\nimport { Button } from \"../input/button\";\nimport {useState} from 'react'\nimport { useCrudContext } from \"../../hooks/useCrudContext\";\nimport ErrorZone from '../error_zone'\n\nexport function IMultiAttachment(props) {\n\n  const [fileKey, setFileKey] = useState('')\n  const [file, setFile] = useState()\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState(undefined)\n  const {Ctx } = useCrudContext()\n\n  const uploadFile = async (ev) => {\n    ev.preventDefault()\n    if (!fileKey && !file) {\n      setError(\"Provide a file and a key name\")\n      return\n    }\n    setLoading(true)\n    setError(undefined)\n    const endpoint = `${Ctx.path}@upload/files/${fileKey}`;\n    const req = await Ctx.client.upload(endpoint, file)\n    if (req.status !== 200) {\n      setError(\"Failed to upload file\")\n      return\n    }\n    setFileKey('')\n    setFile(undefined)\n    setLoading(false)\n    Ctx.flash(`${fileKey} uploaded!`, 'success')\n    Ctx.refresh()\n  }\n\n  const downloadFile = (file, content_type, fileName) => async event => {\n    const endpoint = `${Ctx.path}@download/files/${file}`;\n    const res = await Ctx.client.download(endpoint);\n    const text = await res.blob();\n    const blob = new Blob([text], {\n      type: content_type\n    });\n    const url = window.URL.createObjectURL(blob);\n\n    // Create blob link to download\n    const link = document.createElement(\"a\");\n    link.href = url;\n    link.setAttribute(\"download\", `${fileName}`);\n    document.body.appendChild(link);\n    link.click();\n    link.parentNode.removeChild(link);\n  };\n\n  return (\n    <React.Fragment>\n      {Object.keys(props.files).map(file => (\n        <tr key={file}>\n          <td>{file}</td>\n          <td>\n            {props.files[file].filename} / ({props.files[file].content_type})\n            &nbsp;\n            <Button\n              className=\"is-small\"\n              onClick={downloadFile(\n                file,\n                props.files[file].content_type,\n                props.files[file].filename\n                )}\n            >\n              Download\n            </Button>\n          </td>\n        </tr>\n      ))}\n      {Object.keys(props.files).length === 0 && (\n        <tr>\n          <td colSpan={2}>No files uploaded</td>\n        </tr>\n      )}\n      <tr>\n        <td colSpan={2}>\n          <label className=\"label\">Upload a file</label>\n          <form className=\"columns\">\n            <div className=\"column is-4\">\n              <Input\n                placeholder=\"Key\"\n                name=\"field\"\n                className=\"is-small\"\n                value={fileKey}\n                onChange={(ev) => setFileKey(ev)}\n              />\n              {error && <ErrorZone>{error}</ErrorZone>}\n            </div>\n            <div className=\"column is-2\">\n              <FileUpload\n                onChange={(ev) => setFile(ev)}\n                />\n              {file && file.filename}\n            </div>\n            <div className=\"column is-2\">\n              <Button className=\"is-primary is-small\"\n                loading={loading}\n                onClick={uploadFile}\n                disabled={(!fileKey && !file)}>Upload</Button>\n            </div>\n          </form>\n        </td>\n      </tr>\n    </React.Fragment>\n  );\n}\n","\nexport const initialState = {\n  path: \"\",\n  loading: false,\n  context: undefined,\n  flash: {\n    message: undefined,\n    type: undefined\n  },\n  action: {\n    action: undefined,\n    params: undefined\n  },\n  permissions: undefined,\n  errorStatus: undefined,\n  registry: {},\n  refresh: undefined\n};\n\n\nexport function guillotinaReducer(state, action) {\n  switch (action.type) {\n    case \"SET_PATH\":\n      return { ...state, path: action.payload, loading:true };\n\n    case \"SET_CONTEXT\":\n      return { ...state, ...action.payload, errorStatus:undefined, loading:false };\n\n    case \"SET_ERROR\":\n      return { ...state, errorStatus: action.payload, loading:false };\n\n    case \"SET_FLASH\":\n      return { ...state, ...action.payload };\n\n    case \"CLEAR_FLASH\":\n      return {\n        ...state,\n        flash: {\n          message: undefined,\n          type: undefined\n        }\n      };\n    case \"SET_ACTION\":\n      return { ...state, action: action.payload };\n    case \"CLEAR_ACTION\":\n      return { ...state, action: { action: undefined, params: undefined } };\n\n    case \"REFRESH\":\n      return {...state, refresh:Math.random(), loading:true}\n\n    case \"APPLY\":\n      return {...state, context: {...state.context, ...action.payload}}\n\n    default:\n      return state;\n  }\n}\n","import React from 'react'\n\nconst style = { color: '#F44336', fontSize: 20, paddingBottom: 20 }\n\nexport default class ErrorBoundary extends React.Component {\n  state = {}\n\n  componentDidCatch(error, errorInfo) {\n    this.setState({ \n      hasError: true, \n      errorMsg: error.message,\n      errorStack: errorInfo.componentStack\n    })\n  }\n\n  render() {\n    const { hasError, errorMsg, errorStack } = this.state\n\n    if (hasError) {\n      return (\n        <div className=\"box main-panel\">\n          <div style={style}>Something went wrong.</div>\n          {errorMsg && <p><b>{errorMsg}</b></p>}\n          {errorStack && <p>{errorStack}</p>}\n        </div>\n      );\n    }\n\n    return this.props.children; \n  }\n}","import React from \"react\";\nimport { useReducer } from \"react\";\nimport { useEffect } from \"react\";\nimport { useRef } from \"react\";\nimport { getClient } from \"../lib/client\";\nimport { Flash } from \"./flash\";\nimport { TraversalProvider } from \"../contexts\";\nimport { Path } from \"./path\";\nimport { NotAllowed } from \"./notallowed\";\nimport { NotFound } from \"./notfound\";\nimport { Permissions } from \"../models\";\nimport { useConfig } from \"../hooks/useConfig\";\nimport { useRegistry } from \"../hooks/useRegistry\";\nimport { useLocation } from \"../hooks/useLocation\";\nimport { guillotinaReducer } from \"../reducers/guillotina\";\nimport { initialState } from \"../reducers/guillotina\";\nimport { Loading } from './ui/loading'\nimport ErrorBoundary from \"./error_boundary\";\n\nexport function Guillotina({ auth, ...props }) {\n  const url = props.url || \"http://localhost:8080\"; // without trailing slash\n\n  // Will hold client instance\n  const ref = useRef();\n\n  useConfig(props.config || {});\n  const registry = useRegistry(props.registry || {});\n  // Location is cooked routing solution (only uses search params)\n  const [location, setRouterParam] = useLocation();\n\n  // if there is no path provided just go to root\n  const searchPath = location.get(\"path\") || \"/\";\n  if (searchPath && searchPath !== \"\") {\n    initialState.path = searchPath;\n  }\n\n  const [state, dispatch] = useReducer(guillotinaReducer, initialState);\n\n  // we store the client on a ref (refs are stable across renders)\n  if (!ref.current) {\n    // TODO: Refactor, we should be able to provide just a client\n    // this way is easy composable and extensible from outside.\n    ref.current = props.client || getClient(url, auth);\n  }\n\n  const { path, refresh } = state;\n  const client = ref.current;\n\n  useEffect(() => {\n    dispatch({ type: \"SET_PATH\", payload: searchPath });\n  }, [searchPath]);\n\n  useEffect(() => {\n    (async () => {\n      let data = await client.getContext(path);\n      if (data.status === 401) {\n        dispatch({ type: \"SET_ERROR\", payload: \"notallowed\" });\n        return;\n      } else if (data.status === 404) {\n        dispatch({ type: \"SET_ERROR\", payload: \"notfound\" });\n        return;\n      }\n      let context = await data.json();\n      const pr = await client.canido(path, Permissions);\n      const permissions = await pr.json();\n      dispatch({ type: \"SET_CONTEXT\", payload: { context, permissions } });\n\n    })();\n  }, [path, refresh, client]);\n\n\n  const contextData = {\n    url,\n    client,\n    auth,\n    state,\n    dispatch,\n    registry,\n    setRouterParam\n  };\n\n  const { action, errorStatus, permissions } = state;\n  const Main = registry.getComponent(state.context, path);\n  const Action = action.action ? registry.getAction(action.action) : null;\n\n  return (\n    <ErrorBoundary>\n      {!errorStatus && (\n        <TraversalProvider {...contextData}>\n          {permissions && (\n            <React.Fragment>\n              {action.action && <Action {...action.params} />}\n                <div className=\"level\">\n                <div className=\"level-left\">\n                  <div className=\"level-item\">\n                    <Path />\n                  </div>\n                </div>\n              </div>\n              <Flash />\n              {Main && (\n                <ErrorBoundary>\n                  <div className=\"box main-panel\">\n                    {state.loading && <Loading />}\n                    {!state.loading && <Main state={state} />}\n                  </div>\n                </ErrorBoundary>\n              )}\n              {/* <p>Guillotina {JSON.stringify(state.context)}</p> */}\n            </React.Fragment>\n          )}\n        </TraversalProvider>\n      )}\n      {errorStatus === \"notallowed\" && <NotAllowed />}\n      {errorStatus === \"notfound\" && <NotFound />}\n    </ErrorBoundary>\n  );\n}\n","import React from \"react\";\nimport { Icon } from \"./ui/icon\";\n\nexport function Layout({ children, onLogout, auth }) {\n  const doLogout = ev => {\n    auth.logout();\n    onLogout();\n  };\n\n  return (\n    <React.Fragment>\n      <header>\n        <nav className=\"navbar\" role=\"navigation\" aria-label=\"main navigation\">\n          <div className=\"navbar-brand\">\n            <a className=\"navbar-item\" href=\"/\">\n              <img\n                src={process.env.PUBLIC_URL + \"/logo.svg\"}\n                alt=\"Guillotina logo\"\n                height=\"80\"\n              />\n            </a>\n            <a\n              id=\"burger\"\n              href=\"/\"\n              role=\"button\"\n              className=\"navbar-burger burger\"\n              aria-label=\"menu\"\n              aria-expanded=\"false\"\n              data-target=\"navbarmenu\"\n            >\n              <span aria-hidden=\"true\"></span>\n              <span aria-hidden=\"true\"></span>\n              <span aria-hidden=\"true\"></span>\n            </a>\n          </div>\n          <div id=\"navbarmenu\" className=\"navbar-menu\">\n            <div className=\"navbar-start\"></div>\n            <div className=\"navbar-end\">\n              <div className=\"navbar-item\">\n                {auth.isLogged && (\n                  <div className=\"buttons\">\n                    <button className=\"button is-size-7\" onClick={doLogout}>\n                      <Icon icon=\"fas fa-sign-out-alt\" size=\"is-size-7\" />\n                      <span>Logout</span>\n                    </button>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </nav>\n      </header>\n      <section className=\"section main\">\n        <div className=\"container\">\n          <div className=\"column\">{children}</div>\n        </div>\n      </section>\n    </React.Fragment>\n  );\n}\n","\nimport React from 'react';\nimport {Component} from 'react';\nimport linkState from 'linkstate';\n\nconst ERRORS = {\n  \"failed_to_fetch\": \"Failed to fetch data: Backend not running?\",\n  \"invalid_credentials\": \"Failed! Invalid credentials\"\n}\n\nexport class Login extends Component {\n\n    state = {\n        username: '',\n        password: '',\n        loading: undefined,\n        schema: '',\n        errors: undefined\n    }\n\n    constructor(props) {\n      super(props)\n      if (props.schemas) {\n        this.state.schema = props.schemas[0]\n      }\n    }\n\n    ref = React.createRef()\n\n    doLogin = async (ev) => {\n        ev.preventDefault()\n        this.setState({loading:true, errors:undefined})\n        const {username, password, schema} = this.state;\n\n        if (schema !== '') {\n          this.props.auth.setAccount(schema)\n        }\n        const auth = this.props.auth\n        const res = await auth.login(username, password)\n\n        if (!res) {\n          this.setState({errors:auth.errors, loading:false})\n          return\n        }\n\n        if (this.props.onLogin) {\n          this.props.onLogin()\n        }\n    }\n\n    componentDidMount() {\n      this.ref.current.focus()\n    }\n\n    render() {\n      let {password, username, errors } = this.state\n      const {schemas} = this.props\n      return (\n        <React.Fragment>\n        <form className=\"login__form\" action=\"\" onSubmit={this.doLogin}>\n          <div className=\"field\">\n            <label className=\"label\">Username:</label>\n              <input type=\"text\" className=\"input\"\n                placeholder=\"Username\"\n                onChange={linkState(this, 'username')}\n                value={username}\n                ref={this.ref}\n                />\n          </div>\n          <div className=\"field\">\n            <label className=\"label\">Password:</label>\n              <input type=\"password\" className=\"input\"\n                onChange={linkState(this, 'password')}\n                value={password}\n                />\n          </div>\n          {schemas && <div className=\"field\">\n            <label className=\"label\">Schema:</label>\n            <div className=\"select\">\n              <select onChange={linkState(this, 'schema')}>\n              {schemas.map(s => <option value={s} key={s}>{s}</option>)}\n              </select>\n            </div>\n          </div>}\n          <div className=\"field\">\n            <button className=\"button is-warning\" type=\"submit\">Login</button>\n          </div>\n          <div className=\"field\">\n          {errors && <p className=\"has-text-danger\">{ERRORS[errors] || 'Generic error'}</p>}\n          </div>\n        </form>\n        </React.Fragment>\n      )\n    }\n}\n","\nimport jwt_decode from 'jwt-decode'\n\nconst noop = () => {}\n\nexport class Auth {\n\n  maxRetry = 1\n  retryRefresh = 0\n  events = {}\n\n  constructor(url) {\n    this.url = url\n    this.base_url = url\n    this.errors = undefined\n  }\n\n  getUrl(endpoint) {\n    return `${this.url}${endpoint}`\n  }\n\n  setAccount(account) {\n    this.url = this.base_url + account\n  }\n\n  async login(username, password) {\n    const url = this.getUrl('@login')\n    try {\n      const data = await fetch(url, {\n        method: 'post',\n        body: JSON.stringify({\n          username: username,\n          password:password\n        })\n      })\n      if (data.status === 200) {\n        const credentials = await data.json()\n        this.storeAuth(credentials, username)\n        return true\n      } else {\n        this.errors = \"invalid_credentials\"\n      }\n    } catch (e) {\n      this.errors = \"failed_to_fetch\"\n      return false\n    }\n    localStorage.removeItem('auth');\n    localStorage.removeItem('auth_expires');\n    return false\n  }\n\n  get isLogged() {\n    if (typeof localStorage === 'undefined') {\n      return false\n    }\n    const [token, expires] = this._getToken()\n    if (!token || !expires) {\n      return false\n    }\n    if (this.isExpired(expires)) {\n        return false\n    }\n    return true\n  }\n\n  get username() {\n    if (typeof localStorage === 'undefined') {\n      return false\n    }\n    const [token] = this._getToken()\n    const data = jwt_decode(token)\n    console.log(token)\n    return data.id\n  }\n\n  storeAuth(data) {\n    localStorage.setItem('auth', data.token)\n    localStorage.setItem('auth_expires', data.exp);\n  }\n\n  cleanAuth() {\n    localStorage.removeItem(\"auth\")\n    localStorage.removeItem(\"auth_expires\")\n  }\n\n  logout() {\n    this.cleanAuth()\n  }\n\n  async refreshToken() {\n    console.log(\"refresh!!!\")\n    this.retryRefresh++\n    let data = await fetch(this.getUrl('@login-renew'), {\n      headers: this.getHeaders(),\n      method: 'post',\n    })\n    if (data.status === 401) {\n      // invalid token\n      this.cleanAuth()\n      this.onLogout()\n      return\n    }\n    const res = await data.json()\n    console.log(\"refresh data\", res)\n    this.storeAuth(res)\n    console.log(\"token refreshed\")\n    this.retryRefresh = 0\n    return data.token\n  }\n\n  willExpire(expiration) {\n    let now = new Date().getTime()\n    if ((parseInt(expiration)*1000)  < (now + 10*1000)) {\n      return true\n    }\n    return false\n  }\n\n  isExpired(expiration) {\n    let now = new Date().getTime()\n    if (parseInt(expiration)*1000 > now) {\n      return false\n    }\n    return true\n  }\n\n  _getToken() {\n    return [\n      localStorage.getItem('auth'),\n      localStorage.getItem('auth_expires')\n    ]\n  }\n\n  getToken() {\n    const [token,] = this._getToken()\n    return token\n  }\n\n  getHeaders() {\n    const [authToken, expires]  = this._getToken()\n    if (!authToken) return false;\n\n    if (this.willExpire(expires) && this.retryRefresh < this.maxRetry) {\n      (async () => await this.refreshToken())()\n    }\n\n    return {\n      'Accept': 'application/json',\n      'Content-Type': 'application/json',\n      'Authorization': 'Bearer ' + authToken\n    }\n  }\n\n}\n\n\n","import React from 'react';\nimport {Layout} from './guillo-gmi'\nimport {Auth} from './guillo-gmi'\nimport {Guillotina} from './guillo-gmi'\nimport {Login} from './guillo-gmi'\nimport {useState} from 'react'\nimport './guillo-gmi/scss/styles.sass'\n\n/*\n\nThis should be enought to scope guillotina\nto a container\n\n\nSchemas should be passed to the login form\n\n\nconst schemas = [\n  \"\",\n  \"db/guillotina/\",\n  \"db/crawler/\",\n]\n*/\n\nlet url = 'http://localhost:8080/'\nif (process.env.NODE_ENV === 'production') {\n  url = '/'\n}\n\nconst auth = new Auth(url)\n\nfunction App() {\n\n  const [isLogged, setLogged] = useState(auth.isLogged)\n\n  const onLogin = () => {\n    setLogged(true)\n  }\n  const onLogout = () => setLogged(false)\n\n  auth.onLogout = onLogout\n\n  return (\n\n      <Layout auth={auth} onLogout={onLogout}>\n        { isLogged && <Guillotina auth={auth} url={url} />}\n        { !isLogged && (\n          <div className=\"columns is-centered\">\n            <div className=\"columns is-half\">\n              <Login onLogin={onLogin} auth={auth} />\n            </div>\n          </div>\n        )}\n      </Layout>\n  );\n}\n\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n"],"sourceRoot":""}