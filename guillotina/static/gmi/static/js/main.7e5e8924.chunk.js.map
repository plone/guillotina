{"version":3,"sources":["guillo-gmi/lib/rest.js","guillo-gmi/lib/helpers.js","guillo-gmi/components/ui/icon.js","guillo-gmi/components/ui/loading.js","guillo-gmi/components/ui/tag.js","guillo-gmi/components/ui/delete.js","guillo-gmi/components/ui/table.js","guillo-gmi/components/ui/notification.js","guillo-gmi/lib/client.js","guillo-gmi/contexts/index.js","guillo-gmi/components/input/button.js","guillo-gmi/components/modal.js","guillo-gmi/hooks/useConfig.js","guillo-gmi/actions/remove_items.js","guillo-gmi/components/input/checkbox.js","guillo-gmi/components/error_zone.js","guillo-gmi/hooks/useInput.js","guillo-gmi/lib/validators.js","guillo-gmi/components/input/input.js","guillo-gmi/components/input/form.js","guillo-gmi/components/input/form_builder.js","guillo-gmi/components/input/password.js","guillo-gmi/components/input/email.js","guillo-gmi/components/input/select.js","guillo-gmi/components/input/upload.js","guillo-gmi/components/input/textarea.js","guillo-gmi/hooks/useCrudContext.js","guillo-gmi/components/fields/editableField.js","guillo-gmi/components/fields/renderField.js","guillo-gmi/components/behaviors/idublincore.js","guillo-gmi/components/panel/addons.js","guillo-gmi/components/panel/behaviors.js","guillo-gmi/lib/utils.js","guillo-gmi/models/sharing.js","guillo-gmi/models/index.js","guillo-gmi/components/input/dropdown.js","guillo-gmi/components/selected_items_actions.js","guillo-gmi/components/item.js","guillo-gmi/components/pagination.js","guillo-gmi/hooks/useLocation.js","guillo-gmi/components/searchLabels.js","guillo-gmi/lib/search.js","guillo-gmi/components/panel/items.js","guillo-gmi/components/behavior_view.js","guillo-gmi/components/properties_view.js","guillo-gmi/components/panel/properties.js","guillo-gmi/components/panel/permissions_roleperm.js","guillo-gmi/components/panel/permissions_prinperm.js","guillo-gmi/components/panel/permissions_prinrole.js","guillo-gmi/components/panel/permissions.js","guillo-gmi/components/widgets/tags.js","guillo-gmi/components/context_toolbar.js","guillo-gmi/components/flash.js","guillo-gmi/components/path.js","guillo-gmi/components/notallowed.js","guillo-gmi/components/notfound.js","guillo-gmi/components/tabs.js","guillo-gmi/views/folder.js","guillo-gmi/views/item.js","guillo-gmi/views/application.js","guillo-gmi/views/container.js","guillo-gmi/views/base.js","guillo-gmi/forms/users.js","guillo-gmi/hooks/useRemoteField.js","guillo-gmi/views/users.js","guillo-gmi/actions/copy_items.js","guillo-gmi/actions/move_items.js","guillo-gmi/forms/base.js","guillo-gmi/views/groups.js","guillo-gmi/components/error_boundary.js","guillo-gmi/hooks/useRegistry.js","guillo-gmi/actions/add_item.js","guillo-gmi/components/behaviors/iattachment.js","guillo-gmi/components/behaviors/imultiattachment.js","guillo-gmi/reducers/guillotina.js","guillo-gmi/components/guillotina.js","guillo-gmi/components/layout.js","guillo-gmi/components/login.js","guillo-gmi/lib/auth.js","App.js","index.js"],"names":["RestClient","url","auth","this","path","data","headers","getHeaders","fetch","authToken","getToken","request","method","body","JSON","stringify","filename","undefined","classnames","classNames","filter","Boolean","join","trim","noop","current","generateUID","prefix","toQueryString","params","Object","keys","map","key","encodeURIComponent","sleep","ms","Promise","resolve","reject","setTimeout","Icon","icon","className","align","addClass","split","Loading","rest","Tag","name","onRemove","size","color","onClick","Delete","children","type","Table","item","idx","Notification","isColor","cacheTypes","cacheSchemas","GuillotinaClient","isContainer","get","startsWith","substring","slice","start","pageSize","result","json","applyCompat","smallcss","width","mediumcss","label","child","m","style","navigate","search","Fragment","created","updated","member","items","items_count","items_total","container","prepare","getContainerFromPath","query","res","permissions","Array","isArray","post","replace","delete","cleanPath","create","patch","file","upload","id","endpoint","groups","getGroups","users","getUsers","all","gr","usr","endsWith","req","resp","from","Set","extractPermissions","types","status","parts","lightFileReader","a","async","reader","FileReader","readAsArrayBuffer","onloadend","e","fileData","target","permission","concat","TraversalContext","createContext","Traversal","flash","props","assign","setRouterParam","dispatch","payload","message","window","scrollTo","top","left","behavior","action","state","tabs","tabsPermissions","forEach","perm","hasPerm","context","TraversalProvider","Provider","value","Button","loading","disabled","css","Modal","isActive","setActive","Portal","usePortal","aria-label","Confirm","onCancel","onConfirm","p","marginTop","PathTree","title","defaultPath","onSubmit","preventDefault","placeholder","margin","defaultValue","Config","DisabledTypes","PageSize","DelayActions","calculated","addConfig","additional","original","useConfig","cfg","ref","React","useRef","console","log","getId","Checkbox","indeterminate","backgroundColor","borderColor","onChange","inputRef","useState","setState","useEffect","htmlFor","checked","ev","ErrorZone","useInput","validator","hasError","onFocus","onBlur","validators","validation","func","applyValidators","REGEX_EMAIL","isEmail","test","notEmpty","length","Input","forwardRef","iconPosition","error","errorZoneClassName","autoComplete","widget","onPressEnter","isSubmitted","required","autofocus","errorMessage","push","handlers","uid","mounted","setMounted","focus","theError","statusClasses","aria-invalid","aria-describedby","Form","onReset","event","formComponents","string","password","boolean","email","FormBuilder","schema","formData","actionName","exclude","remotes","submitButton","properties","values","initialState","fields","x","includes","element","onUpdate","field","GetTag","displayName","children_","Children","cloneElement","i","Select","options","classWrap","multiple","resetOnChange","appendDefault","text","cssWrap","index","toString","FileUpload","files","Textarea","rows","initial","isError","response","processResponse","ready_body","Ctx","newState","client","del","useCrudContext","useContext","useSetState","EditableField","Type","ns","isEdit","setEdit","val","setValue","saveField","refresh","plain","RenderField","Widget","FieldValue","Schema","editable","widgets","description","prepareData","addons","arrayToObject","available","installed","array","reduce","obj","PanelBehaviors","ops","enableBehavior","disableBehavior","colSpan","static","dynamic","formatDate","str","d","Date","minutes","getMinutes","getDate","getMonth","getFullYear","getHours","base","local","roleperm","prinperm","prinrole","inherit","Sharing","role","principal","ItemModel","_path","splice","icons","_url","type_name","creation_date","modification_date","Permissions","Dropdown","isRight","optionDisabledWhen","setIsActive","position","useClickAway","aria-haspopup","aria-controls","option","cursor","opacity","ItemsActionsCtx","actions","DELETE","perms","MOVE","COPY","ItemsActionsProvider","traversal","selected","setSelected","onAction","actionKey","doAction","onSelectAllItems","onSelectOneItem","AllItemsCheckbox","marginLeft","ItemCheckbox","ItemsActionsDropdown","every","v","o","some","Item","setPath","link","RItem","columns","model","ItemTitle","Pagination","total","doPaginate","pager","maxPages","Math","ceil","setURLParams","history","pathname","clean","to","URLSearchParams","_key","set","useLocation","currentSearchParams","update","prevPath","patchHistoryEvents","checkForUpdates","events","addEventListener","removeEventListener","useCallback","remove","param","patched","apply","arguments","Event","dispatchEvent","location","SearchLabels","SEP","DEFAULT_FIELD","CLEANER","page","PanelItems","setLocation","getItemsColumn","parseInt","searchParsed","qs","defaultField","lastKey","part","parser","getItems","BehaviorsView","getBehavior","registry","behaviors","__behaviors__","b","Cls","BehaviorNotImplemented","GetBehavior","PropertiesButtonView","Props","getProperties","Buttons","PropertiesView","Panels","_showProperties","_editable","PanelProperties","modifyContent","showProperties","properties_default","properties_editable","prop","PermissionRoleperm","setter","roles","operations","setting","selectedOptions","random","PermissionPrinperm","PermissionPrinrole","PanelPermissions","reset","setReset","getRole","row","principals","getPrincipals","getPrinroles","AddPermission","currentObj","defaultOptions","getAllPermissions","group","getRoles","init","prepareAvailable","already","def","TagsWidget","noData","setResult","addItem","marginBottom","CreateButton","getTypes","ContextToolbar","AddButton","ctx","searchText","q","tab","Flash","clearFlash","Path","segments","links","buildPaths","indx","ctrlKey","metaKey","href","results","NotAllowed","fontSize","NotFound","FallbackTab","TabsPanel","currentTab","rightToolbar","fallback","setTab","CurrentComp","changeTab","Items","Properties","Behaviors","FolderCtx","filterTabs","ItemCtx","CreateContainer","ModalAddContainer","isLoading","setLoading","idField","setId","setError","Addons","setAction","useAsync","getAddons","pathPrefix","addon","installAddon","removeAddon","Registry","UserForm","attr","useRemoteField","setRemote","Users","UsersToolbar","withError","getNewId","rgx","RegExp","r","num","BaseForm","setName","toLowerCase","l","charAt","stringToSlug","Groups","GroupToolbar","paddingBottom","paths","views","ErrorBoundary","errorInfo","errorMsg","errorStack","componentStack","Component","Application","databases","db","Database","containers","Container","UserManager","User","gorups","user_groups","user_roles","updateRemote","username","updateObject","Group","setRoles","setUsers","req2","user","urole","removeUser","GroupManager","Folder","getForm","cancelAction","oldData","form","onError","err","copyItems","input","destination","new_id","responses","display","moveItems","removeItems","last","itemsNames","errors","ok","errorstr","forms","content_type","canModify","download","blob","Blob","URL","createObjectURL","document","createElement","setAttribute","appendChild","click","parentNode","removeChild","fileKey","setFileKey","setFile","downloadFile","fileName","schemas","getComponent","defaultComponent","getAction","is_folderish","errorStatus","guillotinaReducer","Guillotina","config","useRegistry","searchPath","useReducer","getClient","getContext","canido","pr","contextData","Main","Action","Layout","onLogout","src","process","alt","height","aria-expanded","data-target","aria-hidden","isLogged","logout","ERRORS","Login","createRef","doLogin","setAccount","login","onLogin","linkState","s","Auth","maxRetry","retryRefresh","base_url","account","getUrl","credentials","storeAuth","localStorage","removeItem","setItem","token","exp","cleanAuth","expiration","now","getTime","getItem","_getToken","expires","willExpire","refreshToken","isExpired","jwt_decode","App","setLogged","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.7e5e8924.chunk.js","sourcesContent":["\n\nexport class RestClient {\n\n  constructor(url, auth) {\n    this.auth = auth\n    this.url = url\n  }\n\n  async request(path, data, headers) {\n    data = data || {}\n    data.headers = headers || this.getHeaders()\n    return await fetch(`${this.url}${path}`, data)\n  }\n\n  getHeaders() {\n    const authToken  = this.auth.getToken()\n    if (!authToken) return {};\n    return {\n      'Accept': 'application/json',\n      'Content-Type': 'application/json',\n      'Authorization': 'Bearer ' + authToken\n    }\n  }\n\n  async post(path, data) {\n    return await this.request(path, {\n      method: 'post',\n      body: JSON.stringify(data)\n    })\n  }\n\n  async get(path) {\n    return await this.request(path, {})\n  }\n\n  async put(path, data) {\n    return await this.request(path, {\n      method: 'put',\n      body: JSON.stringify(data)\n    })\n  }\n\n  async patch(path, data) {\n    return await this.request(path, {\n      method: 'PATCH',\n      body: JSON.stringify(data)\n    })\n  }\n\n  async upload(path, data) {\n\n    const headers = this.getHeaders()\n    delete headers[\"Content-Type\"]\n    headers[\"Content-Type\"] = data[\"content-type\"]\n    headers[\"X-UPLOAD-FILENAME\"] = data.filename\n    headers[\"Content-Encoding\"]= \"base64\"\n    return await this.request(path, {\n      method: 'PATCH',\n      body: data.data\n    }, headers)\n  }\n\n  async delete(path, data=undefined) {\n    return await this.request(path, {\n      method: 'delete',\n      body: JSON.stringify(data)\n    })\n  }\n}\n","export const classnames = classNames => {\n  return classNames\n    .filter(Boolean)\n    .join(\" \")\n    .trim();\n};\n\nexport const noop = () => {};\n\nlet current = 0;\n\nexport const generateUID = prefix => `${prefix || \"id\"}-${current++}`;\n\nexport const toQueryString = params => {\n  return Object.keys(params)\n    .map(key => {\n      return encodeURIComponent(key) + \"=\" + encodeURIComponent(params[key]);\n    })\n    .join(\"&\");\n};\n\nexport function base64ToArrayBuffer(base64) {\n  const binaryString = window.atob(base64);\n  const binaryLen = binaryString.length;\n  const bytes = new Uint8Array(binaryLen);\n  for (var i = 0; i < binaryLen; i++) {\n    var ascii = binaryString.charCodeAt(i);\n    bytes[i] = ascii;\n  }\n  return bytes;\n}\n\n\nexport function stringToSlug (str) {\n  str = str.replace(/^\\s+|\\s+$/g, ''); // trim\n  str = str.toLowerCase();\n\n  // remove accents, swap  for n, etc\n  var from = \"/_,:;\";\n  var to   = \"aaaaeeeeiiiioooouuuunc------\";\n  for (var i=0, l=from.length ; i<l ; i++) {\n      str = str.replace(new RegExp(from.charAt(i), 'g'), to.charAt(i));\n  }\n\n  str = str.replace(/[^a-z0-9 -]/g, '') // remove invalid chars\n      .replace(/\\s+/g, '-') // collapse whitespace and replace by -\n      .replace(/-+/g, '-'); // collapse dashes\n\n  return str;\n}\n\n\nexport function sleep(ms) {\n  return new Promise((resolve, reject) => {\n    setTimeout(function() {\n      resolve()\n    }, ms)\n  })\n}\n","import React from \"react\";\nimport { classnames } from \"../../lib/helpers\";\n\nexport const Icon = ({ icon, className, align }) => {\n  const addClass = className ? className.split(\" \") : [className];\n\n  align = align || \"is-right\";\n\n  return (\n    <span className={classnames([\"icon\", align, ...addClass])}>\n      <i className={icon}></i>\n    </span>\n  );\n};\n","import React from 'react'\n\n\nexport const Loading = ({...rest}) => (\n  <div className=\"progress-line\" {...rest}></div>\n)\n","\nimport React from 'react'\nimport {classnames} from '../../lib/helpers'\n\nexport const Tag = ({name, onRemove, size='is-medium', color='is-warning'}) => (\n  <span className={classnames([\"tag\", color,  size])}>\n    {name}\n    {onRemove!==undefined &&\n      <button className=\"delete is-small\"\n        onClick={() => onRemove()}></button>}\n  </span>\n)\n","import React from 'react'\n\nexport function Delete({ onClick, children }) {\n  return (<button type=\"button\"\n    onClick={onClick} className=\"delete\">\n      {children}</button>\n  );\n}\n","import React from \"react\";\nimport { classnames } from \"../../lib/helpers\";\n\nexport function Table({ headers, children, className }) {\n  className = className\n    ? className.split(\" \")\n    : \" is-full is-fullwidth is-narrow\".split(\" \");\n  return (\n    <table className={classnames([\"table\", ...className])}>\n      <thead>\n        <tr>{headers && headers.map((item, idx) => <th key={item + idx}>{item}</th>)}</tr>\n      </thead>\n      <tbody>{children}</tbody>\n    </table>\n  );\n}\n","import React from \"react\";\n\n\nexport function Notification({isColor='', children}) {\n  return (\n    <div className={\"notification is-\" + isColor}>\n      {children}\n    </div>\n  );\n}\n","import React from 'react'\nimport { RestClient } from \"./rest\";\nimport { toQueryString } from \"./helpers\";\nimport { Icon } from \"../components/ui\";\n\nlet cacheTypes = {};\nlet cacheSchemas = {};\n\n\nexport class GuillotinaClient {\n  constructor(rest, isContainer) {\n    this.rest = rest;\n    this.isContainer = isContainer;\n  }\n\n  async getContext(path) {\n    switch (path) {\n      case \"/\":\n        return await this.rest.get(\"\");\n      default:\n        if (path.startsWith(\"/\")) {\n          path = path.substring(1);\n        }\n        return await this.rest.get(path);\n    }\n  }\n\n  async get(path) {\n    if (path.startsWith(\"/\")) {\n      path = path.slice(1);\n    }\n    return await this.rest.get(path);\n  }\n\n  async getItems(path, start = 0, pageSize=10) {\n    if (path.startsWith(\"/\")) {\n      path = path.slice(1);\n    }\n    const result = await this.rest.get(\n      `${path}@search?depth=1&b_start=${start}&b_size=${pageSize}`\n    );\n    let data = await result.json();\n    return this.applyCompat(data)\n  }\n\n  getItemsColumn() {\n    const smallcss = { width: 25 }\n    const mediumcss = { width: 120 }\n\n    return [\n      {\n        label: '',\n        child: (m) => <td style={smallcss}>{<Icon icon={m.icon} />}</td>,\n      },\n      {\n        label: 'type',\n        child: (m, navigate) => (\n          <td style={smallcss} onClick={navigate}>\n            <span className=\"tag\">{m.type}</span>\n          </td>\n        ),\n      },\n      {\n        label: 'id/name',\n        child: (m, navigate, search) => (\n          <td onClick={navigate}>\n            {m.name}\n            {search && (\n              <React.Fragment>\n                <br />\n                <span className=\"is-size-7 tag is-light\">{m.path}</span>\n              </React.Fragment>\n            )}\n          </td>\n        ),\n      },\n      {\n        label: 'created',\n        child: (m) => (\n          <td style={mediumcss} className=\"is-size-7 is-vcentered\">\n            {m.created}\n          </td>\n        ),\n      },\n      {\n        label: 'modified',\n        child: (m) => (\n          <td style={mediumcss} className=\"is-size-7 is-vcentered\">\n            {m.updated}\n          </td>\n        ),\n      },\n    ]\n  }\n\n  // BBB API changes. Compat G5 and G6\n  applyCompat(data) {\n    data.member = data.items\n    data.items_count = data.items_total\n    return data\n  }\n\n  async search(path, params, container = false, prepare = true, start = 0, pageSize=10) {\n    if (path.startsWith(\"/\")) {\n      path = path.slice(1);\n    }\n    if (container) {\n      path = getContainerFromPath(path);\n    }\n    let query = prepare ? toQueryString(params) : params;\n    const url = `${path}@search?${query}&b_start=${start}&b_size=${pageSize}`;\n    let res = await this.rest.get(url)\n    let data = await res.json()\n    return this.applyCompat(data)\n  }\n\n  async canido(path, permissions) {\n    if (path.startsWith(\"/\")) {\n      path = path.slice(1);\n    }\n    if (Array.isArray(permissions)) {\n      permissions.join(\",\");\n    }\n    const url = `${path}@canido?permissions=${permissions}`;\n    return await this.rest.get(url);\n  }\n\n  async createObject(path, data) {\n    return await this.rest.post(path, data);\n  }\n\n  cleanPath(path) {\n    return path.replace(this.rest.url, \"\");\n  }\n\n  async delete(path, data) {\n    return await this.rest.delete(this.cleanPath(path), data);\n  }\n\n  async create(path, data) {\n    if (path.startsWith(\"/\")) {\n      path = path.substring(1);\n    }\n    return await this.rest.post(path, data);\n  }\n\n  async post(path, data) {\n    return await this.create(path, data);\n  }\n\n  async patch(path, data) {\n    if (path.startsWith(\"/\")) {\n      path = path.substring(1);\n    }\n    return await this.rest.patch(path, data);\n  }\n\n  async upload(path, file) {\n    if (path.startsWith(\"/\")) {\n      path = path.substring(1);\n    }\n    return await this.rest.upload(path, file);\n  }\n\n  async download(path) {\n    if (path.startsWith(\"/\")) {\n      path = path.substring(1);\n    }\n    return await this.rest.get(path);\n  }\n\n  async getTypeSchema(path, name) {\n    if (!cacheSchemas[name]) {\n      let url = getContainerFromPath(path);\n      // todo: handle db case (only addable containers)\n      const res = await this.rest.get(`${url}@types/${name}`);\n      cacheSchemas[name] = await res.json();\n    }\n    return cacheSchemas[name];\n  }\n\n  async getAddons(path) {\n    return await this.rest.get(`${path}@addons`);\n  }\n\n  async installAddon(path, key) {\n    return await this.rest.post(`${path}@addons`, { id: key });\n  }\n\n  async removeAddon(path, key) {\n    return await this.rest.delete(`${path}@addons`, { id: key });\n  }\n\n  async getGroups(path) {\n    const endpoint = `${getContainerFromPath(path)}@groups`;\n    return await this.rest.get(endpoint);\n  }\n\n  async getUsers(path) {\n    const endpoint = `${getContainerFromPath(path)}@users`;\n    return await this.rest.get(endpoint);\n  }\n\n  async getPrincipals(path) {\n    const groups = this.getGroups(path)\n    const users = this.getUsers(path)\n    const [gr, usr] = await Promise.all(groups, users)\n    return {\n      groups: await gr.json(),\n      users: await usr.json()\n    }\n  }\n\n  async getRoles(path) {\n    const endpoint = `${getContainerFromPath(path)}@available-roles`;\n    return await this.rest.get(endpoint);\n  }\n\n  async getAllPermissions(path) {\n    if (!path.endsWith(\"/\")) {\n      path = `${path}/`;\n    }\n    const req = await this.rest.get(path + \"@all_permissions\");\n    const resp = await req.json();\n    const permissions = Array.from(new Set(extractPermissions(resp)));\n    return permissions;\n  }\n\n  async getTypes(path) {\n    if (path.startsWith(\"/\")) {\n      path = path.slice(1);\n    }\n    if (!cacheTypes[path]) {\n      const types = await this.rest.get(path + \"@addable-types\");\n      if (types.status === 401 || types.status === 404) {\n        cacheTypes[path] = [];\n      } else {\n        const res = await types.json();\n        cacheTypes[path] = res;\n      }\n    }\n    return cacheTypes[path];\n  }\n}\n\nexport function getClient(url, auth, isContainer = false) {\n  return new GuillotinaClient(new RestClient(url, auth), isContainer);\n}\n\nexport const getContainerFromPath = path => {\n  if (path.startsWith(\"/\")) {\n    path = path.substring(1);\n  }\n  let parts = path.split(\"/\");\n  return `${parts[0]}/${parts[1]}/`;\n};\n\nexport const lightFileReader = async (file) => {\n  return new Promise((resolve) => {\n    const reader = new FileReader();\n    reader.readAsArrayBuffer(file);\n    reader.onloadend = e => {\n      const fileData = e.target.result;\n      resolve({\n        filename: file.name,\n        data: fileData,\n        \"content-type\": file.type\n      });\n    };\n  });\n};\n\nconst extractPermissions = data => {\n  let result = [];\n  if (typeof data !== \"object\") {\n  } else if (!Array.isArray(data) && data.permission) {\n    result = result.concat([data.permission]);\n  } else if (!Array.isArray(data)) {\n    Object.keys(data).map(\n      key => (result = result.concat(extractPermissions(data[key])))\n    );\n  } else if (Array.isArray(data)) {\n    data.map(item => (result = result.concat(extractPermissions(item))));\n  }\n  return result;\n};\n","import React from \"react\";\nimport { createContext } from \"react\";\nimport { getContainerFromPath } from \"../lib/client\";\n\nexport const AuthContext = createContext({});\n\nexport const TraversalContext = createContext({});\n\nclass Traversal {\n  constructor({ flash, ...props }) {\n    Object.assign(this, props);\n    if(typeof flash === 'function') this.flash = flash;\n  }\n\n  setPath(path) {\n    // This is like black magic, document it\n    // router interactions are hard\n    this.setRouterParam({ path: path }, true);\n  }\n\n  refresh() {\n    this.dispatch({ type: \"REFRESH\" });\n  }\n\n  get path() {\n    return this.state.path;\n  }\n\n  get pathPrefix() {\n    return this.state.path.slice(1);\n  }\n\n  get context() {\n    return this.state.context;\n  }\n\n  get containerPath() {\n    return getContainerFromPath(this.path);\n  }\n\n  apply(data) {\n    // apply a optimistic update to context\n    this.dispatch({type: \"APPLY\", payload:data})\n  }\n\n  flash(message, type) {\n    this.dispatch({ type: \"SET_FLASH\", payload: { flash: { message, type } } });\n    window.scrollTo({ top: 0, left: 0, behavior: 'smooth' })\n  }\n\n  clearFlash() {\n    this.dispatch({ type: \"CLEAR_FLASH\" });\n  }\n\n  doAction(action, params) {\n    this.dispatch({ type: \"SET_ACTION\", payload: { action, params } });\n  }\n\n  cancelAction() {\n    this.dispatch({ type: \"CLEAR_ACTION\" });\n  }\n\n  hasPerm(permission) {\n    return this.state.permissions[permission] === true;\n  }\n\n  filterTabs(tabs, tabsPermissions) {\n    const result = {};\n    Object.keys(tabs).forEach(item => {\n      const perm = tabsPermissions[item];\n      if (perm && this.hasPerm(perm)) {\n        result[item] = tabs[item];\n      } else if (!perm) {\n        result[item] = tabs[item];\n      }\n    });\n    return result;\n  }\n}\n\nexport function TraversalProvider({ children, ...props }) {\n  return (\n    <TraversalContext.Provider value={new Traversal(props)}>\n      {children}\n    </TraversalContext.Provider>\n  );\n}\n","import React from 'react'\nimport {classnames} from '../../lib/helpers'\n\nconst noop = () => {}\n\nexport const Button = ({\n  children,\n  className = 'is-primary',\n  onClick,\n  type = 'submit',\n  loading = false,\n  disabled = false,\n  ...rest\n}) => {\n\n  let css = [].concat(\n      'button', ...className.split(\" \"),\n  )\n  if (loading) css = css.concat('is-loading')\n  if (disabled) onClick = noop\n\n  return (\n    <p className=\"control\">\n      <button\n        type={type}\n        className={classnames(css)}\n        onClick={onClick}\n        disabled={disabled}\n        {...rest}\n        >\n        {children}\n      </button>\n    </p>\n  )\n}\n","import React from \"react\";\nimport usePortal from \"react-useportal\";\nimport {Button} from './input/button'\n\nexport function Modal(props) {\n  const { isActive, setActive, children } = props;\n  const { Portal } = usePortal();\n\n  const css = \"modal \" + (isActive ? \"is-active \" : \"\") + props.className;\n  return (\n    <Portal>\n      <div className={css}>\n        <div className=\"modal-background\" onClick={() => setActive(false)} />\n        <div className=\"modal-content\">\n          <div className=\"box\">{children}</div>\n        </div>\n        <button\n          className=\"modal-close is-large\"\n          aria-label=\"close\"\n          onClick={() => setActive(false)}\n        />\n      </div>\n    </Portal>\n  );\n}\n\nexport function Confirm({ message, onCancel, onConfirm, loading }) {\n  const setActive = p => onCancel();\n  return (\n    <Modal isActive setActive={setActive} className=\"confirm\">\n      <React.Fragment>\n        <h1 className=\"title is-size-5\">{message || \"Are you Sure?\"}</h1>\n        <div className=\"level\" style={{ marginTop: 50 }}>\n          <div className=\"level-left\"></div>\n          <div className=\"level-right\">\n            <button className=\"button is-danger\" onClick={() => onCancel()}>\n              Cancel\n            </button>\n            &nbsp;&nbsp;\n            <Button\n              loading={loading}\n              className=\"is-success\"\n              onClick={() => onConfirm()}\n              >Confirm</Button>\n          </div>\n        </div>\n      </React.Fragment>\n    </Modal>\n  );\n}\n\n// @todo Improve it... Replacing the inputText to a tree\nexport function PathTree({ title, defaultPath, children, onConfirm, onCancel }){\n  return (\n    <Modal isActive setActive={onCancel}>\n      <h1>{title}</h1>\n      <form onSubmit={e => {\n          e.preventDefault()\n          onConfirm(e.target[0].value, e.target)\n      }}>\n        <input\n          className=\"input\"\n          placeholder=\"/folder (without /db/container on front)\"\n          style={{ margin: '20px 0'}}\n          defaultValue={defaultPath}\n          type=\"text\"\n        />\n        {children}\n        <div className=\"level-right\">\n          <button type=\"button\" className=\"button is-danger\" onClick={onCancel}>\n            Cancel\n          </button>\n          &nbsp;&nbsp;\n          <button type=\"submit\" className=\"button is-success\">\n            Confirm\n          </button>\n        </div>\n      </form>\n    </Modal>\n  )\n}\n","import React from \"react\";\n\nexport const Config = {\n  DisabledTypes: [\"UserManager\", \"GroupManager\"],\n  PageSize: 10,\n  DelayActions: 200,\n}\n\n\n\nlet calculated = Object.assign({}, Config);\n\nconst addConfig = (additional, original) => {\n  const rest = Object.assign({}, original);\n  Object.keys(additional).forEach(item => {\n    if (typeof Config[item] === \"object\" && Array.isArray(Config[item])) {\n      rest[item] = [].concat(Config[item], additional[item]);\n    } else if (typeof Config[item] === \"object\") {\n      rest[item] = Object.assign({}, Config[item], additional[item]);\n    } else {\n      rest[item] = additional[item];\n    }\n  });\n  return rest;\n};\n\nexport function useConfig(cfg) {\n  const ref = React.useRef();\n  if (cfg && !ref.current) {\n    console.log(\"cfg\", cfg)\n    calculated = addConfig(cfg, calculated);\n    ref.current = calculated\n  }\n\n  // if (cfg && !ref.current) {\n  //   ref.current = addConfig(cfg, ref.current);\n  //   calculated = ref.current\n  //   console.log(\"Current config\", cfg)\n  // }\n  return calculated\n}\n","import React from 'react'\nimport {Confirm} from '../components/modal'\nimport {useContext} from 'react'\nimport {TraversalContext} from '../contexts'\nimport {sleep} from '../lib/helpers'\nimport {useConfig} from '../hooks/useConfig'\n\n// BBB guillotina 5\nconst getId = (item) => {\n  if (item[\"@id\"]) {\n    return item[\"@id\"]\n  }\n  return item[\"@absolute_url\"]\n}\n\nexport function RemoveItems(props) {\n  const Ctx = useContext(TraversalContext)\n  const cfg = useConfig()\n  const [loading, setLoading] = React.useState(false)\n  const { items = [] } = props\n  const last = items[items.length - 1]['@name']\n  const itemsNames = items\n    .map(item => item['@name'])\n    .join(', ')\n    .replace(`, ${last}`, ` and ${last}`)\n\n  async function removeItems() {\n    let errors = []\n    setLoading(true)\n\n    const actions = items.map(async item => {\n      const res = await Ctx.client.delete(getId(item))\n      if (!res.ok) {\n        const err = await res.json()\n        errors.push(err)\n      }\n    })\n    // this sleep is here, to let elasticsearch, wait for\n    // index our operations... (will work 99% of use cases)\n    actions.push(sleep(cfg.DelayActions))\n\n    await Promise.all(actions)\n\n    if (errors.length === 0) {\n      Ctx.flash(`Items removed!`, 'success')\n      Ctx.refresh()\n    } else {\n      const errorstr = errors.map(err => JSON.stringify(err)).join(\"\\n\")\n      Ctx.flash(`Something went wrong!! ${errorstr}`, 'danger')\n    }\n    setLoading(false)\n    Ctx.cancelAction()\n  }\n\n  return (\n    <Confirm\n      loading={loading}\n      onCancel={() => Ctx.cancelAction()}\n      onConfirm={removeItems}\n      message={`Are you sure to remove: ${itemsNames}?`}\n    />\n  )\n}\n","import React, { useEffect, useRef } from \"react\";\nimport { classnames } from \"../../lib/helpers\";\n\nexport const Checkbox = ({\n  id,\n  className,\n  loading,\n  disabled,\n  indeterminate = false,\n  value = false,\n  color,\n  backgroundColor,\n  borderColor,\n  children,\n  placeholder,\n  onChange,\n  ...rest\n}) => {\n  const inputRef = useRef(null);\n  const [state, setState] = React.useState(value)\n\n  useEffect(() => {\n    if (inputRef.current) {\n      inputRef.current.indeterminate = indeterminate;\n    }\n  }, [indeterminate]);\n\n  const updateState = (ev) => {\n    setState(ev.target.checked)\n    onChange(ev.target.checked)\n  }\n\n  return (\n    <div className=\"field\">\n      <label htmlFor={id}\n        className={classnames([\"checkbox\", className])}\n        >\n        <input\n          ref={inputRef}\n          disabled={disabled || loading}\n          id={id}\n          type=\"checkbox\"\n          className=\"checkbox\"\n          checked={state}\n          onChange={updateState}\n          {...rest}\n        />\n        {children || placeholder}\n      </label>\n    </div>\n  );\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { classnames } from '../lib/helpers';\n\nconst ErrorZone = ({ children, id, className }) => {\n    return (\n        <p className={classnames(['help is-danger', className])} id={id}>\n            {children}\n        </p>\n    );\n};\n\nErrorZone.propTypes = {\n    children: PropTypes.node,\n    id: PropTypes.string,\n    className: PropTypes.string\n};\n\nexport default ErrorZone;\n","import React from \"react\";\n\nconst applyValidators = (value, validators) => {\n  let validation = Array.isArray(validators) ? validators : [validators];\n  let result = true;\n  validation.forEach(func => {\n    if (func(value) === false) {\n      result = false;\n    }\n  });\n  return result;\n};\n\nconst useInput = (onChange, value, validator) => {\n  let [state, setState] = React.useState({ hasError: false, value: value });\n\n  const onUpdate = ev => {\n    const value = (ev && ev.target) ? ev.target.value : (ev) ? ev : '';\n    setState({ value, hasError: false });\n    if (onChange)\n      onChange(value);\n  };\n\n  const onBlur = ev => {\n    const hasError = applyValidators(state.value, validator) === false;\n    if (hasError) setState({ value: state.value, hasError });\n  };\n\n  const onFocus = ev => {\n    if (state.hasError) {\n      setState({ value: state.value, hasError: false });\n    }\n  };\n\n  React.useEffect(() => {\n      setState({ value, hasError: false })\n   }, [value])\n\n  return {\n    onChange: onUpdate,\n    onFocus,\n    onBlur,\n    state\n  };\n};\n\nexport default useInput;\n","// From github.com/protonmail/proton-shared\n\n/* eslint-disable no-useless-escape */\nexport const REGEX_EMAIL = /(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))/i;\nexport const REGEX_URL = /((([A-Za-z]{3,9}:(?:\\/\\/)?)(?:[\\-;:&=\\+\\$,\\w]+@)?[A-Za-z0-9\\.\\-]+|(?:www\\.|[\\-;:&=\\+\\$,\\w]+@)[A-Za-z0-9\\.\\-]+)((?:\\/[\\+~%\\/\\.\\w\\-_]*)?\\??(?:[\\-\\+=&;%@\\.\\w_]*)#?(?:[\\.\\!\\/\\\\\\w]*))?)/;\nexport const REGEX_HEX_COLOR = /^#([a-f0-9]{3,4}|[a-f0-9]{4}(?:[a-f0-9]{2}){1,2})\\b$/i;\nexport const REGEX_NUMBER = /^\\d+$/;\n\nexport const isEmpty = (value = '') => !value.length;\nexport const maxLength = (value = '', limit = 0) => value.length <= limit;\nexport const minLength = (value = '', limit = 0) => value.length >= limit;\nexport const isEmail = (value = '') => REGEX_EMAIL.test(value);\nexport const isURL = (value = '') => REGEX_URL.test(value);\nexport const isHexColor = (value = '') => REGEX_HEX_COLOR.test(value);\nexport const isNumber = (value = '') => REGEX_NUMBER.test(value);\nexport const notEmpty = (value) => !!value.length\n\n","import React, { useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { classnames, generateUID } from \"../../lib/helpers\";\nimport ErrorZone from \"../error_zone\";\nimport useInput from \"../../hooks/useInput\";\nimport { notEmpty } from \"../../lib/validators\";\nimport { useEffect } from \"react\";\n\nconst noop = () => true;\n\n/** @type any */\nexport const Input = React.forwardRef(\n  (\n    {\n      icon,\n      iconPosition = \"has-icons-right\",\n      error,\n      errorZoneClassName,\n      autoComplete = \"off\",\n      className = \"\",\n      widget = \"input\",\n      type = \"text\",\n      onPressEnter,\n      isSubmitted,\n      loading = false,\n      required = false,\n      id,\n      placeholder,\n      value,\n      autofocus = false,\n      onChange,\n      validator = noop,\n      errorMessage,\n      ...rest\n    },\n    ref\n  ) => {\n    if (required) {\n      validator = Array.isArray(validator)\n        ? validator.push(notEmpty)\n        : [validator, notEmpty];\n    }\n\n    const { state, ...handlers } = useInput(onChange, value, validator);\n    const [uid] = useState(generateUID(\"input\"));\n    const [mounted, setMounted] = useState(false);\n    ref = ref || React.useRef();\n\n    useEffect(() => {\n      setMounted(true);\n    }, []);\n\n    useEffect(() => {\n      if (autofocus && !error) {\n        ref.current.focus();\n      }\n    }, [mounted, autofocus, ref, error]);\n\n    const theError = state.hasError ? errorMessage || \"invalid field\" : \"\";\n    const statusClasses = state.hasError ? \"is-danger\" : \"\";\n\n    const cssControl = () => (icon ? [\"control\", iconPosition] : [\"control\"]);\n\n    return (\n      <div className=\"field\">\n        {id && placeholder ? (\n          <label className=\"label\" htmlFor={id}>\n            {placeholder}\n          </label>\n        ) : null}\n        <div className={classnames(cssControl())}>\n          <input\n            className={classnames([widget, className, statusClasses])}\n            aria-invalid={theError}\n            aria-describedby={uid}\n            id={id}\n            ref={ref}\n            type={type}\n            value={state.value}\n            placeholder={placeholder}\n            autoComplete={autoComplete}\n            disabled={loading || rest.disabled}\n            required={required}\n            {...handlers}\n            {...rest}\n          />\n          {icon && icon}\n        </div>\n        <ErrorZone className={errorZoneClassName} id={uid}>\n          {state.hasError ? theError : \"\"}\n        </ErrorZone>\n      </div>\n    );\n  }\n);\n\nInput.propTypes = {\n  icon: PropTypes.node,\n  iconPosition: PropTypes.arrayOf(\n    PropTypes.oneOf([\"has-icons-left\", \"has-icons-right\", \"\"])\n  ),\n  error: PropTypes.string,\n  errorZoneClassName: PropTypes.string,\n  autoComplete: PropTypes.string,\n  autoFocus: PropTypes.bool,\n  className: PropTypes.string,\n  disabled: PropTypes.bool,\n  loading: PropTypes.bool,\n  isSubmitted: PropTypes.bool,\n  id: PropTypes.string,\n  name: PropTypes.string,\n  onChange: PropTypes.func,\n  onKeyDown: PropTypes.func,\n  onKeyUp: PropTypes.func,\n  onPressEnter: PropTypes.func,\n  placeholder: PropTypes.string,\n  readOnly: PropTypes.bool,\n  required: PropTypes.bool,\n  type: PropTypes.string,\n  value: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.number,\n    PropTypes.bool\n  ])\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { noop } from '../../lib/helpers';\nimport { classnames } from '../../lib/helpers';\n\n\nexport const Form = ({\n  children,\n  className = '',\n  onSubmit = noop,\n  onReset = noop,\n  autoComplete = 'off',\n  title,\n  error,\n  ...rest }\n) => {\n    const handleSubmit = (event) => {\n        event.preventDefault();\n        onSubmit(event);\n    };\n    return (\n      <React.Fragment>\n        {title && <div className=\"level\">\n            <h1 className=\"title is-size-4\">{title}</h1>\n        </div>}\n        {error && <div className=\"notification is-danger\">\n          {error}\n        </div>}\n        <form\n              onSubmit={handleSubmit}\n              onReset={onReset}\n              autoComplete={autoComplete}\n              className={classnames(['form', className])}\n              {...rest}\n          >\n              {children}\n          </form>\n        </React.Fragment>\n    );\n};\n\nForm.propTypes = {\n    children: PropTypes.node.isRequired,\n    className: PropTypes.string,\n    onSubmit: PropTypes.func,\n    onReset: PropTypes.func,\n    autoComplete: PropTypes.string\n};\n\n","import React from \"react\";\nimport { Form } from \"./form\";\nimport { Input } from \"./input\";\nimport { EmailInput } from \"./email\";\nimport { PasswordInput } from \"./password\";\nimport { Button } from \"./button\";\nimport { Checkbox } from \"./checkbox\";\nimport { generateUID } from \"../../lib/helpers\";\n\nconst formComponents = {\n  string: Input,\n  password: PasswordInput,\n  boolean: Checkbox,\n  email: EmailInput\n};\n\nexport function FormBuilder({\n  schema,\n  formData,\n  title,\n  onSubmit,\n  actionName,\n  children,\n  exclude = [],\n  remotes = [],\n  submitButton = true,\n  ...rest\n}) {\n  const ref = React.useRef();\n  const { properties, required } = schema;\n  const values = Object.assign({}, formData || {});\n\n  // build initial state\n  let initialState = {};\n  const fields = Object.keys(properties).filter(x => !exclude.includes(x));\n\n  fields.forEach(element => {\n    initialState[element] = values[element] || undefined;\n  });\n\n  // Register remotes\n  if (!ref.current) {\n    ref.current = {};\n    Object.keys(remotes).forEach(item => (ref.current[item] = remotes[item]));\n  } else {\n    // apply remote changes\n    Object.keys(remotes).forEach(key => {\n      if (JSON.stringify(ref.current[key]) !== JSON.stringify(remotes[key])) {\n        ref.current[key] = remotes[key];\n      }\n    });\n  }\n\n  ref.current = ref.current || {};\n  const onUpdate = field => ev => {\n    ref.current[field] = ev.target ? ev.target.value : ev.value || ev;\n  };\n\n  const GetTag = ({ field }) => {\n    const Tag =\n      formComponents[properties[field].widget || properties[field].type];\n\n    const props = {\n      label: properties[field].title,\n      value: initialState[field],\n      onChange: onUpdate(field),\n      placeholder: properties[field].title || \"\",\n      id: generateUID()\n    };\n\n    if (required.includes(field)) {\n      props.required = true;\n      props.placeholder += \" *\";\n    }\n    Tag.displayName = `${field}Field`;\n    return <Tag {...props} />;\n  };\n\n  const children_ = React.Children.map(children, child =>\n    React.cloneElement(child, { onChange: onUpdate })\n  );\n\n  const changes = () => {\n    onSubmit(ref.current, values);\n  };\n\n  return (\n    <Form onSubmit={changes} {...rest}>\n      {fields.map((field, i) => (\n        <GetTag field={field} key={field} />\n      ))}\n      {children_}\n      {submitButton && <Button>{actionName}</Button>}\n    </Form>\n  );\n}\n","import React from 'react'\nimport {Input} from './input';\n\n\nexport const PasswordInput = ({ value = '', ...rest }) => {\n    return <Input\n      value={value}\n      type=\"password\"\n      {...rest}\n    />;\n}\n","import React from 'react'\nimport {Input} from './input';\nimport {isEmail} from '../../lib/validators';\nimport {Icon} from '../ui/icon'\n\n\nexport const EmailInput = ({ value = '', ...rest }) => {\n    return <Input type=\"email\"\n      validator={isEmail}\n      errorMessage='Email address invalid'\n      value={value}\n      icon={<Icon icon='fas fa-envelope' />}\n      {...rest}\n    />;\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport { classnames } from '../../lib/helpers';\n\n// @ TODO implement hasErrors\n\n/** @type any */\nexport const Select = ({\n    options,\n    error,\n    size = 1,\n    className = '',\n    classWrap = '',\n    multiple = false,\n    loading = false,\n    isSubmitted,\n    onChange,\n    resetOnChange,\n    appendDefault = false,\n    style={},\n    ...rest\n}) => {\n\n    const ref = React.useRef()\n\n    const onUpdate = (ev) => {\n      if (ev.target.value === \"\") {\n        onChange({target:{value:undefined}})\n      } else {\n        onChange(ev)\n      }\n      if (resetOnChange) {\n        ref.current.value = ''\n      }\n    }\n\n    if (appendDefault) {\n      options = [{ text: \"Choose..\", value: \"\" }].concat(options)\n    }\n\n    const cssWrap = ['select', (multiple ? 'is-multiple' :''), classWrap]\n\n    return (\n        <div className={classnames(cssWrap)}>\n          <select\n              className={classnames(['', className])}\n              size={size}\n              multiple={multiple}\n              disabled={loading || rest.disabled}\n              onChange={onUpdate}\n              {...rest}\n              ref={ref}\n              style={style}\n          >\n              {options.map(({ text, ...rest }, index) => (\n                <option\n                  key={index.toString()} {...rest}>\n                  {text}\n                </option>\n              ))}\n          </select>\n        </div>\n    );\n};\n\nSelect.propTypes = {\n    error: PropTypes.string,\n    disabled: PropTypes.bool,\n    loading: PropTypes.bool,\n    isSubmitted: PropTypes.bool,\n    size: PropTypes.number,\n    onChange: PropTypes.func,\n    options: PropTypes.arrayOf(PropTypes.object),\n    multiple: PropTypes.bool,\n    className: PropTypes.string\n};\n\n","import React from \"react\";\nimport {lightFileReader} from '../../lib/client'\n\n\nexport function FileUpload({label, onChange, ...props}) {\n\n  const changed = async (event) => {\n    const file = await lightFileReader(event.target.files[0])\n    onChange(file)\n  }\n\n  return (\n    <div className=\"file\">\n      <label className=\"file-label\">\n        <input className=\"file-input\"\n          {...props}\n          type=\"file\"\n          name=\"file\"\n          onChange={changed}\n          />\n        <span className=\"file-cta\">\n          <span className=\"file-icon\">\n            <i className=\"fas fa-upload\"></i>\n          </span>\n          <span className=\"file-label\">{label || 'Choose a file'}</span>\n        </span>\n      </label>\n    </div>\n  );\n}\n","import React from \"react\";\n\nexport const Textarea = React.forwardRef(({\n  value = \"\",\n  rows = 5,\n  className,\n  onChange,\n  ...rest\n}, ref) => {\n  const css = \"textarea \" + className;\n\n  const onUpdate = ev => {\n    if (onChange) {\n      onChange(ev.target.value);\n    }\n  };\n\n  return (\n    <div className=\"field\">\n      <textarea\n        className={css}\n        rows={rows}\n        onChange={onUpdate}\n        value={value}\n        {...rest}\n        ref={ref}\n      />\n    </div>\n  );\n});\n","import React from \"react\";\nimport { useSetState } from \"react-use\";\nimport { TraversalContext } from \"../contexts\";\n\nconst initial = {\n  loading: undefined,\n  isError: false,\n  errorMessage: undefined,\n  result: undefined,\n  response: undefined\n};\n\nconst processResponse = async (res, ready_body=true) => {\n  if (res.status < 400)\n    return {\n      isError: false,\n      loading: false,\n      result: ready_body ? await res.json() : res.status,\n      response: res };\n  else\n    return {\n      isError: true,\n      loading: false,\n      errorMessage: res.status,\n      response: res };\n};\n\nconst patch = (state, setState, Ctx) => async (data, endpoint, body=false) => {\n  setState({ loading: true });\n  let newState = {};\n  try {\n    const path = endpoint ? `${Ctx.path}${endpoint}` : Ctx.path;\n    const res = await Ctx.client.patch(path, data);\n    newState = await processResponse(res, body)\n  } catch (e) {\n    console.error(\"Error\", e);\n    newState = { isError: true, errorMessage: \"unhandled exception\" };\n  }\n  setState(newState);\n  return newState;\n};\n\nconst del = (state, setState, Ctx) => async (data, endpoint, body=false) => {\n  setState({ loading: true });\n  let newState = {};\n  try {\n    const path = endpoint ? `${Ctx.path}${endpoint}` : Ctx.path;\n    const res = await Ctx.client.delete(path, data);\n    newState = await processResponse(res, body);\n  } catch (e) {\n    console.error(\"Error\", e);\n    newState = { isError: true, errorMessage: \"unhandled exception\" };\n  }\n  setState(newState);\n  return newState;\n};\n\nconst post = (state, setState, Ctx) => async (data, endpoint, body=true) => {\n  setState({ loading: true });\n  let newState = {};\n  try {\n    const path = endpoint ? `${Ctx.path}${endpoint}` : Ctx.path;\n    const res = await Ctx.client.post(path, data);\n    newState = await processResponse(res, body);\n  } catch (e) {\n    console.error(\"Error\", e);\n    newState = { isError: true, errorMessage: \"unhandled exception\" };\n  }\n  setState(newState);\n  return newState;\n};\n\nconst get = (state, setState, Ctx) => async (endpoint) => {\n  setState({loading:true})\n  const path = endpoint ? `${Ctx.path}${endpoint}` : Ctx.path;\n  const req = await Ctx.client.get(path)\n  const data = await req.json()\n  setState({loading: false, result:data, response:req})\n  return data\n};\n\nexport function useCrudContext() {\n  const Ctx = React.useContext(TraversalContext);\n  const [state, setState] = useSetState(initial);\n\n  return {\n    ...state,\n    Ctx,\n    patch: patch(state, setState, Ctx),\n    del: del(state, setState, Ctx),\n    post: post(state, setState, Ctx),\n    get: get(state, setState, Ctx),\n  };\n}\n","import React from \"react\";\nimport { Input } from \"../input/input\";\nimport { Button } from \"../input/button\";\nimport { useCrudContext } from \"../../hooks/useCrudContext\";\nimport { useState } from \"react\";\nimport { useRef } from \"react\";\nimport { useEffect } from \"react\";\nimport { Icon } from \"../ui\";\n\nexport function EditableField({ field, value, Type=Input, ns }) {\n  const ref = useRef();\n  const [isEdit, setEdit] = useState(false);\n  const {patch, loading, Ctx} = useCrudContext();\n  const [val, setValue] = useState(value);\n\n  const saveField = async ev => {\n    if (ev) ev.preventDefault();\n    const data = (ns) ? {[ns]: {[field]: val}} : { [field]: val }\n    await patch(data);\n    Ctx.flash(`Field ${field}, updated!`, \"success\");\n    Ctx.refresh();\n    setEdit(false);\n  };\n\n  useEffect(() => {\n    if (isEdit && ref.current) {\n      ref.current.focus();\n    }\n  });\n\n  return (\n    <React.Fragment>\n      {!isEdit && (\n        <div className=\"editable\" onClick={() => setEdit(true)}>\n          {value || 'Click to edit'}\n          <Icon icon=\"fas fa-edit\" />\n        </div>\n      )}\n\n      {isEdit && (\n        <div className=\"field\">\n          <form onSubmit={saveField}>\n            <div className=\"control\">\n              <Type\n                value={val || ''}\n                className=\"is-small\"\n                onChange={ev => setValue(ev)}\n                ref={ref}\n              />\n            </div>\n            <div className=\"field is-grouped\">\n              <div className=\"control\">\n                <Button\n                  className=\"is-small is-primary\"\n                  loading={loading}\n                  onClick={saveField}\n                >\n                  Save\n                </Button>\n              </div>\n              <div className=\"control\">\n                <Button className=\"is-small\" onClick={() => setEdit(false)}>\n                  Cancel\n                </Button>\n              </div>\n            </div>\n          </form>\n        </div>\n      )}\n    </React.Fragment>\n  );\n}\n","import React from 'react'\n\nconst plain = [\n  \"string\", \"number\", \"boolean\"\n]\n\n\nexport function RenderField({value, Widget}) {\n\n  if (!value) return ''\n\n  if (Widget) {\n    return <Widget value={value} />\n  }\n\n  const type = typeof value\n  if (plain.includes(type)) {\n    return value\n  }\n  if (type === \"object\") {\n     if (Array.isArray(value)) {\n       return value.map(item => <div key={item}><RenderField value={item} /></div>)\n     }\n     return Object.keys(value).map(key =>\n      <FieldValue field={key} value={value[key]} key={key} />\n    )\n  }\n  return <p>No render for {JSON.stringify(value)}</p>\n}\n\n\nconst FieldValue = ({field, value}) => (\n  <div className=\"field\">\n    <div className=\"label\">{field}</div>\n    <div className=\"value\">\n      <RenderField value={value} />\n    </div>\n  </div>\n)\n","import React from \"react\";\n\nimport { Icon } from \"../ui/icon\";\nimport { RenderField } from \"../fields/renderField\";\nimport { TraversalContext } from \"../../contexts\";\nimport { EditableField } from \"../fields/editableField\";\nimport { Textarea } from \"../input/textarea\";\nimport { Input } from \"../input/input\";\n\nconst Schema = {\n  editable: [\"title\", \"description\", \"effective_date\", \"expiration_date\"],\n  widgets: {\n    description: Textarea\n  }\n};\n\nexport function IDublinCore(props) {\n  const Ctx = React.useContext(TraversalContext);\n  const modifyContent = Ctx.hasPerm(\"guillotina.ModifyContent\");\n\n  return (\n    <React.Fragment>\n      {Object.keys(props).map(key => (\n        <tr key={'dublin_' + key}>\n          <td key={1}>{key}</td>\n          <td key={2}>\n            {Schema.editable.includes(key) && modifyContent && (\n              <EditableField\n                field={key}\n                value={props[key]}\n                Type={Schema.widgets[key] || Input}\n                ns=\"guillotina.behaviors.dublincore.IDublinCore\"\n              />\n            )}\n            {!Schema.editable.includes(key) && (\n              <RenderField value={props[key]} />\n            )}\n          </td>\n        </tr>\n      ))}\n    </React.Fragment>\n  );\n}\n\nexport function Author({ name }) {\n  return (\n    <div className=\"container\">\n      <Icon icon=\"fas fa-user\" />\n      <span>{name}</span>\n    </div>\n  );\n}\n","\nimport React from 'react'\nimport { TraversalContext } from '../../contexts'\nimport { useAsync } from 'react-use'\n\n\n// TODO: Refactor without useAsync... just crudContext\nexport function PanelAddons(props) {\n  const Ctx = React.useContext(TraversalContext)\n  let [action, setAction] = React.useState(false)\n\n  const installAddon = async (Ctx, key) => {\n    await Ctx.client.installAddon(Ctx.pathPrefix, key)\n    Ctx.flash(`Addon ${key} installed`, 'success')\n    setAction(!action)\n  }\n\n  const removeAddon = async (Ctx, key) => {\n    await Ctx.client.removeAddon(Ctx.pathPrefix, key)\n    Ctx.flash(`Addon ${key} removed`, 'success')\n    setAction(!action)\n  }\n\n  const state = useAsync(async () => {\n    const response = await Ctx.client.getAddons(Ctx.pathPrefix)\n    const data = await response.json()\n    return prepareData(data)\n  }, [action])\n\n  return (\n    <React.Fragment>\n      {state.loading\n        ? <div>loading</div>\n          : state.error\n            ? <p>Error: {state.error.message}</p>\n          : (\n          <div className=\"columns\">\n            <div className=\"column\">\n              <h2 className=\"title is-size-4 has-text-grey-dark\">Available Addons</h2>\n              <hr />\n              {state.value.available.length === 0 &&\n                <p>No Addon available in this container</p>}\n              <table className=\"table is-12\">\n                <tbody>\n                {state.value.available.map(addon =>\n                  <tr>\n                    <td>{addon.title}</td>\n                    <td>\n                      <button className=\"button is-primary is-small\"\n                        onClick={() => installAddon(Ctx, addon.id)}>\n                        Install\n                      </button>\n                    </td>\n                  </tr>\n                  )}\n                </tbody>\n              </table>\n          </div>\n          <div className=\"column\">\n            <h2 className=\"title is-size-4 has-text-grey-dark\">Installed Addons</h2>\n            <hr />\n            {state.value.installed.length === 0 &&\n              <p>No Addon installed in this container</p>}\n              <table className=\"table is-12\">\n              <tbody>\n              {state.value.installed.map(addon =>\n                <tr>\n                  <td>{addon.title}</td>\n                  <td>\n                    <button className=\"button is-danger is-small\"\n                      onClick={() => removeAddon(Ctx, addon.id)}>\n                      Remove\n                    </button>\n                  </td>\n                </tr>\n              )}\n              </tbody>\n            </table>\n          </div>\n        </div>\n          )\n        }\n    </React.Fragment>\n  )\n\n}\n\nconst prepareData = (result) => {\n  const addons = arrayToObject(result.available)\n  return {\n    available: result.available.filter(\n      item => !result.installed.includes(item.id)),\n    installed: result.installed.map(id => addons[id])\n  }\n}\n\nconst arrayToObject = (array) =>\n   array.reduce((obj, item) => {\n     obj[item.id] = item\n     return obj\n   }, {})\n","import React from \"react\";\nimport { useCrudContext } from \"../../hooks/useCrudContext\";\nimport { Table } from \"../ui/table\";\nimport { Button } from \"../input/button\";\n\nexport function PanelBehaviors() {\n  const { Ctx, get, result, loading, isError } = useCrudContext();\n  const ops = useCrudContext();\n\n  const [state, setState] = React.useState(false);\n\n  const enableBehavior = behavior => async () => {\n    await ops.patch({ behavior }, \"@behaviors\");\n    setState(!state);\n    Ctx.refresh()\n  };\n\n  const disableBehavior = behavior => async () => {\n    await ops.del({ behavior }, \"@behaviors\");\n    setState(!state);\n    Ctx.refresh()\n  };\n\n  React.useEffect(() => { get(\"@behaviors\") }, []);\n\n  return (\n    <div className=\"columns behaviors\">\n      <div className=\"column is-8 is-size-7\">\n        <h2 className=\"title is-size-5 has-text-grey-dark\">Behaviors</h2>\n        {!loading && !isError && result && (\n          <React.Fragment>\n            <Table>\n              <tr>\n                <td colSpan=\"3\">\n                  <h3 className=\"title is-size-6\">Static</h3>\n                </td>\n              </tr>\n              {result.static.map(behavior => (\n                <tr key={behavior}>\n                  <td>Static</td>\n                  <td>{behavior}</td>\n                  <td className=\"\">\n                    <Button className=\"is-small is-pulled-right\" disabled>\n                      Disable\n                    </Button>\n                  </td>\n                </tr>\n              ))}\n            </Table>\n            <Table>\n              <tr>\n                <td colSpan=\"3\">\n                  <h3 className=\"title is-size-6\">Enabled</h3>\n                </td>\n              </tr>\n              {result.dynamic.map(behavior => (\n                <tr key={behavior}>\n                  <td>Enabled</td>\n                  <td>{behavior}</td>\n                  <td>\n                    <Button\n                      className=\"is-small is-danger is-pulled-right\"\n                      onClick={disableBehavior(behavior)}\n                    >\n                      Disable\n                    </Button>\n                  </td>\n                </tr>\n              ))}\n            </Table>\n            <Table>\n              <tr>\n                <td colSpan=\"3\">\n                  <h3 className=\"title is-size-6\">Available</h3>\n                </td>\n              </tr>\n              {result.available.map(behavior => (\n                <tr key={behavior}>\n                  <td>Available</td>\n                  <td>{behavior}</td>\n                  <td>\n                    <Button\n                      className=\"is-small is-primary is-pulled-right\"\n                      onClick={enableBehavior(behavior)}\n                    >\n                      Enable\n                    </Button>\n                  </td>\n                </tr>\n              ))}\n            </Table>\n          </React.Fragment>\n        )}\n      </div>\n      <div className=\"column is-4\"></div>\n    </div>\n  );\n}\n","\n\nexport const formatDate = (str) => {\n  const d = new Date(str)\n  const minutes = (d.getMinutes() < 10) ? `0${d.getMinutes()}` : d.getMinutes()\n  return `${d.getDate()}/${d.getMonth() +1}/${d.getFullYear()} ${d.getHours()}:${minutes}`\n}\n","\n\nconst base = {\n  local: {\n    roleperm: {},\n    prinperm: {},\n    prinrole: {}\n  },\n  inherit: {}\n}\n\nexport class Sharing {\n  constructor(element) {\n    Object.assign(this, element || base)\n  }\n\n  get roles() {\n    return Object.keys(this.local.roleperm)\n  }\n\n  getRole(role) {\n    return this.local.roleperm[role]\n  }\n\n  get principals() {\n    return Object.keys(this.local.prinperm)\n  }\n\n  getPrincipals(principal) {\n    return this.local.prinperm[principal]\n  }\n\n  get prinrole() {\n    return Object.keys(this.local.prinrole)\n  }\n\n  getPrinroles(role) {\n    return this.local.prinrole[role]\n  }\n\n}\n\n","import { formatDate } from \"../lib/utils\";\nimport {useConfig} from '../hooks/useConfig';\n\nexport * from './sharing'\n\nexport class ItemModel {\n  constructor(item, url, path) {\n    this.item = item;\n    this.url = url;\n    this._path = path;\n  }\n\n  get path() {\n    // Compat\n    let item = (this.item[\"@id\"]) ? this.item[\"@id\"] : this.item[\"@absolute_url\"]\n    let path = item.split(\"//\")[1].split(\"/\").splice(1).join(\"/\")\n    path = `/${path}/`\n    if (this.url.length > 0) {\n      if (this.url.startsWith(\"/\")) {\n        path = path.replace(this.url.substring(1), \"\")\n      } else {\n        path = path.replace(this.url, \"\")\n      }\n    }\n\n    return path\n  }\n\n  get name() {\n    return this.item.title || this.item[\"@name\"];\n  }\n\n  get icon() {\n\n    const cfg = useConfig()\n    if (cfg.icons && cfg.icons[this.type]) {\n      return cfg.icons[this.type]\n    }\n\n    switch (this.type) {\n      case \"GroupManager\":\n        return \"fas fa-users-cog\";\n      case \"UserManager\":\n        return \"fas fa-user-cog\";\n      case \"User\":\n        return \"fas fa-user\";\n      case \"Group\":\n        return \"fas fa-users\";\n      case \"Folder\":\n        return \"fas fa-folder\";\n      default:\n        return \"fas fa-file\";\n    }\n  }\n\n  get fullPath() {\n    return this._url + this.item.id;\n  }\n\n  get id() {\n    if (this.item.id) {\n      return this.item.id;\n    }\n    let id = this.item[\"@id\"].split(\"&\")[0].split(\"/\");\n    return id[id.length - 1];\n  }\n\n  get uid() {\n    return this.item[\"@uid\"];\n  }\n\n  get type() {\n    return this.item[\"@type\"] || this.item.type_name;\n  }\n\n  get title() {\n    return this.item.title;\n  }\n\n  get created() {\n    return this.item.creation_date ? formatDate(this.item.creation_date) : \"\";\n  }\n\n  get updated() {\n    return this.item.modification_date\n      ? formatDate(this.item.modification_date)\n      : \"\";\n  }\n}\n\nexport const Permissions = [\n  \"guillotina.AddContent\",\n  \"guillotina.ModifyContent\",\n  \"guillotina.ViewContent\",\n  \"guillotina.DeleteContent\",\n  \"guillotina.AccessContent\",\n  \"guillotina.SeePermissions\",\n  \"guillotina.ChangePermissions\",\n  \"guillotina.MoveContent\",\n  \"guillotina.DuplicateContent\",\n  \"guillotina.ReadConfiguration\",\n  \"guillotina.RegisterConfigurations\",\n  \"guillotina.WriteConfiguration\",\n  \"guillotina.ManageAddons\",\n  \"guillotina.swagger.View\",\n];\n","import React, { useState, useRef } from 'react'\nimport { useClickAway } from 'react-use';\n\nexport default function Dropdown({ \n  children, \n  disabled,\n  id, \n  isRight,\n  onChange,\n  optionDisabledWhen,\n  options,\n  ...props \n}) {\n  const ref = useRef(null);\n  const [isActive, setIsActive] = useState(false)\n  const position = isRight ? 'is-right' : ''\n  const status = isActive\n    ? `dropdown ${position} is-active`\n    : `dropdown ${position}`\n\n  useClickAway(ref, () => { setIsActive(false) })\n\n  return (\n    <div ref={ref} className={status} {...props}>\n      <div className=\"dropdown-trigger\">\n        <button\n          className=\"button is-size-7\"\n          onClick={() => setIsActive(!isActive)}\n          aria-haspopup=\"true\"\n          disabled={disabled}\n          aria-controls={id}\n        >\n          {children}\n        </button>\n      </div>\n      <div className=\"dropdown-menu\" id={id} role=\"menu\">\n        <div className=\"dropdown-content\">\n          {\n            options.map(option => {\n              const disabled = typeof optionDisabledWhen === 'function' \n              ? optionDisabledWhen(option)\n              : false\n              \n              return (\n                // eslint-disable-next-line jsx-a11y/anchor-is-valid\n                <a \n                  className={\n                    disabled ? 'dropdown-item is-active' : 'dropdown-item'\n                  }\n                  key={option.text}\n                  onClick={disabled ? undefined : () => onChange(option.value)}\n                  style={disabled ? {\n                    cursor: 'not-allowed',\n                    color: 'black',\n                    opacity: 0.5,\n                    backgroundColor: '#eeeeee'\n                  } : {}}\n                >\n                  {option.text}\n                </a>\n              )}\n            )}\n        </div>\n      </div>\n    </div>\n  )\n}\n","import React, { createContext, useState, useContext } from 'react'\nimport Dropdown from './input/dropdown'\nimport { Checkbox } from './input/checkbox'\nimport { TraversalContext } from '../contexts'\n\nconst ItemsActionsCtx = createContext({})\nconst actions = {\n  DELETE: {\n    text: 'Delete',\n    perms: ['guillotina.DeleteContent'],\n    action: 'removeItems'\n  },\n  MOVE: {\n     text: 'Move to...',\n     perms: ['guillotina.MoveContent'],\n     action: 'moveItems'\n  },\n  COPY: {\n    text: 'Copy to...',\n    perms: ['guillotina.DuplicateContent'],\n    action: 'copyItems'\n  },\n}\n\n/**\n * Actions to apply after select some items\n * Ex: Delete, Move, Copy...\n */\nexport function ItemsActionsProvider({ items, children }) {\n  const traversal = useContext(TraversalContext);\n  const [selected, setSelected] = useState({})\n\n  function onSelectAllItems(checked){\n    setSelected(items.reduce((obj, item) => {\n      obj[`${item.path}/${item.id}`] = checked\n      return obj\n    } , { all: checked }))\n  }\n\n  function onSelectOneItem(item) {\n    setSelected(state => ({\n      ...state,\n      all: false,\n      [`${item.path}/${item.id}`]: !state[`${item.path}/${item.id}`]\n    }))\n  }\n\n  function onAction(actionKey) {\n    traversal.doAction(actions[actionKey].action, {\n      items: items.filter(item => selected[`${item.path}/${item.id}`])\n    })\n  }\n\n  return (\n    <ItemsActionsCtx.Provider value={{\n      onAction,\n      onSelectAllItems,\n      onSelectOneItem,\n      selected,\n    }}>\n      {children}\n    </ItemsActionsCtx.Provider>\n  )\n}\n\n/**\n * Checkbox component without props that consume the ItemsActionsContext\n * and it select/unselect all items of the page.\n */\nexport function AllItemsCheckbox() {\n  const {onSelectAllItems, selected } = useContext(ItemsActionsCtx)\n\n  return (\n     <Checkbox\n      key={selected.all}\n      onChange={onSelectAllItems}\n      style={{ marginLeft: 2 }}\n      value={selected.all}\n     />\n  )\n}\n\n/**\n * Checkbox component to select ONE item.\n */\nexport function ItemCheckbox({ item }) {\n  const { selected, onSelectOneItem } = useContext(ItemsActionsCtx)\n  const absId = `${item.path}/${item.id}`\n  const value = selected[absId]\n\n  return (\n    <Checkbox\n      key={value}\n      onChange={() => onSelectOneItem(item)}\n      value={value}\n     />\n  )\n}\n\n/**\n * Dropdown to choose some action to apply to the selected items.\n */\nexport function ItemsActionsDropdown() {\n  const traversal = useContext(TraversalContext);\n  const { selected, onAction } = useContext(ItemsActionsCtx)\n  const disabled = Object.values(selected).every(v => !v)\n  const options = Object.keys(actions)\n    .map(action => ({ text: actions[action].text, value: action }))\n\n  return (\n    <Dropdown\n      disabled={disabled}\n      id=\"items-actions\"\n      onChange={onAction}\n      optionDisabledWhen={\n        o => actions[o.value].perms.some(perm => !traversal.hasPerm(perm))\n      }\n      options={options}\n    >\n      Choose action...\n    </Dropdown>\n  )\n}\n","import React from \"react\";\n\nimport { ItemModel } from \"../models\";\nimport { TraversalContext } from \"../contexts\";\nimport { useContext } from \"react\";\nimport { Icon } from \"./ui/icon\";\nimport { ItemCheckbox } from \"./selected_items_actions\";\nimport { Delete } from \"./ui\";\n\nexport function Item({ item, setPath, icon }) {\n  const Ctx = useContext(TraversalContext);\n  const link = () => Ctx.setPath(item.path);\n  return (\n    <tr>\n      <td onClick={link} style={{ width: \"25px\" }}>\n        {icon && <Icon icon={icon} />}\n      </td>\n      <td onClick={link}>{item.id}</td>\n    </tr>\n  );\n}\n\nconst smallcss = {\n  width: 25\n};\n\nexport function RItem({ item, search, columns }) {\n  const traversal = useContext(TraversalContext);\n  const model = new ItemModel(item, traversal.url, traversal.path);\n  const link = () => traversal.setPath(model.path);\n\n  return (\n    <tr key={item}>\n      <td style={smallcss}>\n        <ItemCheckbox item={item} />\n      </td>\n      {columns.map(i => (\n        <React.Fragment key={i.label}>\n          {i.child(model, link, search)}\n        </React.Fragment>\n      ))}\n      <td style={smallcss}>\n        {traversal.hasPerm(\"guillotina.DeleteContent\") && (\n          <Delete onClick={() => traversal.doAction(\"removeItems\", {items:[model.item]})} />\n        )}\n      </td>\n    </tr>\n  );\n}\n\nexport function ItemTitle({ title, actions }) {\n  return (\n    <nav className=\"level\">\n      <div className=\"level-left\">\n        <div className=\"level-item\">\n          <h4 className=\"title has-text-primary is-size-5\">{title}</h4>\n        </div>\n      </div>\n      <div className=\"level-right\">\n        <div className=\"level-item\">{actions && actions}</div>\n      </div>\n    </nav>\n  );\n}\n","import React from 'react'\n\n/* eslint jsx-a11y/anchor-is-valid: \"off\" */\nexport function Pagination({current, total, doPaginate, pager}) {\n\n  const maxPages = Math.ceil(total/pager)\n  if (maxPages <= 1) {\n    return null\n  }\n\n  return (\n    <div>\n    <p className=\"level-right has-text-grey is-size-7\">\n        <span className=\"has-text-black\">{current+1}</span>/\n        <span className=\"has-text-black\">{maxPages}</span>&nbsp;of {total} items</p>\n    <nav className=\"pagination is-size-7\" role=\"navigation\" aria-label=\"pagination\">\n\n      <a className=\"pagination-previous is-small\"\n        disabled={current===0}\n        onClick={() => (current>0) ? doPaginate(current-1) : null}>\n          <span className=\"icon\">\n            <i className=\"fas fa-arrow-left\"></i>\n          </span>\n        </a>\n      <a className=\"pagination-next is-small\"\n        disabled={current >= maxPages}\n        onClick={() => doPaginate(current+1)}>\n          <span className=\"icon\">\n            <i className=\"fas fa-arrow-right\"></i>\n          </span>\n        </a>\n\n    </nav>\n    </div>\n  )\n}\n\n","import React from \"react\";\nimport { useEffect, useRef, useState, useCallback } from \"react\";\n\n// Mostly inspired from\n// https://github.com/molefrog/wouter\n\n\nconst setURLParams = p =>\n    window.history[\"pushState\"](\n      0,\n      0,\n      (window.history.pathname || '' ) + \"?\" + p.toString().replace(/%2F/g, \"/\")\n    );\n\n  const clean = to => {\n    const current = new URLSearchParams();\n    Object.keys(to).forEach(_key => current.set(_key, to[_key]));\n    setURLParams(current);\n  };\n\n\nexport const useLocation = ({ base = \"\" } = {}) => {\n  const [path, update] = useState(currentSearchParams());\n  const prevPath = useRef(path);\n\n  useEffect(() => {\n    patchHistoryEvents();\n\n    // this function checks if the location has been changed since the\n    // last render and updates the state only when needed.\n    // unfortunately, we can't rely on `path` value here, since it can be stale,\n    // that's why we store the last pathname in a ref.\n    const checkForUpdates = () => {\n      const pathname = currentSearchParams();\n      prevPath.current !== pathname && update((prevPath.current = pathname));\n    };\n\n    const events = [\"popstate\", \"pushState\", \"replaceState\"];\n    events.map(e => window.addEventListener(e, checkForUpdates));\n\n    // it's possible that an update has occurred between render and the effect handler,\n    // so we run additional check on mount to catch these updates. Based on:\n    // https://gist.github.com/bvaughn/e25397f70e8c65b0ae0d7c90b731b189\n    checkForUpdates();\n\n    return () =>\n      events.map(e => window.removeEventListener(e, checkForUpdates));\n  }, []);\n\n\n\n  // the 2nd argument of the `useLocation` return value is a function\n  // that allows to perform a navigation.\n  //\n  // the function reference should stay the same between re-renders, so that\n  // it can be passed down as an element prop without any performance concerns.\n  const navigate = useCallback(\n    (to, replace) => {\n      if (replace) {\n        clean(to);\n        return;\n      }\n      let current = new URLSearchParams(path.toString());\n      Object.keys(to).forEach(_key => current.set(_key, to[_key]));\n      setURLParams(current);\n    },\n    [path]\n  );\n\n  const remove = useCallback(\n    param => {\n      let current = new URLSearchParams(path.toString());\n      current.delete(param);\n      setURLParams(current);\n    },\n    [path]\n  );\n\n  return [path, navigate, remove];\n};\n\n// While History API does have `popstate` event, the only\n// proper way to listen to changes via `push/replaceState`\n// is to monkey-patch these methods.\n//\n// See https://stackoverflow.com/a/4585031\n\nlet patched = 0;\n\nconst patchHistoryEvents = () => {\n  if (patched) return;\n\n  [\"pushState\", \"replaceState\"].map(type => {\n    const original = window.history[type];\n\n    window.history[type] = function() {\n      const result = original.apply(this, arguments);\n      const event = new Event(type);\n      event.arguments = arguments;\n\n      dispatchEvent(event);\n      return result;\n    };\n  });\n\n  return (patched = 1);\n};\n\nconst currentSearchParams = (path = window.location.search) =>\n  new URLSearchParams(path);\n","import React from \"react\";\nimport { Tag } from \"./ui/tag\";\nimport {useLocation} from '../hooks/useLocation'\n\nexport function SearchLabels(props) {\n\n  const [location, , del] = useLocation()\n  const search = location.get(\"q\")\n\n  const clearSearch = () => {\n    del(\"q\")\n  };\n\n  return (\n    <div className=\"tags\">\n      {search && <Tag name=\"Search:\" color=\"is-light\" size=\"is-size-7\" />}\n      {search && (\n        <Tag name={search} color=\"is-info\" size=\"is-size-7\" onRemove={() => clearSearch()} />\n      )}\n    </div>\n  );\n}\n","const SEP = \"=\";\nconst DEFAULT_FIELD = \"title__in\";\nconst CLEANER = \"||\";\n\nexport function parser(qs, defaultField = DEFAULT_FIELD) {\n  let lastKey = undefined;\n  qs.trim();\n\n  if (qs.includes('\"')) {\n    qs = qs.replace(/\"(\\w+) (\\w+)\"/, `$1${CLEANER}$2`);\n  }\n\n  qs = qs.split(\" \");\n  return qs.map(part => {\n    if (part.includes(CLEANER)) {\n      part = part.replace(\"||\", \" \");\n    }\n    if (!part.includes(SEP)) {\n      return !lastKey ? [defaultField, part] : [lastKey, part];\n    }\n    const [key, val] = part.split(SEP);\n    lastKey = key;\n    return [key, val];\n  });\n}\n\nexport function buildQs(parsedQuery) {\n  return parsedQuery\n    .map(\n      ([key, val]) => `${encodeURIComponent(key)}=${encodeURIComponent(val)}`\n    )\n    .join(\"&\");\n}\n","import React from \"react\";\nimport { useContext } from \"react\";\nimport { useSetState } from \"react-use\";\nimport { useEffect } from \"react\";\nimport { TraversalContext } from \"../../contexts\";\nimport { RItem } from \"../item\";\nimport { Pagination } from \"../pagination\";\nimport { SearchLabels } from \"../../components/searchLabels\";\nimport { buildQs } from \"../../lib/search\";\nimport { useLocation } from \"../../hooks/useLocation\";\nimport { parser } from \"../../lib/search\";\nimport { useConfig } from \"../../hooks/useConfig\"\nimport { ItemsActionsProvider, AllItemsCheckbox, ItemsActionsDropdown } from \"../selected_items_actions\"\n\nconst initialState = {\n  page: 0,\n  items: [],\n  loading: true,\n  total: 0\n};\n\nexport function PanelItems(props) {\n  const [location, setLocation] = useLocation();\n  const { PageSize } = useConfig()\n\n  const Ctx = useContext(TraversalContext);\n  const [state, setState] = useSetState(initialState);\n  const { items, loading, total } = state;\n  const columns = Ctx.client.getItemsColumn(items, Ctx.path)\n\n  let search = location.get(\"q\");\n  let page;\n\n  try {\n    page = parseInt(location.get(\"page\")) || 0;\n  } catch {\n    page = 0;\n  }\n\n  let searchParsed = undefined\n  if (search && search !== \"\") {\n    searchParsed = parser(search);\n  }\n\n  useEffect(() => {\n    if (Ctx.state.loading) return\n    (async () => {\n      let data;\n      setState({ loading: true, total: Ctx.context.length });\n      if (search) {\n        let qs = buildQs(searchParsed);\n        data = await Ctx.client.search(\n          Ctx.path,\n          qs,\n          false,\n          false,\n          page * PageSize,\n          PageSize\n        );\n\n      } else {\n        data = await Ctx.client.getItems(Ctx.path, page * PageSize, PageSize);\n      }\n      setState({\n        items: data.member,\n        loading: false,\n        total: data.items_count\n      });\n    })();\n  }, [search, Ctx.state.refresh, page]);\n\n\n  const doPaginate = page => {\n    setLocation({ page: page });\n  };\n\n  return (\n    <ItemsActionsProvider items={items}>\n      <div className=\"columns\">\n        <div className=\"column is-2 is-size-7\">\n          <ItemsActionsDropdown />\n        </div>\n        <div className=\"column\">\n          <SearchLabels />\n        </div>\n        <div className=\"column\">\n          <Pagination\n            current={page}\n            total={total}\n            key=\"pagination-top\"\n            doPaginate={doPaginate}\n            pager={PageSize}\n          />\n        </div>\n      </div>\n      {loading && <div className=\"progress-line\"></div>}\n      {!loading && (\n        <table className=\"table is-fullwidth is-hoverable\">\n          <thead className=\"is-size-7\">\n            <tr>\n              <th><AllItemsCheckbox /></th>\n              {columns.map(i => (\n                <th key={i.label} className=\"has-text-info\">{i.label}</th>\n              ))}\n              <th>&nbsp;</th>\n            </tr>\n          </thead>\n          <tbody>\n            {items &&\n              items.map(item => (\n                <RItem item={item}\n                  setPath={Ctx.setPath}\n                  key={item[\"@uid\"]}\n                  search={search}\n                  columns={columns}\n                />\n              ))}\n            {items && items.length === 0 && (\n              <tr>\n                <td colSpan=\"6\" className=\"has-text-centered\">\n                  Anything here!\n                </td>\n              </tr>\n            )}\n          </tbody>\n        </table>\n      )}\n      <div className=\"columns is-centered\">\n        <Pagination\n          current={page}\n          key=\"pagination-bottom\"\n          total={total}\n          doPaginate={doPaginate}\n          pager={PageSize}\n        />\n      </div>\n    </ItemsActionsProvider>\n  );\n}\n","import React from \"react\";\nimport { Table } from \"./ui/table\";\nimport { TraversalContext } from \"../contexts\";\n\n\nexport function BehaviorsView({ context}) {\n\n  const Ctx = React.useContext(TraversalContext)\n  const {getBehavior} = Ctx.registry\n\n  const behaviors = [].concat(\n    context.__behaviors__,\n    context[\"@static_behaviors\"]\n  );\n  const GetBehavior = b => {\n    const Cls = getBehavior(b, BehaviorNotImplemented);\n    return <Cls {...context[b]} />;\n  };\n\n  return (\n    <React.Fragment>\n      {behaviors.map(behavior => (\n        <div className=\"container\" key={behavior}>\n          <h3 className=\"title is-size-6 has-text-grey\">{behavior}</h3>\n          <Table\n            headers={[\"Field\", \"Value\"]}\n            className=\"is-striped is-fullwidth is-size-7\"\n          >\n            {GetBehavior(behavior)}\n          </Table>\n          <hr />\n        </div>\n      ))}\n    </React.Fragment>\n  );\n}\n\nexport function BehaviorNotImplemented() {\n  return (\n    <tr>\n      <td colSpan=\"3\">Not Implemented</td>\n    </tr>\n  );\n}\n\n\n\n\n/*\n<tr>\n  <td>Creators</td>\n  <td>{Ctx.context.creators.map(item =>\n    <Author name={item}  key={'a' + item} />\n    )}</td>\n</tr> */\n\n\n","\nimport React from \"react\"\nimport { TraversalContext } from \"../contexts\";\n\n\nexport function PropertiesButtonView(properties) {\n  const Ctx = React.useContext(TraversalContext)\n  const {getProperties} = Ctx.registry\n\n  const Props = getProperties(Ctx.context[\"@type\"])\n\n  if (Props.Buttons) {\n    const Element = React.cloneElement(Props.Buttons, {Ctx: Ctx})\n    return Element\n  }\n  return null\n}\n\n\nexport function PropertiesView(props) {\n  const Ctx = React.useContext(TraversalContext)\n  const {getProperties} = Ctx.registry\n  const Props = getProperties(Ctx.context[\"@type\"])\n\n\n  if (Props.Panels) {\n    const Element = React.cloneElement(Props.Panels, {Ctx: Ctx})\n    return Element\n  }\n  return null\n}\n","import React from \"react\";\nimport { TraversalContext } from \"../../contexts\";\nimport { ItemModel } from \"../../models\";\nimport { BehaviorsView } from \"../behavior_view\";\nimport { Icon } from \"../ui/icon\";\nimport { EditableField } from \"../fields/editableField\";\nimport { RenderField } from \"../fields/renderField\";\nimport { PropertiesButtonView } from '../properties_view';\nimport { PropertiesView} from '../properties_view';\nimport {useConfig} from '../../hooks/useConfig'\n\n\nconst _showProperties = [\"@id\", \"@name\", \"@uid\", \"title\"];\nconst _editable = [\"title\"];\n\nexport function PanelProperties(props) {\n  const Ctx = React.useContext(TraversalContext);\n  const modifyContent = Ctx.hasPerm(\"guillotina.ModifyContent\");\n  const cfg = useConfig()\n\n  const model = new ItemModel(Ctx.context);\n\n  const showProperties = cfg.properties_default || _showProperties\n  const editable = cfg.properties_editable || _editable\n\n  return (\n    <div className=\"container\">\n      <div className=\"level\">\n        <div className=\"level-left\">\n          <h2 className=\"title is-size-4 is-primary\">\n            <Icon icon={model.icon} align=\"is-left\" className=\"has-text-grey\" />{\" \"}\n            &nbsp;\n            <span>{Ctx.context.title || Ctx.context[\"@name\"]}</span>\n          </h2>\n        </div>\n        <div className=\"level-right\">\n          <PropertiesButtonView />\n        </div>\n      </div>\n\n      <hr />\n      <div className=\"columns\">\n        <div className=\"column\">\n          <table className=\"table is-striped is-fullwidth is-size-7\">\n            <thead>\n              <tr>\n                <th className=\"is-2\">Prop</th>\n                <th className=\"is-8\">Value</th>\n              </tr>\n            </thead>\n            <tbody>\n              {showProperties.map(prop => (\n                <tr key={\"prop\" + prop}>\n                  <td>{prop}</td>\n                  <td>\n                    {editable.includes(prop) && modifyContent ? (\n                      <EditableField field={prop} value={Ctx.context[prop]} />\n                    ) : (\n                      <RenderField value={Ctx.context[prop]} />\n                    )}\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n          <PropertiesView />\n          <BehaviorsView context={Ctx.context} />\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { Select } from \"../input/select\";\nimport { Button } from \"../input/button\";\nimport { useCrudContext } from \"../../hooks/useCrudContext\";\nimport { useSetState } from \"react-use\";\nimport ErrorZone from \"../error_zone\";\n\nexport function PermissionRoleperm({\n  roles,\n  permissions,\n  operations,\n  refresh\n}) {\n  const { post, loading } = useCrudContext();\n  const [state, setState] = useSetState({\n    role: undefined,\n    permission: [],\n    setting: undefined,\n    error: undefined\n  });\n\n  const getMultiples = (field, setter) => ev => {\n    let values = [];\n    for (let i = 0; i < ev.target.selectedOptions.length; i++) {\n      values = values.concat([ev.target.selectedOptions[i].value]);\n    }\n    setter({ [field]: values });\n  };\n\n  const savePermission = async ev => {\n    if (!state.role || !state.setting || state.permission.length === 0) {\n      console.log(state);\n      setState({ error: \"Invalid form\" });\n      return\n    }\n    const data = {\n      roleperm: state.permission.map(perm => ({\n        role: state.role,\n        permission: perm,\n        setting: state.setting\n      }))\n    };\n    await post(data, \"@sharing\", false);\n    refresh(Math.random());\n  };\n\n  return (\n    <div className=\"container\">\n      {loading}\n      {state.error && <ErrorZone>Invalid form data</ErrorZone>}\n      <div className=\"field\">\n        <label className=\"label\">Select a Role</label>\n        <Select\n          appendDefault\n          options={roles}\n          onChange={ev => setState({ role: ev.target.value })}\n        />\n      </div>\n      <div className=\"field\">\n        <label className=\"label\">Select permissions</label>\n        <Select\n          options={permissions}\n          onChange={getMultiples(\"permission\", setState)}\n          size={5}\n          multiple\n        />\n      </div>\n      <div className=\"field\">\n        <label className=\"label\">Operation</label>\n        <Select\n          appendDefault\n          options={operations}\n          onChange={ev => setState({ setting: ev.target.value })}\n        />\n      </div>\n      <Button\n        className=\"is-primary is-small\"\n        loading={loading}\n        onClick={savePermission}\n      >\n        Save\n      </Button>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { Select } from \"../input/select\";\nimport { Button } from \"../input/button\";\nimport { useCrudContext } from \"../../hooks/useCrudContext\";\nimport { useSetState } from \"react-use\";\nimport ErrorZone from \"../error_zone\";\n\nexport function PermissionPrinperm({\n  groups,\n  permissions,\n  operations,\n  refresh\n}) {\n  const { post, loading } = useCrudContext();\n  const [state, setState] = useSetState({\n    principal: undefined,\n    permission: [],\n    setting: undefined,\n    error: undefined\n  });\n\n  const getMultiples = (field, setter) => ev => {\n    let values = [];\n    for (let i = 0; i < ev.target.selectedOptions.length; i++) {\n      values = values.concat([ev.target.selectedOptions[i].value]);\n    }\n    setter({ [field]: values });\n  };\n\n  const savePermission = async ev => {\n    if (!state.principal || !state.setting || state.permission.length === 0) {\n      setState({ error: \"Invalid form\" });\n      return\n    }\n    const data = {\n      prinperm: state.permission.map(perm => ({\n        principal: state.principal,\n        permission: perm,\n        setting: state.setting\n      }))\n    };\n    await post(data, \"@sharing\", false);\n    refresh(Math.random());\n  };\n\n  return (\n    <div className=\"container\">\n      {loading}\n      {state.error && <ErrorZone>Invalid form data</ErrorZone>}\n      <div className=\"field\">\n        <label className=\"label\">Select a Principal</label>\n        <Select\n          appendDefault\n          options={groups}\n          onChange={ev => setState({ principal: ev.target.value })}\n        />\n      </div>\n      <div className=\"field\">\n        <label className=\"label\">Select permissions</label>\n        <Select\n          options={permissions}\n          onChange={getMultiples(\"permission\", setState)}\n          size={5}\n          multiple\n        />\n      </div>\n      <div className=\"field\">\n        <label className=\"label\">Operation</label>\n        <Select\n          appendDefault\n          options={operations}\n          onChange={ev => setState({ setting: ev.target.value })}\n        />\n      </div>\n      <Button\n        className=\"is-primary is-small\"\n        loading={loading}\n        onClick={savePermission}\n      >\n        Save\n      </Button>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { Select } from \"../input/select\";\nimport { Button } from \"../input/button\";\nimport { useCrudContext } from \"../../hooks/useCrudContext\";\nimport { useSetState } from \"react-use\";\nimport ErrorZone from \"../error_zone\";\n\nexport function PermissionPrinrole({\n  groups,\n  roles,\n  operations,\n  refresh\n}) {\n  const { post, loading } = useCrudContext();\n  const [state, setState] = useSetState({\n    principal: undefined,\n    roles: [],\n    setting: undefined,\n    error: undefined\n  });\n\n  const getMultiples = (field, setter) => ev => {\n    let values = [];\n    for (let i = 0; i < ev.target.selectedOptions.length; i++) {\n      values = values.concat([ev.target.selectedOptions[i].value]);\n    }\n    setter({ [field]: values });\n  };\n\n  const savePermission = async ev => {\n    if (!state.principal || !state.setting || state.roles.length === 0) {\n      setState({ error: \"Invalid form\" });\n      return\n    }\n    const data = {\n      prinrole: state.roles.map(perm => ({\n        principal: state.principal,\n        role: perm,\n        setting: state.setting\n      }))\n    };\n    await post(data, \"@sharing\", false);\n    refresh(Math.random());\n  };\n\n  return (\n    <div className=\"container\">\n      {loading}\n      {state.error && <ErrorZone>Invalid form data</ErrorZone>}\n      <div className=\"field\">\n        <label className=\"label\">Select a Principal</label>\n        <Select\n          appendDefault\n          options={groups}\n          onChange={ev => setState({ principal: ev.target.value })}\n        />\n      </div>\n      <div className=\"field\">\n        <label className=\"label\">Select a Role</label>\n        <Select\n          options={roles}\n          onChange={getMultiples(\"roles\", setState)}\n          size={5}\n          multiple\n        />\n      </div>\n      <div className=\"field\">\n        <label className=\"label\">Operation</label>\n        <Select\n          appendDefault\n          options={operations}\n          onChange={ev => setState({ setting: ev.target.value })}\n        />\n      </div>\n      <Button\n        className=\"is-primary is-small\"\n        loading={loading}\n        onClick={savePermission}\n      >\n        Save\n      </Button>\n    </div>\n  );\n}\n","import React from \"react\";\n\nimport { Table } from \"../ui/table\";\nimport { useCrudContext } from \"../../hooks/useCrudContext\";\nimport { Sharing } from \"../../models\";\nimport { TraversalContext } from \"../../contexts\";\nimport { useSetState } from \"react-use\";\nimport { Select } from \"../input/select\";\nimport { PermissionRoleperm } from \"./permissions_roleperm\";\nimport { PermissionPrinperm } from \"./permissions_prinperm\";\nimport { PermissionPrinrole } from \"./permissions_prinrole\";\n\nexport function PanelPermissions(props) {\n  const { get, result, loading } = useCrudContext();\n\n  const [reset, setReset] = React.useState(1);\n\n  React.useEffect(() => { get(\"@sharing\") }, [reset]);\n\n  const perms = new Sharing(result);\n\n  return (\n    <div className=\"columns\">\n      {!loading && (\n        <div className=\"column is-8 is-size-7 permissions\">\n          <h2 className=\"title is-size-5 has-text-grey-dark\">\n            Role Permissions\n          </h2>\n          <Table headers={[\"Role\", \"Premission\", \"Setting\"]}>\n            {perms.roles.map((role, idx) => (\n              <React.Fragment key={'ff' + idx}>\n                <tr>\n                  <td colSpan=\"3\" className=\"has-text-link\">\n                    {role}\n                  </td>\n                  {/* <td>\n                    <Icon icon=\"fas fa-ban\" />\n                    <span>Remove</span>\n                  </td> */}\n                </tr>\n                {Object.keys(perms.getRole(role)).map((row, idx) => (\n                  <tr key={'k' + idx}>\n                    <td></td>\n                    <td>{row}</td>\n                    <td>{perms.getRole(role)[row]}</td>\n                  </tr>\n                ))}\n              </React.Fragment>\n            ))}\n            {perms.roles.length === 0 && (\n              <tr>\n                <td colSpan=\"3\">No roles permissions defined</td>\n              </tr>\n            )}\n          </Table>\n          <h2 className=\"title is-size-5 has-text-grey-dark\">\n            Principal Permissions\n          </h2>\n          <Table headers={[\"Principal\", \"Premission\", \"Setting\"]}>\n            {perms.principals.map((role, idx) => (\n              <React.Fragment key={'f2' + idx}>\n                <tr>\n                  <td colSpan=\"3\" className=\"has-text-link\">\n                    {role}\n                  </td>\n                </tr>\n                {Object.keys(perms.getPrincipals(role)).map((row, idx) => (\n                  <tr key={\"x\" + idx}>\n                    <td></td>\n                    <td>{row}</td>\n                    <td>{perms.getPrincipals(role)[row]}</td>\n                  </tr>\n                ))}\n              </React.Fragment>\n            ))}\n            {perms.principals.length === 0 && (\n              <tr>\n                <td colSpan=\"3\">No principals permissions defined</td>\n              </tr>\n            )}\n          </Table>\n          <h2 className=\"title is-size-5 has-text-grey-dark\">\n            Principal Roles\n          </h2>\n          <Table headers={[\"Principal\", \"Role\", \"Setting\"]}>\n            {perms.prinrole.map((role, idx) => (\n              <React.Fragment key={role + idx}>\n                <tr>\n                  <td colSpan=\"3\" className=\"has-text-link\">\n                    {role}\n                  </td>\n                </tr>\n                {Object.keys(perms.getPrinroles(role)).map((row, idx) => (\n                  <tr key={\"xx\" + idx}>\n                    <td></td>\n                    <td>{row}</td>\n                    <td>{perms.getPrinroles(role)[row]}</td>\n                  </tr>\n                ))}\n              </React.Fragment>\n            ))}\n            {perms.prinrole.length === 0 && (\n              <tr>\n                <td colSpan=\"3\">No principals roles defined</td>\n              </tr>\n            )}\n          </Table>\n        </div>\n      )}\n      <AddPermission refresh={setReset} reset={reset} />\n    </div>\n  );\n}\n\nconst initial = {\n  permissions: undefined,\n  groups: undefined,\n  roles: [],\n  current: \"\",\n  currentObj: undefined\n};\n\nconst operations = [\n  { text: \"Allow\", value: \"Allow\" },\n  { text: \"Deny\", value: \"Deny\" },\n  { text: \"AllowSingle\", value: \"AllowSingle\" },\n  { text: \"Unset\", value: \"Unset\" }\n];\n\nconst defaultOptions = [\n  { text: \"Choose..\", value: \"\" },\n  { text: \"Role Permissions\", value: \"roleperm\" },\n  { text: \"Principal Permissions\", value: \"prinperm\" },\n  { text: \"Principal Roles\", value: \"prinrole\" }\n];\n\nexport function AddPermission({ refresh, reset }) {\n  const Ctx = React.useContext(TraversalContext);\n  const [state, setState] = useSetState(initial);\n\n  React.useEffect(() => {\n    async function init() {\n      const permissions = (await Ctx.client.getAllPermissions(Ctx.path)).map(\n        perm => ({\n          text: perm,\n          value: perm\n        })\n      );\n      let req = await Ctx.client.getGroups(Ctx.path);\n      const groups = (await req.json()).map(group => ({\n        text: group.id,\n        value: group.id\n      }));\n      req = await Ctx.client.getRoles(Ctx.path);\n      const roles = (await req.json()).map(role => ({\n        text: role,\n        value: role\n      }));\n      setState({ permissions, groups, roles });\n    };\n\n    init();\n  }, [reset]);\n\n  return (\n    <div className=\"column is-4 is-size-7\">\n      <h1 className=\"title is-size-5\">Add Permissions</h1>\n      <p>Select a type:</p>\n      <Select\n        options={defaultOptions}\n        onChange={v => setState({ current: v.target.value })}\n      />\n      <hr />\n      {state.current && state.current === \"roleperm\" && (\n        <PermissionRoleperm\n          {...state}\n          operations={operations}\n          refresh={refresh}\n        />\n      )}\n      {state.current && state.current === \"prinperm\" && (\n        <PermissionPrinperm\n          {...state}\n          operations={operations}\n          refresh={refresh}\n        />\n      )}\n      {state.current && state.current === \"prinrole\" && (\n        <PermissionPrinrole\n          {...state}\n          operations={operations}\n          refresh={refresh}\n        />\n      )}\n    </div>\n  );\n}\n","import React from \"react\";\nimport { Select } from \"../input/select\";\nimport { Tag } from \"../ui/tag\";\nimport { Loading } from \"../ui/loading\";\n\nconst prepareAvailable = (items, already, title) => {\n  const def = { value: \"\", text: `Add ${title}` };\n  if (items.length === 0) return [];\n  if (items[0] && typeof items[0] === \"string\") {\n    return [def]\n      .concat(items.map(x => ({ value: x, text: x })))\n      .filter(item => !already.includes(item.value));\n  }\n  return [def].concat(items).filter(item => !already.includes(item.value));\n};\n\nexport function TagsWidget({\n  items,\n  available,\n  title,\n  noData,\n  onChange,\n  loading\n}) {\n  const [result, setResult] = React.useState(items);\n  available = prepareAvailable(available || [], result, title);\n\n  const remove = value => {\n    const items = result.filter(item => item !== value);\n    setResult(items);\n    onChange(items);\n  };\n\n  const addItem = value => {\n    if (value === \"\") return;\n    const items = result.concat([value]);\n    setResult(items);\n    onChange(items);\n  };\n\n  return (\n    <React.Fragment>\n      <h3 className=\"title is-size-6\">{title}</h3>\n      {loading ? <Loading style={{ marginBottom: \"1.5rem\" }} /> : <hr />}\n      <ul>\n        <div className=\"tags\">\n          {result.map(item => (\n            <Tag name={item} onRemove={() => remove(item)} key={item} />\n          ))}\n        </div>\n        {result.length === 0 && (\n          <li style={{ marginBottom: \"20px\" }}>{noData}</li>\n        )}\n        {available.length > 1 && (\n          <li className=\"widget-list-add select is-small\">\n            <Select\n              options={available}\n              resetOnChange\n              onChange={ev => addItem(ev.target.value)}\n            />\n          </li>\n        )}\n      </ul>\n    </React.Fragment>\n  );\n}\n","import React from \"react\";\nimport { useEffect } from \"react\";\nimport { useSetState } from \"react-use\";\nimport { useContext } from \"react\";\nimport { TraversalContext } from \"../contexts\";\nimport { useConfig } from \"../hooks/useConfig\";\nimport { Icon } from \"./ui/icon\";\nimport { useLocation } from \"../hooks/useLocation\";\nimport Dropdown from \"./input/dropdown\";\nimport { Button } from \"./input/button\";\n\n/* eslint jsx-a11y/anchor-is-valid: \"off\" */\nconst initialState = { types: undefined };\n\nexport function CreateButton(props) {\n  const [state, setState] = useSetState(initialState);\n  const Ctx = useContext(TraversalContext);\n  const Config = useConfig();\n  useEffect(() => {\n    (async function anyNameFunction() {\n      const types = await Ctx.client.getTypes(Ctx.path);\n      setState({\n        types: types.filter(item => !Config.DisabledTypes.includes(item))\n      });\n    })();\n  }, [Ctx.path]);\n\n  const doAction = item => {\n    Ctx.doAction(\"addItem\", { type: item });\n    setState({ isActive: false });\n  };\n\n  if (state.types && state.types.length === 1) {\n    return (\n      <Button\n        className={'is-small is-success'}\n        onClick={ev => doAction(state.types[0]) }\n        >Add {state.types[0]}</Button>\n    )\n  }\n\n  if (state.types && state.types.length === 0) {\n    return null\n  }\n\n  // Implement some kind of filtering\n  return (\n    <Dropdown\n      id=\"dropdown-menu\"\n      isRight\n      onChange={doAction}\n      options={(state.types ||[]).map(item => ({ text: item, value: item }))}\n     >\n      <span className=\"icon\">\n        <i className=\"fas fa-plus\"></i>\n      </span>\n    </Dropdown>\n  )\n}\n\nexport function ContextToolbar({AddButton, ...props}) {\n  const [location, setLocation] = useLocation();\n  const ctx = React.useContext(TraversalContext);\n  const ref = React.useRef(null);\n\n  const searchText = location.get(\"q\");\n\n  const onSearch = ev => {\n    const search = ev.target[0].value;\n    setLocation({ q: search, tab: \"Items\", page:0 });\n    // let searchParsed = parser(search);\n    // ctx.setState({ search, searchParsed });\n    ev.preventDefault();\n  };\n\n  const setFocus = ev => {\n    ref.current.focus();\n    ev.preventDefault();\n  };\n\n  // useKey(\"/\", setFocus)\n\n  // cleanup form on state.search change\n  React.useEffect(() => {\n    if (!searchText || searchText === \"\") {\n      ref.current.value = \"\";\n    }\n  }, [searchText]);\n\n  return (\n    <React.Fragment>\n      <div className=\"level-item\">\n        <form action=\"\" className=\"form\" onSubmit={onSearch}>\n          <div className=\"field has-addons\">\n            <div className=\"control\">\n              <input\n                ref={ref}\n                type=\"text\"\n                className=\"input is-size-7\"\n                placeholder=\"Search...\"\n              />\n            </div>\n            <div className=\"control\">\n              <button\n                className=\"button has-background-grey-lighter is-size-7\"\n                type=\"submit\"\n              >\n                <Icon icon=\"fas fa-search\" />\n              </button>\n            </div>\n          </div>\n        </form>\n      </div>\n      {ctx.hasPerm(\"guillotina.AddContent\") && (\n        <div className=\"level-item\">\n          {AddButton!==undefined ? <AddButton /> : <CreateButton {...props} />}\n        </div>\n      )}\n    </React.Fragment>\n  );\n}\n","import React from 'react'\nimport {TraversalContext} from '../contexts'\nimport {Notification} from './ui/notification'\nimport {Delete} from './ui/delete'\n\n\nexport function Flash() {\n  const Ctx = React.useContext(TraversalContext)\n  const {flash} = Ctx.state\n\n  if (!flash.message) return null\n\n  return (\n    <Notification isColor={flash.type}>\n        {flash.message}\n        <Delete onClick={() => Ctx.clearFlash()} />\n    </Notification>\n  )\n\n}\n","import React from 'react'\nimport {TraversalContext} from '../contexts'\nimport {useContext} from 'react'\nimport {useLocation} from '../hooks/useLocation'\n\n/* eslint jsx-a11y/anchor-is-valid: \"off\" */\n\nexport function Path(props) {\n\n  const ctx = useContext(TraversalContext)\n  const [, navigate] = useLocation()\n\n  let segments = ctx.path.replace(/\\/$/, \"\").split(\"/\")\n  let links = buildPaths(segments)\n\n  if (segments.length === 1) {\n    return false\n  }\n  //ctx.setPath(links[indx])\n  return (\n    <nav className=\"breadcrumb\" aria-label=\"breadcrumbs\">\n      <ul>\n      {segments.map((item, indx) => {\n          const path = links[indx]\n          const onClick = (e) => {\n            if (window.event.ctrlKey ||window.event.metaKey) return\n            e.preventDefault()\n            navigate({ path }, true)\n          }\n\n          return indx === 0 ? (\n            <li key={indx}>\n              <a href={path} onClick={onClick}>\n                <span className=\"icon\">\n                  <i className=\"fas fa-home\"></i>\n                </span>\n              </a>\n            </li>\n          ) : (\n            <li key={indx}>\n              <a href={path} onClick={onClick}>\n                {item}\n              </a>\n            </li>\n          )\n        })}\n      </ul>\n    </nav>\n  )\n\n}\n\nconst buildPaths = (segments) => {\n  let current = \"\"\n  let results = []\n  segments.map((item, indx) => {\n    if (indx === 0) {\n      current += \"/\"\n    } else {\n      current += item + \"/\"\n    }\n    results.push(current)\n    return item\n  })\n  return results\n}\n","import React from 'react'\nimport {Icon} from './ui/icon'\n\n\nexport function NotAllowed() {\n  return (\n    <div className=\"box not-allowed\">\n      <h1 className=\"title has-text-danger\"\n        style={{fontSize: '4rem'}}><Icon icon=\"fas fa-ban\"/></h1>\n      <h1 className=\"title has-text-grey-darker\">Not Allowed</h1>\n\n    </div>\n  )\n}\n","import React from 'react'\nimport {Icon} from './ui/icon'\n\n\nexport function NotFound() {\n  return (\n    <div className=\"box not-allowed\">\n      <h1 className=\"title has-text-grey\"\n        style={{fontSize: '4rem'}}><Icon icon=\"fas fa-dizzy\"/></h1>\n      <h1 className=\"title has-text-grey-darker\">404. Not Found</h1>\n\n    </div>\n  )\n}\n","import React from \"react\";\nimport { useState } from \"react\";\nimport { useLocation } from \"../hooks/useLocation\";\n\n\nfunction FallbackTab({ title }) {\n  return (\n    <div>Tab '{title}' not found</div>\n  )\n}\n\n\nexport function TabsPanel({ tabs, currentTab, rightToolbar, fallback = FallbackTab, ...props }) {\n\n  const [location, setLocation] = useLocation();\n\n  const defaultTab = currentTab\n\n  if (location.get(\"tab\")) {\n    currentTab = location.get(\"tab\");\n  } else {\n    currentTab = currentTab || Object.keys(tabs)[0];\n  }\n\n  /*if (!Object.keys(tabs).includes(currentTab)) {\n    setLocation(defaultTab)\n    currentTab = defaultTab\n  }*/\n  const [current, setTab] = useState(currentTab);\n  const CurrentComp = tabs[current] || fallback;\n\n  React.useEffect(() => {\n    if (Object.keys(tabs).includes(currentTab)) {\n      setTab(currentTab);\n      // setLocation({tab: currentTab})\n    }\n  }, [currentTab, tabs]);\n\n  const changeTab = tab => {\n    setLocation({ tab: tab });\n  };\n\n  return (\n    <div className=\"container\">\n      <div className=\"level\">\n        <div className=\"level-left\">\n          <div className=\"tabs\">\n            <ul>\n              {Object.keys(tabs).map(tab => (\n                <li\n                  className={\n                    \"is-size-7 \" + (tab === current ? \"is-active\" : \"\")\n                  }\n                  key={tab}\n                >\n                  <a onClick={() => changeTab(tab)}>{tab}</a>\n                </li>\n              ))}\n            </ul>\n          </div>\n        </div>\n        {rightToolbar && <div className=\"level-right\">{rightToolbar}</div>}\n      </div>\n      <div className=\"container\">\n        <CurrentComp title={current} {...props} />\n      </div>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { TabsPanel } from \"../components/tabs\";\nimport { ContextToolbar } from \"../components/context_toolbar\";\nimport { PanelItems } from \"../components/panel/items\";\nimport { TraversalContext } from \"../contexts\";\nimport { PanelProperties } from \"../components/panel/properties\";\nimport { PanelPermissions} from \"../components/panel/permissions\"\nimport { PanelBehaviors } from \"../components/panel/behaviors\";\n// import { PanelRequester } from \"../components/panel/requester\";\n\n\nconst tabs = {\n  Items: PanelItems,\n  Properties: PanelProperties,\n  Behaviors: PanelBehaviors,\n  Permissions: PanelPermissions,\n  // Requester: PanelRequester,\n};\n\nconst tabsPermissions = {\n  Items: \"guillotina.ViewContent\",\n  Properties: \"guillotina.ViewContent\",\n  Behaviors: \"guillotina.ModifyContent\",\n  Permissions: \"guillotina.SeePermissions\",\n  // Requester: \"guillotina.swagger.View\"\n};\n\nexport function FolderCtx(props) {\n  const ctx = React.useContext(TraversalContext);\n  const calculated = ctx.filterTabs(tabs, tabsPermissions);\n\n  return (\n    <TabsPanel\n      tabs={calculated}\n      currentTab=\"Items\"\n      rightToolbar={<ContextToolbar {...props} />}\n      {...props}\n    />\n  );\n}\n","import React from \"react\";\nimport { TabsPanel } from \"../components/tabs\";\nimport { TraversalContext } from \"../contexts\";\nimport { PanelPermissions} from \"../components/panel/permissions\"\nimport { PanelBehaviors } from \"../components/panel/behaviors\";\nimport { PanelProperties } from \"../components/panel/properties\";\n\n\nconst tabs = {\n  Properties: PanelProperties,\n  Behaviors: PanelBehaviors,\n  Permissions: PanelPermissions\n};\n\nconst tabsPermissions = {\n  Properties: \"guillotina.ViewContent\",\n  Behaviors: \"guillotina.ModifyContent\",\n  Permissions: \"guillotina.SeePermissions\"\n};\n\n\n\nexport function ItemCtx(props) {\n  const ctx = React.useContext(TraversalContext);\n  const calculated = ctx.filterTabs(tabs, tabsPermissions);\n\n  return <TabsPanel tabs={calculated} currentTab=\"Properties\" {...props} />;\n}\n","import React from \"react\";\n\nimport { Item } from \"../components/item\";\nimport { ItemTitle } from \"../components/item\";\nimport { Button } from \"../components/input/button\";\nimport { useState } from \"react\";\nimport { useContext } from \"react\";\nimport { useRef } from 'react'\nimport { TraversalContext } from \"../contexts\";\nimport { Modal } from \"../components/modal\";\nimport { Form } from \"../components/input/form\";\nimport { Input } from \"../components/input/input\";\n\nexport function ApplicationCtx(props) {\n  const { databases } = props.state.context;\n  return (\n    <React.Fragment>\n      <h3>Databases</h3>\n      <div className=\"container\">\n        <ItemTitle title=\"Objects\" />\n        {databases.map(db => (\n          <Item\n            item={{ id: db, path: `/${db}/` }}\n            key={db}\n            icon={\"fas fa-database\"}\n          />\n        ))}\n      </div>\n    </React.Fragment>\n  );\n}\n\nexport function DatabaseCtx({ state, client, ...props }) {\n  const Ctx = useContext(TraversalContext);\n  const { containers } = state.context;\n  const { path } = state;\n  return (\n    <React.Fragment>\n      <div className=\"container\">\n        <ItemTitle title=\"Containers\" actions={<CreateContainer />} />\n        <table className=\"table is-fullwidth is-hoverable\">\n          <tbody>\n            {containers.map(db => (\n              <Item\n                item={{ id: db, path: `${path}${db}/` }}\n                key={db}\n                icon={\"fas fa-archive\"}\n                setPath={Ctx.setPath}\n              />\n            ))}\n          </tbody>\n        </table>\n      </div>\n    </React.Fragment>\n  );\n}\n\nexport function CreateContainer(props) {\n  const [isActive, setActive] = useState(false);\n\n  return (\n    <React.Fragment>\n      <ModalAddContainer isActive={isActive} setActive={setActive} {...props} />\n      <button\n        className=\"button is-warning is-pulled-right\"\n        onClick={() => setActive(true)}\n      >\n        <span className=\"icon is-small\">\n          <i className=\"fas fa-plus\"></i>\n        </span>\n        <span>Create</span>\n      </button>\n    </React.Fragment>\n  );\n}\n\nfunction ModalAddContainer({ isActive, setActive }) {\n  const Ctx = useContext(TraversalContext);\n  const [isLoading, setLoading] = useState(false);\n  const [idField, setId] = useState(\"\");\n  const [error, setError] = useState(undefined);\n  const traversal = useContext(TraversalContext);\n\n  async function createContainer(ev) {\n    setLoading(true);\n    const data = {\n      \"@type\": \"Container\",\n      id: idField\n    };\n    try {\n      const res = await Ctx.client.create(Ctx.path, data);\n      const result = await res.json();\n      if (res.status === 200) {\n        Ctx.refresh();\n        setId(\"\");\n        setLoading(false);\n        setActive(false);\n        Ctx.flash(\"Container created\", \"primary\");\n      } else {\n        setId(\"\");\n        setLoading(false);\n        setError(result.message);\n      }\n    } catch {\n      setError(\"Error-submitting-form\");\n      setLoading(false);\n    }\n  }\n\n  return (\n    <Modal isActive={isActive} setActive={setActive}>\n      <Form onSubmit={createContainer} title=\"Add Container\" error={error}>\n        <Input\n          required\n          placeholder=\"Container Name\"\n          onChange={v => {\n            setId(v)\n          }}\n          value={idField}\n          loading={isLoading}\n        />\n        <Button loading={isLoading}>Add Container</Button>\n      </Form>\n    </Modal>\n  );\n}\n","import React from \"react\";\nimport { TabsPanel } from \"../components/tabs\";\nimport { ContextToolbar } from \"../components/context_toolbar\";\nimport { PanelItems } from \"../components/panel/items\";\nimport { PanelAddons } from \"../components/panel/addons\";\nimport { TraversalContext } from \"../contexts\";\nimport { PanelNotImplemented } from \"./base\";\nimport { PanelPermissions } from \"../components/panel/permissions\";\nimport { PanelBehaviors } from \"../components/panel/behaviors\";\n// import { PanelRequester } from \"../components/panel/requester\";\n\nconst tabs = {\n  Items: PanelItems,\n  Addons: PanelAddons,\n  Registry: PanelNotImplemented,\n  Behaviors: PanelBehaviors,\n  Permissions: PanelPermissions,\n  // Requester: PanelRequester\n};\n\nconst tabsPermissions = {\n  Items: \"guillotina.ViewContent\",\n  Addons: \"guillotina.ManageAddons\",\n  Registry: \"guillotina.ReadConfiguration\",\n  Behaviors: \"guillotina.ModifyContent\",\n  Permissions: \"guillotina.SeePermissions\",\n  // Requester: \"guillotina.swagger.View\"\n};\n\nexport function ContainerCtx(props) {\n  const ctx = React.useContext(TraversalContext);\n  const calculated = ctx.filterTabs(tabs, tabsPermissions);\n  return (\n    <TabsPanel\n      tabs={calculated}\n      currentTab=\"Items\"\n      rightToolbar={<ContextToolbar {...props} />}\n      {...props}\n    />\n  );\n}\n","import React from \"react\";\n\nexport function PanelNotImplemented(props) {\n  return (\n    <div className=\"container\">\n      <h2 className=\"title\">{props.title}</h2>\n      <p>Not implemented</p>\n    </div>\n  );\n}\n","import React from 'react'\nimport {FormBuilder} from '../components/input/form_builder'\n\nconst schema = {\n  \"type\": \"object\",\n  \"required\": [\n    \"username\",\n    \"password\",\n  ],\n  \"properties\": {\n    \"username\": {\n      \"type\": \"string\",\n      \"title\": \"Username\"\n    },\n    \"email\": {\n      \"type\": \"string\",\n      \"title\": \"Email\",\n      \"widget\": \"email\"\n    },\n    \"name\": {\n      \"type\": \"string\",\n      \"title\": \"Name\"\n    },\n    \"password\": {\n      \"type\": \"string\",\n      \"title\": \"Password\",\n      \"widget\": \"password\"\n    },\n    \"disabled\": {\n      \"type\": \"boolean\",\n      \"title\": \"Disabled\"\n    }\n  }\n}\n\nexport const UserForm = ({isEdit=false, children, ...props}) => {\n\n  const attr = (isEdit) ? {} : {\"title\": \"Add User\"}\n\n  return (\n      <FormBuilder\n          schema={schema}\n          {...props}\n          {...attr}\n          >\n        {children}\n      </FormBuilder>\n  )\n}\n\n","import React from \"react\";\n\n/*\n  This hook allows to bind (remote) fields on the DOM\n  to a form generated with Formbuilder.\n  You can link whatever field you want...\n\n  const [remoteFields, updateRemoteField] = useRemoteField({widget_1: ['a', 'b']})\n\n  <Form remotes={remoteFields} onSubmit={ev => console.log(ev)}>\n    <Input />\n  </Form>\n\n  <Widget onChange={updateRemoteField('widgte_1')}>\n\n  This will add the values from a remote field into the desired widget\n\n*/\n\nexport const useRemoteField = initial => {\n  const [remotes, setRemote] = React.useState(initial);\n\n  const updateRemote = name => value => {\n    setRemote({\n      ...remotes,\n      [name]: value\n    });\n  };\n\n  return [remotes, updateRemote];\n};\n","import React from \"react\";\nimport { TabsPanel } from \"../components/tabs\";\nimport { PanelItems } from \"../components/panel/items\";\nimport { TraversalContext } from \"../contexts\";\nimport { UserForm } from \"../forms/users\";\nimport { formatDate } from \"../lib/utils\";\nimport { useCrudContext } from \"../hooks/useCrudContext\";\nimport { TagsWidget } from \"../components/widgets/tags\";\nimport { Icon } from \"../components/ui/icon\";\nimport { Button } from \"../components/input/button\";\nimport { useRemoteField } from \"../hooks/useRemoteField\";\n\nconst tabs = {\n  Users: PanelItems\n};\n\nexport function UsersToolbar(props) {\n  const Ctx = React.useContext(TraversalContext);\n\n  return (\n    <button\n      className=\"button is-primary\"\n      onClick={() => Ctx.doAction(\"addItem\", { type: \"User\" })}\n      aria-haspopup=\"true\"\n      aria-controls=\"dropdown-menu\"\n    >\n      <Icon icon=\"fas fa-user\" />\n      <span>Add a User</span>\n    </button>\n  );\n}\n\nexport function UsersCtx(props) {\n  return (\n    <TabsPanel\n      tabs={tabs}\n      currentTab=\"Users\"\n      rightToolbar={<UsersToolbar />}\n      {...props}\n    />\n  );\n}\n\nexport function UserCtx(props) {\n  const { Ctx, patch, loading, isError, errorMessage } = useCrudContext();\n\n  const [state, setState] = React.useState({ roles: [], gorups: [] });\n\n  const fields = {\n    user_groups: [],\n    user_roles: Ctx.context.user_roles\n  };\n\n  const [remotes, updateRemote] = useRemoteField(fields);\n\n  React.useEffect(() => {\n    (async () => {\n      const res = await Promise.all([\n        Ctx.client.search(Ctx.path, { type_name: \"Group\" }, true),\n        Ctx.client.getRoles(Ctx.path)\n      ]);\n      const groups = await res[0];\n      const roles = await res[1].json();\n      setState({\n        roles: roles,\n        groups: groups.member.map(item => ({\n          value: item.id,\n          text: item[\"@name\"]\n        }))\n      });\n    })();\n  }, []);\n\n  const updateObject = async data => {\n    Ctx.apply(data);\n    const {isError, errorMessage} = await patch(data);\n    if (isError) {\n      Ctx.flash(`Update failed ${errorMessage}`, \"danger\");\n    } else {\n      Ctx.flash(\"Data updated\", \"primary\");\n    }\n    Ctx.refresh();\n  };\n\n  return (\n    <div className=\"container\">\n      <h2 className=\"title is-size-4\">\n        <Icon icon=\"fas fa-user\"></Icon>\n        &nbsp;User\n      </h2>\n\n      <hr />\n      <div className=\"columns\">\n        <div className=\"column\">\n          <div className=\"container user-props\">\n            <p>\n              <label>Username: </label> {Ctx.context.username} (\n              {Ctx.context.email})\n            </p>\n            <p>\n              <label> Created: </label> {formatDate(Ctx.context.creation_date)}\n            </p>\n            <p>\n              <label> Updated: </label>{\" \"}\n              {formatDate(Ctx.context.modification_date)}\n            </p>\n          </div>\n          <hr />\n          <UserForm\n            actionName=\"Save\"\n            onSubmit={ev => updateObject(ev)}\n            isEdit={true}\n            formData={Ctx.context}\n            exclude={[\"password\"]}\n            remotes={remotes}\n            submitButton={false}\n          >\n            <Button loading={loading}>Update</Button>\n          </UserForm>\n        </div>\n        <div className=\"column\">\n          <TagsWidget\n            onChange={updateRemote(\"user_groups\")}\n            items={Ctx.context.user_groups}\n            title=\"Groups\"\n            noData=\"There is no groups for this user\"\n            available={state.groups}\n          />\n          <hr />\n          <TagsWidget\n            onChange={updateRemote(\"user_roles\")}\n            items={remotes.user_roles}\n            title=\"Roles\"\n            noData=\"The user doesn't have any role\"\n            available={state.roles}\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React from 'react'\nimport { PathTree } from '../components/modal'\nimport { useContext } from 'react'\nimport { TraversalContext } from '../contexts'\n\nconst withError = res => res.status >= 300\n\nfunction getNewId(id = '') {\n  const suffix = '-copy-'\n  const rgx = new RegExp(`($|${suffix}\\\\d*)`)\n\n  return id.replace(rgx, r => {\n    const num = parseInt(r.replace(suffix, '') || '0')\n    return `${suffix}${num + 1}`\n  })\n}\n\nexport function CopyItems(props) {\n  const Ctx = useContext(TraversalContext)\n  const { items = [] } = props\n\n  async function copyItems(path, form) {\n    const responses = await Promise.all(items.map((item, i) => {\n      const input = form[i + 1] || {}\n      return Ctx.client.post(`${Ctx.path}${item['@name']}/@duplicate`, {\n        destination: path,\n        new_id: input.value || getNewId(item.id)\n      });\n    }))\n\n    Ctx.refresh()\n    Ctx.cancelAction()\n\n    if (responses.every(withError)) {\n      Ctx.flash(`Oops! Items can't be copied to ${path}`, 'danger')\n      return\n    }\n\n    if (responses.some(withError)) {\n      Ctx.flash(`Some items are not copied correctly!`, 'warning')\n      return\n    }\n\n    Ctx.flash(`Items copied!`, 'success')\n  }\n\n  return (\n    <PathTree\n      title=\"Copy to...\"\n      defaultPath={Ctx.path}\n      onConfirm={copyItems}\n      onCancel={() => Ctx.cancelAction()}\n    >\n      {items.map(item => (\n        <React.Fragment key={item.id}>\n          <small style={{ display: 'block', marginTop: 20 }}>\n            {`New id for \"${item.id}\" copy`}\n          </small>\n          <input type=\"text\" className=\"input\" defaultValue={getNewId(item.id)} />\n        </React.Fragment>\n      ))}\n      &nbsp;\n    </PathTree>\n  )\n}\n","import React from 'react'\nimport {PathTree} from '../components/modal'\nimport {useContext} from 'react'\nimport {TraversalContext} from '../contexts'\n\nconst withError = res => res.status >= 300\n\nexport function MoveItems(props) {\n  const Ctx = useContext(TraversalContext)\n  const { items = [] } = props\n\n  async function moveItems(path) {  \n    const responses = await Promise.all(items.map(item => {\n      return Ctx.client.post(`${Ctx.path}${item['@name']}/@move`, {\n        destination: path,\n        new_id: item['@name']\n      });\n    }))\n\n    Ctx.refresh()\n    Ctx.cancelAction()\n\n    if(responses.every(withError)) {\n      Ctx.flash(`Oops! Items can't be moved to ${path}`, 'danger')\n      return\n    }\n\n    if(responses.some(withError)) {\n      Ctx.flash(`Some items are not moved correctly!`, 'warning')\n      return\n    }\n\n    Ctx.flash(`Items moved!`, 'success')\n  }\n\n  return (\n    <PathTree\n      title=\"Move to...\"\n      onConfirm={moveItems}\n      onCancel={() => Ctx.cancelAction()}\n    />\n  )\n}\n","import React from \"react\";\nimport { useState } from \"react\";\nimport { Input } from \"../components/input/input\";\nimport { Form } from \"../components/input/form\";\nimport { stringToSlug } from \"../lib/helpers\";\n\nexport function BaseForm({ onSubmit, actionName, title }) {\n  const [name, setName] = useState(\"\");\n  const [id, setId] = useState(\"\");\n  const [error, setError] = useState(undefined);\n\n  const submit = values => {\n    if (name === \"\") {\n      setError(\"This field is required\");\n      return;\n    }\n    onSubmit({ title: name, id });\n  };\n\n  const setTitle = value => {\n    setId(stringToSlug(value));\n    setName(value);\n  };\n\n  return (\n    <Form title={title} onSubmit={submit}>\n      <Input\n        id=\"title\"\n        placeholder=\"Title\"\n        required\n        value={name}\n        onChange={setTitle}\n        autofocus\n        error={error}\n      />\n\n      <Input id=\"id\" placeholder=\"Id\" value={id} onChange={setId} />\n\n      <div className=\"level level-right\">\n        <button type=\"submit\" className=\"button is-success\">\n          {actionName || \"Add\"}\n        </button>\n      </div>\n    </Form>\n  );\n}\n","import React from \"react\";\nimport { TabsPanel } from \"../components/tabs\";\nimport { PanelItems } from \"../components/panel/items\";\nimport { TraversalContext } from \"../contexts\";\nimport { useCrudContext } from \"../hooks/useCrudContext\";\nimport { Icon } from \"../components/ui/icon\";\nimport { useEffect } from \"react\";\nimport { useState } from \"react\";\nimport { Select } from \"../components/input/select\";\nimport { Tag } from \"../components/ui/tag\";\nimport { EditableField } from \"../components/fields/editableField\";\n\nconst tabs = {\n  Groups: PanelItems\n};\n\nexport function GroupToolbar(props) {\n  const Ctx = React.useContext(TraversalContext);\n\n  return (\n    <button\n      className=\"button is-primary\"\n      onClick={() => Ctx.doAction(\"addItem\", { type: \"Group\" })}\n      aria-haspopup=\"true\"\n      aria-controls=\"dropdown-menu\"\n    >\n      <Icon icon=\"fas fa-users\" />\n      <span>Add a Group</span>\n    </button>\n  );\n}\n\nexport function GroupsCtx(props) {\n  return (\n    <TabsPanel\n      tabs={tabs}\n      currentTab=\"Groups\"\n      rightToolbar={<GroupToolbar />}\n      {...props}\n    />\n  );\n}\n\nexport function GroupCtx(props) {\n  const { Ctx, patch } = useCrudContext();\n  const [roles, setRoles] = useState([]);\n  const [users, setUsers] = useState([]);\n\n  useEffect(() => {\n    (async () => {\n      const getUsers = Ctx.client.getUsers(Ctx.path);\n      const getRoles = Ctx.client.getRoles(Ctx.path);\n      const [req, req2] = await Promise.all([getUsers, getRoles]);\n      setRoles(\n        (await req2.json()).map(role => ({\n          text: role,\n          value: role\n        }))\n      );\n      setUsers(\n        (await req.json()).map(user => ({\n          text: user[\"@name\"],\n          value: user.id\n        }))\n      );\n    })();\n  }, []);\n\n  const addRole = async ev => {\n    const role = ev.target.value;\n    await patch({ user_roles: Ctx.context.user_roles.concat(role) });\n    Ctx.flash(`Role ${role} added to group`, \"success\");\n    Ctx.refresh();\n  };\n\n  const removeRole = async role => {\n    await patch({ user_roles: Ctx.context.user_roles.filter(r => r !== role) });\n    Ctx.flash(`Role ${role} removed from group`, \"success\");\n    Ctx.refresh();\n  };\n\n  const addUser = async ev => {\n    const user = ev.target.value;\n    await patch({ users: Ctx.context.users.concat(user) });\n    Ctx.flash(`User ${user} added to group!`, \"success\");\n    Ctx.refresh();\n  };\n\n  const removeUser = async user => {\n    await patch({ users: Ctx.context.users.filter(r => r !== user) });\n    Ctx.flash(`User ${user} removed from group`, \"success\");\n    Ctx.refresh();\n  };\n\n  return (\n    <div className=\"container group-view\">\n      <h2 className=\"title is-size-4\">\n        <Icon icon=\"fas fa-users\"></Icon>\n        <span>&nbsp;Group</span>\n      </h2>\n      <hr />\n      <div className=\"columns\">\n        <div className=\"column is-4\">\n          <label className=\"label\">Title: </label>\n          <EditableField field=\"title\" value={Ctx.context.title} />\n        </div>\n        <div className=\"column is-4 is-size-7\">\n          <h3 className=\"title is-size-6\">Roles</h3>\n          <p>Add a Role</p>\n          <Select\n            options={roles.filter(\n              role => !Ctx.context.user_roles.includes(role.value)\n            )}\n            appendDefault\n            resetOnChange\n            onChange={addRole}\n          />\n          <hr />\n          {Ctx.context.user_roles.map(urole => (\n            <p className=\"control\">\n              <Tag\n                name={urole}\n                onRemove={ev => removeRole(urole)}\n                size=\"is-small\"\n              />\n            </p>\n          ))}\n        </div>\n        <div className=\"column is-4 is-size-7\">\n          <h3 className=\"title is-size-6\">Users</h3>\n          <p>Add a User</p>\n          <Select\n            options={users.filter(\n              user => !Ctx.context.users.includes(user.value)\n            )}\n            appendDefault\n            onChange={addUser}\n          />\n          <hr />\n          {Ctx.context.users.map(user => (\n            <p className=\"control\">\n              <Tag\n                name={user}\n                onRemove={ev => removeUser(user)}\n                size=\"is-small\"\n              />\n            </p>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React from 'react'\n\nconst style = { color: '#F44336', fontSize: 20, paddingBottom: 20 }\n\nexport default class ErrorBoundary extends React.Component {\n  state = {}\n\n  componentDidCatch(error, errorInfo) {\n    this.setState({ \n      hasError: true, \n      errorMsg: error.message,\n      errorStack: errorInfo.componentStack\n    })\n  }\n\n  render() {\n    const { hasError, errorMsg, errorStack } = this.state\n\n    if (hasError) {\n      return (\n        <div className=\"box main-panel\">\n          <div style={style}>Something went wrong.</div>\n          {errorMsg && <p><b>{errorMsg}</b></p>}\n          {errorStack && <p>{errorStack}</p>}\n        </div>\n      );\n    }\n\n    return this.props.children; \n  }\n}","import { FolderCtx } from \"../views/folder\";\nimport { ItemCtx } from \"../views/item\";\nimport { ApplicationCtx } from \"../views/application\";\nimport { DatabaseCtx } from \"../views/application\";\nimport { ContainerCtx } from \"../views/container\";\nimport { UsersCtx } from \"../views/users\";\nimport { UserCtx } from \"../views/users\";\nimport { CopyItems } from \"../actions/copy_items\";\nimport { MoveItems } from \"../actions/move_items\";\nimport { RemoveItems } from \"../actions/remove_items\";\nimport { AddItem } from \"../actions/add_item\";\nimport { BaseForm } from \"../forms/base\";\nimport { UserForm } from \"../forms/users\";\nimport { IAttachment } from \"../components/behaviors/iattachment\";\nimport { IDublinCore } from \"../components/behaviors/idublincore\";\nimport { IMultiAttachment } from \"../components/behaviors/imultiattachment\";\nimport { GroupsCtx } from \"../views/groups\";\nimport { GroupCtx } from \"../views/groups\"\nimport ErrorBoundary from \"../components/error_boundary\";\nimport React from 'react'\n\nlet registry = {\n  paths: {},\n  views: {\n    ErrorBoundary: ErrorBoundary,\n    Application: ApplicationCtx,\n    Database: DatabaseCtx,\n    Container: ContainerCtx,\n    UserManager: UsersCtx,\n    User: UserCtx,\n    Group: GroupCtx,\n    GroupManager: GroupsCtx,\n    Folder: FolderCtx,\n    Item: ItemCtx\n  },\n  actions: {\n    addItem: AddItem,\n    copyItems: CopyItems,\n    moveItems: MoveItems,\n    removeItems: RemoveItems,\n  },\n  forms: {\n    UserManager: BaseForm,\n    GroupManager: BaseForm,\n    Folder: BaseForm,\n    Item: BaseForm,\n    User: UserForm,\n    Group: BaseForm,\n  },\n  behaviors: {\n    \"guillotina.behaviors.dublincore.IDublinCore\": IDublinCore,\n    \"guillotina.behaviors.attachment.IAttachment\": IAttachment,\n    \"guillotina.behaviors.attachment.IMultiAttachment\": IMultiAttachment,\n  },\n  schemas: {},\n  properties: {}\n};\n\nconst get = (key, param, fallback) => {\n  if (registry[key]) return registry[key][param] || fallback;\n  return fallback;\n};\n\nconst getComponent = (context, path, fallback) => {\n  if (!context) return;\n  // console.log(\"Component for path\", path)\n  // lookup by path\n  if (registry.paths[path]) {\n    return registry.paths[path];\n  }\n  // by type\n  if (registry.views[context[\"@type\"]]) {\n    return registry.views[context[\"@type\"]];\n  }\n  if (fallback) {\n    return fallback;\n  }\n  return defaultComponent(context);\n};\n\nconst getForm = (type, fallback=BaseForm) => {\n  return registry.forms[type] || fallback;\n};\n\nconst getAction = (type, fallback) => {\n  return registry.actions[type] || fallback;\n};\n\nconst getBehavior = (type, fallback) => {\n  return registry.behaviors[type] || fallback;\n};\n\nconst getProperties = (type) => {\n  return registry.properties[type] || {}\n}\n\nexport const defaultComponent = context => {\n  return context.is_folderish ? FolderCtx : ItemCtx;\n};\n\nexport function useRegistry(data) {\n  // if data is provided we need to merge it into actual registry\n  const ref = React.useRef()\n  if (data && !ref.current) {\n    console.log(\"registry initialized\")\n    ref.current = true\n    Object.keys(data).map(\n      key => (registry[key] = { ...registry[key], ...data[key] })\n    );\n  }\n\n  return {\n    registry,\n    get,\n    getForm,\n    getComponent,\n    getAction,\n    getBehavior,\n    getProperties\n  };\n}\n\n/*\n\nconst registry = {\n  paths: {\n    \"/db/guillotina/tags/\": TagsContext\n  },\n  forms: {\n    Tag: AddTagForm\n  }\n}\n\n\n<guillotina registry={registry} />\n\n\n*/\n","import React from \"react\";\nimport { useContext } from \"react\";\nimport { TraversalContext } from \"../contexts\";\nimport { Modal } from \"../components/modal\";\n\nexport function AddItem(props) {\n\n  const Ctx = useContext(TraversalContext);\n  const { type } = props;\n  const { getForm } = Ctx.registry;\n\n  const Form = getForm(type);\n\n  const setActive = () => {\n    Ctx.cancelAction();\n  };\n\n  async function doSubmit(data, oldData) {\n    const form = Object.assign(\n      {},\n      { \"@type\": type },\n      data.formData ? data.formData : data\n    );\n    const client = Ctx.client;\n    const res = await client.create(Ctx.path, form);\n    Ctx.flash(\"Content created!\", \"success\");\n    Ctx.cancelAction();\n    Ctx.refresh();\n  }\n\n  return (\n    <Modal isActive={true} setActive={setActive}>\n      <Form\n        onSubmit={doSubmit}\n        onError={err => console.log(err)}\n        actionName={\"Add \" + type}\n        title={\"Add \" + type}\n        type={type}\n      />\n    </Modal>\n  );\n}\n","import React from \"react\";\nimport { TraversalContext } from \"../../contexts\";\nimport { FileUpload } from \"../input/upload\";\nimport { Button } from \"../input/button\";\n\n\nexport function IAttachment(props) {\n  const ctx = React.useContext(TraversalContext);\n  const canModify = ctx.hasPerm(\"guillotina.ModifyContent\");\n\n\n  const uploadFile = async file => {\n    const endpoint = `${ctx.path}@upload/file`;\n    const req = await ctx.client.upload(endpoint, file);\n    if (req.status !== 200) {\n      ctx.flash(\"Failed to upload file\", \"error\")\n      return\n    }\n    ctx.flash(\"file uploaded\", \"success\")\n    ctx.refresh();\n  };\n\n  const downloadFile = (file, content_type) => async event => {\n    const endpoint = `${ctx.path}@download/file`;\n    const res = await ctx.client.download(endpoint);\n    const text = await res.blob();\n    const blob = new Blob([text], {\n      type: content_type\n    });\n    const url = window.URL.createObjectURL(blob);\n\n    // Create blob link to download\n    const link = document.createElement(\"a\");\n    link.href = url;\n    link.setAttribute(\"download\", `${file.filename}`);\n    document.body.appendChild(link);\n    link.click();\n    link.parentNode.removeChild(link);\n  };\n\n  return (\n    <tr>\n      <td>\n        {!props.file && \"undefined\"}\n        {props.file && (\n          <React.Fragment>\n            {props.file.filename} / {props.file.content_type} ({props.file.size}\n            )<br />\n            <Button\n              onClick={downloadFile(props.file, props.file.content_type)}\n              className=\"is-small\"\n            >\n              Download\n            </Button>\n          </React.Fragment>\n        )}\n      </td>\n      <td>{canModify && <FileUpload onChange={uploadFile} />}</td>\n    </tr>\n  );\n}\n\n\n","import React from \"react\";\nimport { Input } from \"../input/input\";\nimport { FileUpload } from \"../input/upload\";\nimport { Button } from \"../input/button\";\nimport {useState} from 'react'\nimport { useCrudContext } from \"../../hooks/useCrudContext\";\nimport ErrorZone from '../error_zone'\n\nexport function IMultiAttachment(props) {\n\n  const [fileKey, setFileKey] = useState('')\n  const [file, setFile] = useState()\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState(undefined)\n  const {Ctx } = useCrudContext()\n\n  const uploadFile = async (ev) => {\n    ev.preventDefault()\n    if (!fileKey && !file) {\n      setError(\"Provide a file and a key name\")\n      return\n    }\n    setLoading(true)\n    setError(undefined)\n    const endpoint = `${Ctx.path}@upload/files/${fileKey}`;\n    const req = await Ctx.client.upload(endpoint, file)\n    if (req.status !== 200) {\n      setError(\"Failed to upload file\")\n      return\n    }\n    setFileKey('')\n    setFile(undefined)\n    setLoading(false)\n    Ctx.flash(`${fileKey} uploaded!`, 'success')\n    Ctx.refresh()\n  }\n\n  const downloadFile = (file, content_type, fileName) => async event => {\n    const endpoint = `${Ctx.path}@download/files/${file}`;\n    const res = await Ctx.client.download(endpoint);\n    const text = await res.blob();\n    const blob = new Blob([text], {\n      type: content_type\n    });\n    const url = window.URL.createObjectURL(blob);\n\n    // Create blob link to download\n    const link = document.createElement(\"a\");\n    link.href = url;\n    link.setAttribute(\"download\", `${fileName}`);\n    document.body.appendChild(link);\n    link.click();\n    link.parentNode.removeChild(link);\n  };\n\n  return (\n    <React.Fragment>\n      {Object.keys(props.files).map(file => (\n        <tr key={file}>\n          <td>{file}</td>\n          <td>\n            {props.files[file].filename} / ({props.files[file].content_type})\n            &nbsp;\n            <Button\n              className=\"is-small\"\n              onClick={downloadFile(\n                file,\n                props.files[file].content_type,\n                props.files[file].filename\n                )}\n            >\n              Download\n            </Button>\n          </td>\n        </tr>\n      ))}\n      {Object.keys(props.files).length === 0 && (\n        <tr>\n          <td colSpan={2}>No files uploaded</td>\n        </tr>\n      )}\n      <tr>\n        <td colSpan={2}>\n          <label className=\"label\">Upload a file</label>\n          <form className=\"columns\">\n            <div className=\"column is-4\">\n              <Input\n                placeholder=\"Key\"\n                name=\"field\"\n                className=\"is-small\"\n                value={fileKey}\n                onChange={(ev) => setFileKey(ev)}\n              />\n              {error && <ErrorZone>{error}</ErrorZone>}\n            </div>\n            <div className=\"column is-2\">\n              <FileUpload\n                onChange={(ev) => setFile(ev)}\n                />\n              {file && file.filename}\n            </div>\n            <div className=\"column is-2\">\n              <Button className=\"is-primary is-small\"\n                loading={loading}\n                onClick={uploadFile}\n                disabled={(!fileKey && !file)}>Upload</Button>\n            </div>\n          </form>\n        </td>\n      </tr>\n    </React.Fragment>\n  );\n}\n","\nexport const initialState = {\n  path: \"\",\n  loading: false,\n  context: undefined,\n  flash: {\n    message: undefined,\n    type: undefined\n  },\n  action: {\n    action: undefined,\n    params: undefined\n  },\n  permissions: undefined,\n  errorStatus: undefined,\n  registry: {},\n  refresh: undefined\n};\n\n\nexport function guillotinaReducer(state, action) {\n  switch (action.type) {\n    case \"SET_PATH\":\n      return { ...state, path: action.payload, loading:true };\n\n    case \"SET_CONTEXT\":\n      return { ...state, ...action.payload, errorStatus:undefined, loading:false };\n\n    case \"SET_ERROR\":\n      return { ...state, errorStatus: action.payload, loading:false };\n\n    case \"SET_FLASH\":\n      return { ...state, ...action.payload };\n\n    case \"CLEAR_FLASH\":\n      return {\n        ...state,\n        flash: {\n          message: undefined,\n          type: undefined\n        }\n      };\n    case \"SET_ACTION\":\n      return { ...state, action: action.payload };\n    case \"CLEAR_ACTION\":\n      return { ...state, action: { action: undefined, params: undefined } };\n\n    case \"REFRESH\":\n      return {...state, refresh:Math.random(), loading:true}\n\n    case \"APPLY\":\n      return {...state, context: {...state.context, ...action.payload}}\n\n    default:\n      return state;\n  }\n}\n","import React from \"react\";\nimport { useReducer } from \"react\";\nimport { useEffect } from \"react\";\nimport { useRef } from \"react\";\nimport { getClient } from \"../lib/client\";\nimport { Flash } from \"./flash\";\nimport { TraversalProvider } from \"../contexts\";\nimport { Path } from \"./path\";\nimport { NotAllowed } from \"./notallowed\";\nimport { NotFound } from \"./notfound\";\nimport { Permissions } from \"../models\";\nimport { useConfig } from \"../hooks/useConfig\";\nimport { useRegistry } from \"../hooks/useRegistry\";\nimport { useLocation } from \"../hooks/useLocation\";\nimport { guillotinaReducer } from \"../reducers/guillotina\";\nimport { initialState } from \"../reducers/guillotina\";\nimport { Loading } from './ui/loading'\n\nexport function Guillotina({ auth, ...props }) {\n  const url = props.url || \"http://localhost:8080\"; // without trailing slash\n  const config = props.config ||{}\n\n  // Will hold client instance\n  const ref = useRef();\n\n  useConfig(config);\n  const registry = useRegistry(props.registry || {});\n  // Location is cooked routing solution (only uses search params)\n  const [location, setRouterParam] = useLocation();\n\n  // if there is no path provided just go to root\n  const searchPath = location.get(\"path\") || \"/\";\n  if (searchPath && searchPath !== \"\") {\n    initialState.path = searchPath;\n  }\n\n  const [state, dispatch] = useReducer(guillotinaReducer, initialState);\n\n  // we store the client on a ref (refs are stable across renders)\n  if (!ref.current) {\n    // TODO: Refactor, we should be able to provide just a client\n    // this way is easy composable and extensible from outside.\n    ref.current = props.client || getClient(url, auth);\n  }\n\n  const { path, refresh } = state;\n  const client = ref.current;\n\n  useEffect(() => {\n    dispatch({ type: \"SET_PATH\", payload: searchPath });\n  }, [searchPath]);\n\n  useEffect(() => {\n    (async () => {\n      let data = await client.getContext(path);\n      if (data.status === 401) {\n        dispatch({ type: \"SET_ERROR\", payload: \"notallowed\" });\n        return;\n      } else if (data.status === 404) {\n        dispatch({ type: \"SET_ERROR\", payload: \"notfound\" });\n        return;\n      }\n      let context = await data.json();\n      const pr = await client.canido(path, Permissions);\n      const permissions = await pr.json();\n      dispatch({ type: \"SET_CONTEXT\", payload: { context, permissions } });\n\n    })();\n  }, [path, refresh, client]);\n\n  const ErrorBoundary = registry.get('views', 'ErrorBoundary');\n\n  const contextData = {\n    url,\n    client,\n    auth,\n    state,\n    dispatch,\n    registry,\n    setRouterParam,\n    flash: config.flash\n  };\n\n  const { action, errorStatus, permissions } = state;\n  const Main = registry.getComponent(state.context, path);\n  const Action = action.action ? registry.getAction(action.action) : null;\n\n  return (\n    <ErrorBoundary>\n      {!errorStatus && (\n        <TraversalProvider {...contextData}>\n          {permissions && (\n            <React.Fragment>\n              {action.action && <Action {...action.params} />}\n                <div className=\"level\">\n                <div className=\"level-left\">\n                  <div className=\"level-item\">\n                    <Path />\n                  </div>\n                </div>\n              </div>\n              <Flash />\n              {Main && (\n                <ErrorBoundary>\n                  <div className=\"box main-panel\">\n                    {state.loading && <Loading />}\n                    {!state.loading && <Main state={state} />}\n                  </div>\n                </ErrorBoundary>\n              )}\n              {/* <p>Guillotina {JSON.stringify(state.context)}</p> */}\n            </React.Fragment>\n          )}\n        </TraversalProvider>\n      )}\n      {errorStatus === \"notallowed\" && <NotAllowed />}\n      {errorStatus === \"notfound\" && <NotFound />}\n    </ErrorBoundary>\n  );\n}\n","import React from \"react\";\nimport { Icon } from \"./ui/icon\";\n\nexport function Layout({ children, onLogout, auth }) {\n  const doLogout = ev => {\n    auth.logout();\n    onLogout();\n  };\n\n  return (\n    <React.Fragment>\n      <header>\n        <nav className=\"navbar\" role=\"navigation\" aria-label=\"main navigation\">\n          <div className=\"navbar-brand\">\n            <a className=\"navbar-item\" href=\"/\">\n              <img\n                src={process.env.PUBLIC_URL + \"/logo.svg\"}\n                alt=\"Guillotina logo\"\n                height=\"80\"\n              />\n            </a>\n            <a\n              id=\"burger\"\n              href=\"/\"\n              role=\"button\"\n              className=\"navbar-burger burger\"\n              aria-label=\"menu\"\n              aria-expanded=\"false\"\n              data-target=\"navbarmenu\"\n            >\n              <span aria-hidden=\"true\"></span>\n              <span aria-hidden=\"true\"></span>\n              <span aria-hidden=\"true\"></span>\n            </a>\n          </div>\n          <div id=\"navbarmenu\" className=\"navbar-menu\">\n            <div className=\"navbar-start\"></div>\n            <div className=\"navbar-end\">\n              <div className=\"navbar-item\">\n                {auth.isLogged && (\n                  <div className=\"buttons\">\n                    <button className=\"button is-size-7\" onClick={doLogout}>\n                      <Icon icon=\"fas fa-sign-out-alt\" size=\"is-size-7\" />\n                      <span>Logout</span>\n                    </button>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </nav>\n      </header>\n      <section className=\"section main\">\n        <div className=\"container\">\n          <div className=\"column\">{children}</div>\n        </div>\n      </section>\n    </React.Fragment>\n  );\n}\n","\nimport React from 'react';\nimport {Component} from 'react';\nimport linkState from 'linkstate';\n\nconst ERRORS = {\n  \"failed_to_fetch\": \"Failed to fetch data: Backend not running?\",\n  \"invalid_credentials\": \"Failed! Invalid credentials\"\n}\n\nexport class Login extends Component {\n\n    state = {\n        username: '',\n        password: '',\n        loading: undefined,\n        schema: '',\n        errors: undefined\n    }\n\n    constructor(props) {\n      super(props)\n      if (props.schemas) {\n        this.state.schema = props.schemas[0]\n      }\n    }\n\n    ref = React.createRef()\n\n    doLogin = async (ev) => {\n        ev.preventDefault()\n        this.setState({loading:true, errors:undefined})\n        const {username, password, schema} = this.state;\n\n        if (schema !== '') {\n          this.props.auth.setAccount(schema)\n        }\n        const auth = this.props.auth\n        const res = await auth.login(username, password)\n\n        if (!res) {\n          this.setState({errors:auth.errors, loading:false})\n          return\n        }\n\n        if (this.props.onLogin) {\n          this.props.onLogin()\n        }\n    }\n\n    componentDidMount() {\n      this.ref.current.focus()\n    }\n\n    render() {\n      let {password, username, errors } = this.state\n      const {schemas} = this.props\n      return (\n        <React.Fragment>\n        <form className=\"login__form\" action=\"\" onSubmit={this.doLogin}>\n          <div className=\"field\">\n            <label className=\"label\">Username:</label>\n              <input type=\"text\" className=\"input\"\n                placeholder=\"Username\"\n                onChange={linkState(this, 'username')}\n                value={username}\n                ref={this.ref}\n                />\n          </div>\n          <div className=\"field\">\n            <label className=\"label\">Password:</label>\n              <input type=\"password\" className=\"input\"\n                onChange={linkState(this, 'password')}\n                value={password}\n                />\n          </div>\n          {schemas && <div className=\"field\">\n            <label className=\"label\">Schema:</label>\n            <div className=\"select\">\n              <select onChange={linkState(this, 'schema')}>\n              {schemas.map(s => <option value={s} key={s}>{s}</option>)}\n              </select>\n            </div>\n          </div>}\n          <div className=\"field\">\n            <button className=\"button is-warning\" type=\"submit\">Login</button>\n          </div>\n          <div className=\"field\">\n          {errors && <p className=\"has-text-danger\">{ERRORS[errors] || 'Generic error'}</p>}\n          </div>\n        </form>\n        </React.Fragment>\n      )\n    }\n}\n","\nimport jwt_decode from 'jwt-decode'\n\nconst noop = () => {}\n\nexport class Auth {\n\n  maxRetry = 1\n  retryRefresh = 0\n  events = {}\n\n  constructor(url) {\n    this.url = url\n    this.base_url = url\n    this.errors = undefined\n  }\n\n  getUrl(endpoint) {\n    return `${this.url}${endpoint}`\n  }\n\n  setAccount(account) {\n    this.url = this.base_url + account\n  }\n\n  async login(username, password) {\n    const url = this.getUrl('@login')\n    try {\n      const data = await fetch(url, {\n        method: 'post',\n        body: JSON.stringify({\n          username: username,\n          password:password\n        })\n      })\n      if (data.status === 200) {\n        const credentials = await data.json()\n        this.storeAuth(credentials, username)\n        return true\n      } else {\n        this.errors = \"invalid_credentials\"\n      }\n    } catch (e) {\n      this.errors = \"failed_to_fetch\"\n      return false\n    }\n    localStorage.removeItem('auth');\n    localStorage.removeItem('auth_expires');\n    return false\n  }\n\n  get isLogged() {\n    if (typeof localStorage === 'undefined') {\n      return false\n    }\n    const [token, expires] = this._getToken()\n    if (!token || !expires) {\n      return false\n    }\n    if (this.isExpired(expires)) {\n        return false\n    }\n    return true\n  }\n\n  get username() {\n    if (typeof localStorage === 'undefined') {\n      return false\n    }\n    const [token] = this._getToken()\n    const data = jwt_decode(token)\n    console.log(token)\n    return data.id\n  }\n\n  storeAuth(data) {\n    localStorage.setItem('auth', data.token)\n    localStorage.setItem('auth_expires', data.exp);\n  }\n\n  cleanAuth() {\n    localStorage.removeItem(\"auth\")\n    localStorage.removeItem(\"auth_expires\")\n  }\n\n  logout() {\n    this.cleanAuth()\n  }\n\n  async refreshToken() {\n    console.log(\"refresh!!!\")\n    this.retryRefresh++\n    let data = await fetch(this.getUrl('@login-renew'), {\n      headers: this.getHeaders(),\n      method: 'post',\n    })\n    if (data.status === 401) {\n      // invalid token\n      this.cleanAuth()\n      this.onLogout()\n      return\n    }\n    const res = await data.json()\n    console.log(\"refresh data\", res)\n    this.storeAuth(res)\n    console.log(\"token refreshed\")\n    this.retryRefresh = 0\n    return data.token\n  }\n\n  willExpire(expiration) {\n    let now = new Date().getTime()\n    if ((parseInt(expiration)*1000)  < (now + 10*1000)) {\n      return true\n    }\n    return false\n  }\n\n  isExpired(expiration) {\n    let now = new Date().getTime()\n    if (parseInt(expiration)*1000 > now) {\n      return false\n    }\n    return true\n  }\n\n  _getToken() {\n    return [\n      localStorage.getItem('auth'),\n      localStorage.getItem('auth_expires')\n    ]\n  }\n\n  getToken() {\n    const [token,] = this._getToken()\n    return token\n  }\n\n  getHeaders() {\n    const [authToken, expires]  = this._getToken()\n    if (!authToken) return {};\n\n    if (this.willExpire(expires) && this.retryRefresh < this.maxRetry) {\n      (async () => await this.refreshToken())()\n    }\n\n    return {\n      'Accept': 'application/json',\n      'Content-Type': 'application/json',\n      'Authorization': 'Bearer ' + authToken\n    }\n  }\n\n}\n\n\n","import React from 'react';\nimport {Layout} from './guillo-gmi'\nimport {Auth} from './guillo-gmi'\nimport {Guillotina} from './guillo-gmi'\nimport {Login} from './guillo-gmi'\nimport {useState} from 'react'\nimport './guillo-gmi/scss/styles.sass'\n\n/*\n\nThis should be enought to scope guillotina\nto a container\n\n\nSchemas should be passed to the login form\n\n\nconst schemas = [\n  \"\",\n  \"db/guillotina/\",\n  \"db/crawler/\",\n]\n*/\n\nlet url = 'http://localhost:8765/'\n\nif (process.env.NODE_ENV === 'production') {\n  url = '/'\n}\n\nconst auth = new Auth(url)\n\nfunction App() {\n\n  const [isLogged, setLogged] = useState(auth.isLogged)\n\n  const onLogin = () => {\n    setLogged(true)\n  }\n  const onLogout = () => setLogged(false)\n\n  auth.onLogout = onLogout\n\n  return (\n\n      <Layout auth={auth} onLogout={onLogout}>\n        { isLogged && <Guillotina auth={auth} url={url} />}\n        { !isLogged && (\n          <div className=\"columns is-centered\">\n            <div className=\"columns is-half\">\n              <Login onLogin={onLogin} auth={auth} />\n            </div>\n          </div>\n        )}\n      </Layout>\n  );\n}\n\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n"],"sourceRoot":""}